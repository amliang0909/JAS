<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Peak density in transcript features</title>
    <link href="/2025/12/19/20251218-Peak-density-in-transcript-features/"/>
    <url>/2025/12/19/20251218-Peak-density-in-transcript-features/</url>
    
    <content type="html"><![CDATA[<h3 id="Calculate-peak-density-across-transcript-features"><a href="#Calculate-peak-density-across-transcript-features" class="headerlink" title="Calculate peak density across transcript features"></a><strong>Calculate peak density across transcript features</strong></h3><p>.</p><p>.</p><p>A common step in CLIP-seq data analysis is to visualize the distribution of called peaks across various transcript features, such as exons, introns, and untranslated regions (UTRs). This can be accomplished using the R package RCAS, which integrates genomic annotation (in GTF format) with peak coordinates (in BED format) to generate peak density profiles over defined transcript regions.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs R">setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220801_peak_density/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>RCAS<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Import GTF annotation file and save as RDS for faster future loading</span><br>gtf <span class="hljs-operator">&lt;-</span> importGtf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220910_annotation/Drosaphila/dmel-all-r6.44.gtf&quot;</span><span class="hljs-punctuation">,</span><br>                 overwriteObjectAsRds <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Check column names of the GTF data frame</span><br>colnames<span class="hljs-punctuation">(</span>as.data.frame<span class="hljs-punctuation">(</span>gtf<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Convert GTF to data frame for genome annotation</span><br>genome.anno <span class="hljs-operator">=</span> as.data.frame<span class="hljs-punctuation">(</span>gtf<span class="hljs-punctuation">)</span> <br><br><span class="hljs-comment"># Extract transcript database features (genes, transcripts, exons, etc.) from GRanges</span><br>txdbFeatures <span class="hljs-operator">&lt;-</span> getTxdbFeaturesFromGRanges<span class="hljs-punctuation">(</span>gtf<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Import peak data from BED file, limiting to 10,000 samples;The parameter sampleN = 10000 limits the imported BED file to the first 10,000 peaks (or rows).</span><br>peak_bed <span class="hljs-operator">&lt;-</span> importBed<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220801_peak_density/peak_bed/peak_bed_10838.txt&quot;</span><span class="hljs-punctuation">,</span> <br>                      sampleN <span class="hljs-operator">=</span> <span class="hljs-number">10000</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Check column names of the peak BED data</span><br>colnames<span class="hljs-punctuation">(</span>as.data.frame<span class="hljs-punctuation">(</span>peak_bed<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>Matrix<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>genomation<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># Required dependency for RCAS</span><br><br><span class="hljs-comment"># Define matrix class if needed</span><br>setClass<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;mMatrix&quot;</span><span class="hljs-punctuation">,</span> contains<span class="hljs-operator">=</span><span class="hljs-string">&quot;Matrix&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Compute coverage profiles for peaks across transcript features</span><br><span class="hljs-comment"># Takes peak regions and transcript features, samples 10,000 peaks</span><br>cvgList <span class="hljs-operator">&lt;-</span> calculateCoverageProfileList<span class="hljs-punctuation">(</span><br>  queryRegions <span class="hljs-operator">=</span> peak_bed<span class="hljs-punctuation">,</span><br>  targetRegionsList <span class="hljs-operator">=</span> txdbFeatures<span class="hljs-punctuation">,</span><br>  sampleN <span class="hljs-operator">=</span> <span class="hljs-number">10000</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Create density plot with mean coverage and 95% confidence interval</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;RNA_density.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">600</span><span class="hljs-punctuation">)</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>cvgList<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;lightgreen&#x27;</span><span class="hljs-punctuation">,</span> <br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;black&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Check distribution of peaks across different feature types</span><br>table<span class="hljs-punctuation">(</span>cvgList<span class="hljs-operator">$</span>feature<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#------Transcripts</span><br><span class="hljs-comment">#Create transcript-specific coverage plot with custom styling</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220801_peak_density/&quot;</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>cvgList<span class="hljs-punctuation">)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Transcripts-coverage.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Subset data to include only transcript features</span><br>list_Transcripts <span class="hljs-operator">&lt;-</span> cvgList<span class="hljs-punctuation">[</span>cvgList<span class="hljs-operator">$</span>feature<span class="hljs-operator">==</span><span class="hljs-string">&quot;transcripts&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>list_Transcripts<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;green&#x27;</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span><br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;green&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span>ncol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">#------3UTR</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220801_peak_density/&quot;</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>cvgList<span class="hljs-punctuation">)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;3UTR-1.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br>list_3UTR <span class="hljs-operator">&lt;-</span> cvgList<span class="hljs-punctuation">[</span>cvgList<span class="hljs-operator">$</span>feature<span class="hljs-operator">==</span><span class="hljs-string">&quot;threeUTRs&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>list_3UTR<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;blue&#x27;</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span><br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;blue&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span>ncol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">#------5UTR</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220801_peak_density/&quot;</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>cvgList<span class="hljs-punctuation">)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;5UTR-1.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br>list_5UTR <span class="hljs-operator">&lt;-</span> cvgList<span class="hljs-punctuation">[</span>cvgList<span class="hljs-operator">$</span>feature<span class="hljs-operator">==</span><span class="hljs-string">&quot;fiveUTRs&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>list_5UTR<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;blue&#x27;</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span><br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;blue&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">#------CDS</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220801_peak_density/&quot;</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>cvgList<span class="hljs-punctuation">)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;CDS-1.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br>list_CDS <span class="hljs-operator">&lt;-</span> cvgList<span class="hljs-punctuation">[</span>cvgList<span class="hljs-operator">$</span>feature<span class="hljs-operator">==</span><span class="hljs-string">&quot;cds&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>list_CDS<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;blue&#x27;</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span><br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;blue&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">#------Intron</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220801_peak_density/&quot;</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>cvgList<span class="hljs-punctuation">)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Intron-2.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br>list_Intron <span class="hljs-operator">&lt;-</span> cvgList<span class="hljs-punctuation">[</span>cvgList<span class="hljs-operator">$</span>feature<span class="hljs-operator">==</span><span class="hljs-string">&quot;introns&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>list_Intron<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span><br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">#------Exon</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220801_peak_density/&quot;</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>cvgList<span class="hljs-punctuation">)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Exon-2.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br>list_Exon <span class="hljs-operator">&lt;-</span> cvgList<span class="hljs-punctuation">[</span>cvgList<span class="hljs-operator">$</span>feature<span class="hljs-operator">==</span><span class="hljs-string">&quot;exons&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>list_Exon<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span><br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/12/19/20251218-Peak-density-in-transcript-features/peaks_density_in_transcripts.png" alt="peaks_density_in_transcripts"></p><p>.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#------ Split intron coverage plot into two halves for detailed visualization</span><br><span class="hljs-comment"># Intron devide into two part (half)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/20220320_SXL/Fan.data/220801_peak_density/&quot;</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>cvgList<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Subset data to include only intron features</span><br>list_Intron <span class="hljs-operator">&lt;-</span> cvgList<span class="hljs-punctuation">[</span>cvgList<span class="hljs-operator">$</span>feature<span class="hljs-operator">==</span><span class="hljs-string">&quot;introns&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Intron-half-1.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Extract first 50 bins (first half of intron regions)</span><br>list_Intron_half_1 <span class="hljs-operator">&lt;-</span> list_Intron<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">50</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># Plot first half with red color scheme</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>list_Intron_half_1<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span><br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment">#------Create second half of intron coverage plot (bins 51-100)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Intron-half-2.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># Extract bins 51-100 (second half of intron regions)</span><br>list_Intron_half_2 <span class="hljs-operator">&lt;-</span> list_Intron<span class="hljs-punctuation">[</span><span class="hljs-number">51</span><span class="hljs-operator">:</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># Plot second half with identical red styling</span><br>ggplot2<span class="hljs-operator">::</span>ggplot<span class="hljs-punctuation">(</span>list_Intron_half_2<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> bins<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> meanCoverage<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_ribbon<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span><br>              aes<span class="hljs-punctuation">(</span>ymin <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">-</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">,</span> <br>                  ymax <span class="hljs-operator">=</span> meanCoverage <span class="hljs-operator">+</span> standardError <span class="hljs-operator">*</span> <span class="hljs-number">1.96</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_line<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;red&#x27;</span><span class="hljs-punctuation">,</span>size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> theme_bw<span class="hljs-punctuation">(</span>base_size <span class="hljs-operator">=</span> <span class="hljs-number">28</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  facet_wrap<span class="hljs-punctuation">(</span> <span class="hljs-operator">~</span> feature<span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025  [1]</title>
    <link href="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/"/>
    <url>/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/</url>
    
    <content type="html"><![CDATA[<h3 id="2025--1"><a href="#2025--1" class="headerlink" title="2025  [1]"></a>2025  [1]</h3><p>.</p><hr><p>.</p><p>.</p><p>  </p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E7%99%BD%E9%A9%AC%E9%81%93%E9%99%84%E8%BF%91.jpg" alt=""></p><p>.</p><p>,</p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E5%8D%8A%E5%B2%9B%E9%99%84%E8%BF%91.jpg" alt=""></p><p>.</p><p>.</p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E5%B0%8F%E8%8B%B9%E6%9E%9C.jpg" alt=""></p><p>.</p><p>.</p><p></p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E8%8D%86%E6%A5%9A%E9%9B%84%E9%A3%8E%E9%99%84%E8%BF%91.jpg" alt=""></p><p>.</p><p>.</p><p></p><p>city walk</p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E9%BB%84%E9%B9%A4%E6%A5%BC.jpg" alt=""></p><p>.</p><p>.</p><p></p><p> <img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E5%A4%8F%E5%A4%A9%E7%9A%84%E5%87%8C%E6%B3%A2%E9%97%A8.jpg" alt=""></p><p>.</p><p>.</p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E4%B8%9C%E6%B9%96%E7%99%BD%E9%A9%AC%E9%81%93%E5%AF%B9%E9%9D%A2.jpg" alt=""></p><p>.</p><p>.</p><p></p><p></p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E9%9B%81%E4%B8%AD%E5%92%80.jpg" alt=""></p><p>.</p><p>.</p><p></p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E8%A5%BF%E7%93%9C%E7%BB%93%E4%BA%86%E5%B0%8F%E6%9E%9C.jpg" alt=""></p><p>.</p><p>.</p><p></p><p></p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E8%8D%B7%E5%8F%B6.jpg" alt=""></p><p>.</p><p>.</p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E4%B8%9C%E6%B9%96%E4%B9%8B%E7%9C%BC%E9%99%84%E8%BF%91.jpg" alt=""></p><p>.</p><p>.</p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E7%99%BD%E9%A9%AC%E9%81%93.jpg" alt=""></p><p>.</p><p>.</p><p></p><p></p><p><img src="/2025/07/07/20250707-%E8%BF%91%E6%9C%9F%E6%B9%96%E8%BE%B9%E9%AA%91%E8%A1%8C%E7%85%A7%E7%89%87/%E6%B0%B4%E7%94%9F%E6%89%80%E5%89%8D.jpg" alt=""></p><p>.</p><p>.</p><hr>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>LASSO</title>
    <link href="/2025/05/24/20250524-LASSO%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/"/>
    <url>/2025/05/24/20250524-LASSO%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h3 id="LASSO-"><a href="#LASSO-" class="headerlink" title="LASSO "></a>LASSO </h3><p>.</p><h4 id="-LASSO-"><a href="#-LASSO-" class="headerlink" title=". LASSO "></a>. LASSO </h4><p>LASSO least absolute shrinkage and seletion operatorLASSOLASSO</p><p>LASSO</p><p> X<sup>1</sup>   X<sup>n</sup>  <sup>0</sup>  <sup>1</sup>   <sup>n</sup> </p><p><img src="/2025/05/24/20250524-LASSO%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/1.png" alt="1"></p><p>LASSO<sup>1</sup> <sup>2</sup> <sup>n</sup>  <sup>1</sup> &#x3D; 0 X<sup>1</sup>  0 X<sup>1</sup> </p><p><img src="/2025/05/24/20250524-LASSO%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/2.png" alt="2"></p><p> <sup>2</sup> &#x3D; 0 X<sup>2</sup>0X<sup>4</sup> X<sup>5</sup>  X<sup>n</sup></p><p><img src="/2025/05/24/20250524-LASSO%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/3.png" alt="3"></p><p>X<sup>4</sup> X<sup>5</sup>  X<sup>n</sup> </p><p>.</p><p>.</p><hr><p>.</p><h4 id="-LASSO--L1"><a href="#-LASSO--L1" class="headerlink" title=". LASSO &#x3D;  + L1"></a>. <strong>LASSO &#x3D;  + L1</strong></h4><p>LASSO</p><p>   <strong>L1</strong></p><p>.</p><p></p><p></p><p>.</p><p>.</p><hr><p>.</p><h4 id="-L1"><a href="#-L1" class="headerlink" title=". L1"></a>. L1</h4><p>LASSOL10LASSOL1</p><p>L1</p><p><img src="/2025/05/24/20250524-LASSO%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/4.png" alt="4"></p><p>.</p><p></p><p><em></em><br><em>  10kg</em><br><em></em></p><p><em>L1</em></p><ol><li><p>&#x3D; || + || +  + ||</p></li><li><p>10kg&#x3D; </p></li><li><p> &#x3D; 0</p></li></ol><p></p><p><strong>L1</strong></p><p></p><p>.</p><p>LASSO</p><p>                                                                 <img src="/2025/05/24/20250524-LASSO%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/5.png" alt="5"></p><p>.</p><p><strong></strong></p><p>100</p><ul><li>yi&#x3D;1&#x3D;0</li><li>xj&#x3D;6.5BMI&#x3D;28</li><li></li></ul><p><strong></strong></p><ol><li>x</li><li></li><li></li></ol><p></p><p>.</p><p><strong></strong></p><p>100L1</p><ul><li>||</li><li></li><li></li></ul><p><strong></strong></p><ul><li></li><li>&#x3D;0</li><li>BMI</li></ul><p>.</p><p><strong>+</strong></p><p>+</p><table><thead><tr><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left">&#x3D;0</td><td align="left">100</td><td align="left"></td></tr><tr><td align="left"></td><td align="left">20</td><td align="left"></td></tr><tr><td align="left"></td><td align="left">1-2</td><td align="left"></td></tr></tbody></table><p>.</p><p></p><p></p><p></p><p> +<em></em> </p><p>.</p><p>.</p><hr><p>.</p><h4 id="-LASSO"><a href="#-LASSO" class="headerlink" title=". LASSO"></a>. LASSO</h4><p>.</p><p><img src="/2025/05/24/20250524-LASSO%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/LASSO%E5%9B%9E%E5%BD%92%E7%B3%BB%E6%95%B0%E5%9B%BE.png" alt="LASSO"></p><p>.</p><p>LASSO</p><p>.</p><p>Lasso<strong></strong>Log</p><p> mean squared errorMSEMSEerror barMSE95%</p><p>lambda.minMSElambda.1selambda.min</p><p>lambda.minlambda.1seMSE</p><p>lambda.minlambda.1selambda.min4</p><p>.</p><p><strong></strong>LASSO</p><p>&#x2F;&#x2F;</p><p>0</p><p>0</p><p>lambda.min107Lasso</p><p>.</p><p></p><p><code>lambda.1se</code>SxlRala</p><p></p><p>.</p><p></p><p></p><p>&#x2F;</p><p></p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Gene ID Conversion</title>
    <link href="/2025/05/11/20250511-Gene-ID-Conversion/"/>
    <url>/2025/05/11/20250511-Gene-ID-Conversion/</url>
    
    <content type="html"><![CDATA[<h3 id="Gene-ID-Conversion"><a href="#Gene-ID-Conversion" class="headerlink" title="Gene ID Conversion"></a><strong>Gene ID Conversion</strong></h3><p>.</p><p>When comparing multiple gene sets from different sources, we often encounter missing data because the same gene may have multiple aliases. To facilitate downstream analysis, we first convert gene names to standardized gene IDs. Here, we use the <strong>org.Dm.eg.db</strong> database along with R packages like <strong>AnnotationDbi</strong>, which can comprehensively list all gene name variants associated with a given gene ID.</p><p>Additionally, we account for case sensitivity by converting gene names to a consistent letter case, ensuring that capitalization differences do not lead to mismatches.</p><p>.</p><p>the input data</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------</span><br>gene <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Pepck&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CR44430&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG12163&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CR43855&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CR34335&quot;</span><span class="hljs-punctuation">,</span> <br>                <span class="hljs-string">&quot;CR40469&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG18815&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG32138&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG5059&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG9821&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;Hsromega&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG11337&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;hipk&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CR42862&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG32103&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;CG9836&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG11486&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Ald&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG11138&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG8177&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-string">&quot;roX2&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG9911&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG13624&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;CG10082&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;roX1&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>.</p><p>Gene ID Conversion</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">)</span><br>gene_name <span class="hljs-operator">&lt;-</span> AnnotationDbi<span class="hljs-operator">::</span>keys<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">,</span> keytype <span class="hljs-operator">=</span> <span class="hljs-string">&quot;SYMBOL&quot;</span><span class="hljs-punctuation">)</span><br>gene2id <span class="hljs-operator">&lt;-</span> AnnotationDbi<span class="hljs-operator">::</span>select<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">,</span><br>                                 keys <span class="hljs-operator">=</span> gene_name<span class="hljs-punctuation">,</span><br>                                 columns <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;FLYBASE&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;ALIAS&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                 keytype <span class="hljs-operator">=</span> <span class="hljs-string">&quot;SYMBOL&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>intersect<span class="hljs-punctuation">(</span>tolower<span class="hljs-punctuation">(</span>gene2id<span class="hljs-operator">$</span>ALIAS<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>tolower<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>target_gene <span class="hljs-operator">&lt;-</span> gene2id<span class="hljs-punctuation">[</span>tolower<span class="hljs-punctuation">(</span>gene2id<span class="hljs-operator">$</span>ALIAS<span class="hljs-punctuation">)</span> <span class="hljs-operator">%in%</span> tolower<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>target_gene <span class="hljs-operator">&lt;-</span> target_gene<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>tolower<span class="hljs-punctuation">(</span>target_gene<span class="hljs-operator">$</span>ALIAS<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure><p>.</p><p>taeget_gene</p><p><img src="/2025/05/11/20250511-Gene-ID-Conversion/output.png" alt="output"></p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/03/31/20250331-%E6%A0%87%E5%87%86%E5%B7%AE%E4%B8%8E%E6%A0%87%E5%87%86%E8%AF%AF/"/>
    <url>/2025/03/31/20250331-%E6%A0%87%E5%87%86%E5%B7%AE%E4%B8%8E%E6%A0%87%E5%87%86%E8%AF%AF/</url>
    
    <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>.</p><p>standard deviationSDstandard errorSE</p><p> N  N </p><p>SD</p><p></p><p>.</p><p>SE SD</p><p>    </p><p>SD</p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SUPPA2 for alternative splicing</title>
    <link href="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/"/>
    <url>/2025/03/30/20250329-SUPPA2-for-alternative-splicing/</url>
    
    <content type="html"><![CDATA[<h3 id="SUPPA2-for-alternative-splicing"><a href="#SUPPA2-for-alternative-splicing" class="headerlink" title="SUPPA2 for alternative splicing"></a>SUPPA2 for alternative splicing</h3><p>.</p><p>SUPPA2 is a fast, accurate, and uncertainty-aware for differential splicing analysis across multiple conditions.</p><p>SUPPA2 uses transcript quantification to compute inclusion values (PSI) of alternative splicing events across multiple samples.</p><p><a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-018-1417-1">https://genomebiology.biomedcentral.com/articles/10.1186/s13059-018-1417-1</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1.generateEvents.sh</span><br>python3 /data1/amliang/home/biosoft/SUPPA/SUPPA-2.3/suppa.py  generateEvents -i ../../dmel-all-r6.44.gtf  -l 24 -o dm6 -e SE SS MX RI FL -f ioe<br>awk &#x27;FNR==1 &amp;&amp; NR!=1 &#123; while (/^&lt;header&gt;/) getline; &#125; 1 &#123;print&#125;&#x27; *.ioe &gt; dmel-all-r6.44.all.events.ioe<br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/1.events.png" alt="1.events"></p><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/2.salmon_index.png" alt="2.salmon_index"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">2.salmon.sh</span><br>wget -c https://ftp.flybase.net/genomes/Drosophila_melanogaster/dmel_r6.44_FB2022_01/fasta/dmel-all-transcript-r6.44.fasta.gz # loaddown transcript seq fasta<br>source activate py2<br>salmon index -t dmel-all-transcript-r6.44.fasta  -i index <br><br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/2.index.png" alt="2.index"></p><p>.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">fasta.gz</span> <br>ln -s/data1/amliang/projects/sxl_DC/220418_Sxl.vel_RNA_Seq/rawdata/cleandata/*gz ./<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">3.salmon.quatil.sh</span><br>source activate py2<br><br>index=/data1/amliang/projects/sxl_DC/220418_Sxl.vel_RNA_Seq/SUPPA2/salmon_index/index/<br>ls *gz|cut -d&quot;_&quot; -f 1|sort -u |while read id;do<br>salmon quant -i $index -l ISF --gcBias -1 $&#123;id&#125;_1.fq.gz -2 $&#123;id&#125;_2.fq.gz -p 2  -o ./$&#123;id&#125;_output 1&gt;$&#123;id&#125;_salmon.log 2&gt;&amp;1 &amp;<br> done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash">python3 /data1/amliang/home/biosoft/SUPPA/SUPPA-2.3/multipleFieldSelection.py -i *_output/quant.sf -k 1 -f 4 -o iso_tpm.txt</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">mkdir</span> merge_quant</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">cd</span> merge_quant</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">ln</span> -s ../*quant.sf ./</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">conda deactivate</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash">python /data1/amliang/python_prj/merge.TPM.py WT1_quant.sf WT2_quant.sf WT3_quant.sf Sxl1_quant.sf Sxl2_quant.sf Sxl3_quant.sf  merge_quant.txt</span><br><br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/3.salmon_out.png" alt="3.salmon_out"></p><p>.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">4.psiPerEvent.sh</span><br>ln -s ../3.salmon_out/merge_quant/merge_quant.txt ./<br>ln -s ../3.salmon_out/iso_tpm.txt ./<br>ln -s ../1.events/dmel-all-r6.44.all.events.ioe ./<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash">python3 /data1/amliang/home/biosoft/SUPPA/SUPPA-2.3/suppa.py psiPerEvent -i dmel-all-r6.44.all.events.ioe -e iso_tpm.txt -o project_events_1 1&gt;psiPerEvent_log_1.txt 2&gt;&amp;1</span><br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/4.pisPerEvent.png" alt="4.pisPerEvent"></p><p>.</p><p>less project_event_1.psi</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/4.pisPerEvent_2.png" alt="4.pisPerEvent_2"></p><p>.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">5.diffSplice.sh</span><br><br>ln -s ../1.events/dmel-all-r6.44.all.events.ioe ./<br>ln -s ../3.salmon_out/iso_tpm.txt ./<br>ln -s ../4.psiPerEvent/project_events_1.psi ./<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-built_in">cut</span> -f 1-4 project_events_1.psi &gt; Sxl.psi</span><br>cut -f 1-4 iso_tpm.txt &gt; Sxl.tpm<br><br>cut -f 1,5-7 project_events_1.psi &gt; WT.psi<br>cut -f 1,5-7 iso_tpm.txt &gt; WT.tpm<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-comment">#</span></span><br>python3 /data1/amliang/home/biosoft/SUPPA/SUPPA-2.3/suppa.py diffSplice -m empirical -gc -i dmel-all-r6.44.all.events.ioe --save_tpm_events -p WT.psi Sxl.psi -e WT.tpm Sxl.tpm -o project_diffSplice <br><br>cat project_diffSplice.dpsi|perl -alne &#x27;&#123;print if $F[2] &lt;0.05&#125;&#x27; |less<br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/5.diffSplice.png" alt="5.diffSplice"></p><p>.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">6.generate.isoform.sh</span><br>python3 /data1/amliang/home/biosoft/SUPPA/SUPPA-2.3/suppa.py  generateEvents -i ../../dmel-all-r6.44.gtf -f ioi -o dmel-all-r6.44.isoforms<br></code></pre></td></tr></table></figure><p>.</p><p>.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">7.psiPerIsoform.sh</span><br><br>ln -s ../6.generate.isoform/dmel-all-r6.44.isoforms.ioi ./<br>ln -s ../3.salmon_out/iso_tpm.txt ./<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash">python3 /data1/amliang/home/biosoft/SUPPA/SUPPA-2.3/suppa.py  psiPerIsoform -g ../../dmel-all-r6.44.gtf -e iso_tpm.txt -o iso</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash">awk -v OFS=<span class="hljs-string">&#x27;\t&#x27;</span> <span class="hljs-string">&#x27;&#123;if (NR == 1) &#123;print $1,$2,$3&#125; else &#123;print $1,$2,$3,$4&#125;&#125;&#x27;</span> iso_isoform.psi &gt; Sxl_iso.psi</span><br>awk -v OFS=&#x27;\t&#x27; &#x27;&#123;if (NR == 1) &#123;print $4,$5,$6&#125; else &#123;print $1,$5,$6,$7&#125;&#125;&#x27; iso_isoform.psi &gt; WT_iso.psi<br><br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/7.psiPerIsoform.png" alt="7.psiPerIsoform"></p><p>.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">8.diffSplice.iso.sh</span><br><br>ln -s ../5.diffSplice/WT.tpm ./<br>ln -s ../5.diffSplice/Sxl.tpm ./<br>ln -s ../7.psiPerIsoform/dmel-all-r6.44.isoforms.ioi ./<br>ln -s ../7.psiPerIsoform/iso_isoform.psi ./<br>ln -s ../7.psiPerIsoform/Sxl_iso.psi ./<br>ln -s ../7.psiPerIsoform/WT_iso.psi ./<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash">python3 /data1/amliang/home/biosoft/SUPPA/SUPPA-2.3/suppa.py  diffSplice -m empirical -gc -i dmel-all-r6.44.isoforms.ioi  -p WT_iso.psi Sxl_iso.psi -e  WT.tpm Sxl.tpm -o S2_diffSplice_iso</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-built_in">cat</span> S2_diffSplice_iso.dpsi|perl -alne <span class="hljs-string">&#x27;&#123;print if $F[2] &lt;0.01&#125;&#x27;</span> | less</span><br><br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/8.diffsplice.iso.png" alt="8.diffsplice.iso"></p><p>.</p><p><img src="/2025/03/30/20250329-SUPPA2-for-alternative-splicing/dmel-all-r6.44.isoforms.ioi.png" alt="dmel-all-r6.44.isoforms.ioi"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs R">setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240726_SUPPA2.AS/S2/&quot;</span><span class="hljs-punctuation">)</span><br>suppa_AS <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;project_diffSplice.dpsi&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span>sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;\t&quot;</span><span class="hljs-punctuation">)</span><br>suppa_AS<span class="hljs-operator">$</span>ID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>suppa_AS<span class="hljs-punctuation">)</span><br>suppa_AS <span class="hljs-operator">&lt;-</span> suppa_AS<span class="hljs-punctuation">[</span>suppa_AS<span class="hljs-operator">$</span>WT.Sxl_p.val <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>suppa_AS<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>suppa_AS<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\;&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br><br>write.csv<span class="hljs-punctuation">(</span>suppa_AS<span class="hljs-punctuation">,</span>file <span class="hljs-operator">=</span> <span class="hljs-string">&quot;suppa_AS.csv&quot;</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>.</p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>rmasts2sashimiplot for AS-events</title>
    <link href="/2025/03/27/20250327-rmasts2sashimiplot-for-AS-events/"/>
    <url>/2025/03/27/20250327-rmasts2sashimiplot-for-AS-events/</url>
    
    <content type="html"><![CDATA[<h3 id="rmats2sashimiplot-for-AS-events"><a href="#rmats2sashimiplot-for-AS-events" class="headerlink" title="rmats2sashimiplot for AS-events"></a>rmats2sashimiplot for AS-events</h3><p>.</p><p>rmats2sashimiplot produces a sashimiplot visualization of <a href="https://github.com/Xinglab/rmats-turbo">rMATS</a>  output files.</p><p>and  rmats2sashimiplot can also produce plots using an annotation file and genomic coordinates for target_region.</p><p>.</p><p>the input data</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">annotation_files</span> <br>Drosophila_melanogaster.BDGP6.22.42.gff3<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">bam file</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ctrl_group</span><br>S2-V1.hisat.bam<br>S2-V2.hisat.bam<br><span class="hljs-meta prompt_"># </span><span class="language-bash">treat_group</span><br>S2-S1.hisat.bam<br>S2-S2.hisat.bam<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">location of tra <span class="hljs-keyword">in</span> *gff3</span> <br>3L:-:16590059:16591050<br></code></pre></td></tr></table></figure><p>.</p><p>plot</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda activate py2<br><span class="hljs-meta prompt_"># </span><span class="language-bash">tra</span><br>rmats2sashimiplot <br>--b1 S2-V1.hisat.bam,S2-V2.hisat.bam  <br>--b2 S2-S1.hisat.bam,S2-S2.hisat.bam <br>-c 3L:-:16590059:16591050:./Drosophila_melanogaster.BDGP6.22.42.gff3  <br>--l1 S2_WT <br>--l2 S2_SXL.OE <br>--color &quot;#707B7C,#707B7C,#C0392B,#C0392B&quot;  <br>--exon_s 1 <br>--intron_s 5 <br>-o S2_tra<br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/27/20250327-rmasts2sashimiplot-for-AS-events/sashimiplot.png" alt="sashimiplot"></p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Sankey diagram</title>
    <link href="/2025/03/25/20250325-sankey-diagram/"/>
    <url>/2025/03/25/20250325-sankey-diagram/</url>
    
    <content type="html"><![CDATA[<h3 id="Sankey-diagram"><a href="#Sankey-diagram" class="headerlink" title="Sankey diagram"></a>Sankey diagram</h3><p>.</p><p>Sankey diagrams are  well-suited to visualize flows of differential expression genes ( anything is also ) and with different categories or types.</p><p>.</p><p> input data<br>divide DEGs into three groups : with SXLwith MSL2 and with SXL.MSL2</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------ input data</span><br><br><span class="hljs-comment"># MSL-2 binding in genes (+150 bp)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/240808_msl2_peak.in_gene_S2/&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># msl2_in_genes &lt;- read.table(&quot;peak_in_gene.500bp.txt&quot;,header = F)</span><br>msl2_in_genes <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_gene.150bp.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>msl2_in_genes<span class="hljs-punctuation">)</span><br>msl2_in_genes <span class="hljs-operator">&lt;-</span> msl2_in_genes<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-number">18</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>msl2_in_genes<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_name&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;score&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;foldchange&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;-log10 pvalue&quot;</span><span class="hljs-punctuation">,</span><br>                             <span class="hljs-string">&quot;-log10 qvalue&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;summit_position&quot;</span><span class="hljs-punctuation">,</span><br>                             <span class="hljs-string">&quot;g.chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;g.start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.g.end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;g.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;geneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_name&quot;</span><span class="hljs-punctuation">)</span><br>msl2_in_genes_filter <span class="hljs-operator">&lt;-</span> subset<span class="hljs-punctuation">(</span>msl2_in_genes<span class="hljs-punctuation">,</span> grepl<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;FBgn&quot;</span><span class="hljs-punctuation">,</span> msl2_in_genes<span class="hljs-operator">$</span>geneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>msl2_in_genes_filter <span class="hljs-operator">&lt;-</span> msl2_in_genes_filter<span class="hljs-punctuation">[</span>msl2_in_genes_filter<span class="hljs-operator">$</span>score <span class="hljs-operator">&gt;</span><span class="hljs-number">200</span> <span class="hljs-operator">&amp;</span> <br>                                               msl2_in_genes_filter<span class="hljs-operator">$</span>foldchange <span class="hljs-operator">&gt;</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>msl2_in_genes_gene <span class="hljs-operator">&lt;-</span> msl2_in_genes_filter<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>msl2_in_genes_filter<span class="hljs-operator">$</span>geneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><br><span class="hljs-comment"># Sxl.peak</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/Fan.data/sxl_peak_bind_DEGs/20220328/&quot;</span><span class="hljs-punctuation">)</span><br>peak_intersect_feature <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Sxl-bind-feature.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>peak_intersect_feature<span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>peak_intersect_feature<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak.chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strat&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                                      <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V12&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID_feature&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><br>peak_feature <span class="hljs-operator">&lt;-</span> peak_intersect_feature<br>library<span class="hljs-punctuation">(</span>stringr<span class="hljs-punctuation">)</span><br>peak_feature<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>peak_feature<span class="hljs-operator">$</span>transID <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>peak_feature<span class="hljs-operator">$</span>feature <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br><br>peak_feature <span class="hljs-operator">&lt;-</span> peak_feature<span class="hljs-punctuation">[</span>peak_feature<span class="hljs-operator">$</span>strand <span class="hljs-operator">==</span> peak_feature<span class="hljs-operator">$</span>peak.strand<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>unique<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># peak in 5167 genes</span><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>unique<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>peak.xuhao<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># total</span><br><br>peak_SXL_genes <span class="hljs-operator">&lt;-</span> peak_feature<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>  <br><br><span class="hljs-comment"># DEGs </span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/DEGs/&quot;</span><span class="hljs-punctuation">)</span><br>S2_up <span class="hljs-operator">&lt;-</span> read.csv<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;diff_gene_up.csv&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span>row.names <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><br>S2_down <span class="hljs-operator">&lt;-</span> read.csv<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;diff_gene_down.csv&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span>row.names <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>.</p><p>plot</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------ sankey </span><br><br>S2_DEG <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>S2_up<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>S2_down<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>S2_DEG<span class="hljs-operator">$</span>S2.TYPE <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>S2_DEG<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> msl2_in_genes_gene<span class="hljs-operator">$</span>geneID <span class="hljs-operator">&amp;</span> <br>                           S2_DEG<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_SXL_genes<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;1.SXL.MSL2&quot;</span><span class="hljs-punctuation">,</span><br>                         ifelse<span class="hljs-punctuation">(</span>S2_DEG<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> msl2_in_genes_gene<span class="hljs-operator">$</span>geneID<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;2.MSL2&quot;</span><span class="hljs-punctuation">,</span><br>                                ifelse<span class="hljs-punctuation">(</span>S2_DEG<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_SXL_genes<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;3.SXL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;4.non&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> as.factor<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>S2_DEG<span class="hljs-operator">$</span>DEG <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>S2_DEG<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> S2_up<span class="hljs-operator">$</span>GeneID <span class="hljs-punctuation">,</span><span class="hljs-string">&quot;2.UP&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;1.Down&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> as.factor<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br>S2_DEG <span class="hljs-operator">&lt;-</span> S2_DEG<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>S2_DEG<span class="hljs-operator">$</span>S2.TYPE <span class="hljs-operator">==</span> <span class="hljs-string">&quot;4.non&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>test_S2_UP <span class="hljs-operator">&lt;-</span> S2_DEG<span class="hljs-punctuation">[</span>S2_DEG<span class="hljs-operator">$</span>DEG <span class="hljs-operator">==</span> <span class="hljs-string">&quot;2.UP&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>test_S2_Down <span class="hljs-operator">&lt;-</span> S2_DEG<span class="hljs-punctuation">[</span>S2_DEG<span class="hljs-operator">$</span>DEG <span class="hljs-operator">==</span> <span class="hljs-string">&quot;1.Down&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><br>library<span class="hljs-punctuation">(</span>ggalluvial<span class="hljs-punctuation">)</span><br>rownames<span class="hljs-punctuation">(</span>S2_DEG<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> S2_DEG<span class="hljs-operator">$</span>GeneID<br>S2_DEG <span class="hljs-operator">&lt;-</span> S2_DEG<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>S2_DEG<span class="hljs-operator">$</span>ID <span class="hljs-operator">&lt;-</span>  paste0<span class="hljs-punctuation">(</span>S2_DEG<span class="hljs-operator">$</span>S2.TYPE<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">,</span>S2_DEG<span class="hljs-operator">$</span>DEG<span class="hljs-punctuation">)</span><br><br>plot_dat <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>table<span class="hljs-punctuation">(</span>S2_DEG<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;num&quot;</span><span class="hljs-punctuation">)</span><br><br>plot_dat<span class="hljs-operator">$</span>S2.TYPE <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>plot_dat<span class="hljs-operator">$</span>DEG <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>rownames<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> plot_dat<span class="hljs-operator">$</span>ID<br>plot_dat <span class="hljs-operator">&lt;-</span> subset<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-punctuation">,</span>select<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;S2.TYPE&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;DEG&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;num&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>library<span class="hljs-punctuation">(</span>ggalluvial<span class="hljs-punctuation">)</span><br>plot_dat<span class="hljs-operator">$</span>S2.TYPE <span class="hljs-operator">&lt;-</span> factor<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-operator">$</span>S2.TYPE<span class="hljs-punctuation">,</span><br>                           levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;1.SXL.MSL2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;2.MSL2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;3.SXL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>df <span class="hljs-operator">&lt;-</span> to_lodes_form<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-punctuation">,</span><br>                    key <span class="hljs-operator">=</span> <span class="hljs-string">&quot;x&quot;</span><span class="hljs-punctuation">,</span> value <span class="hljs-operator">=</span> <span class="hljs-string">&quot;stratum&quot;</span><span class="hljs-punctuation">,</span> id <span class="hljs-operator">=</span> <span class="hljs-string">&quot;alluvium&quot;</span><span class="hljs-punctuation">,</span><br>                    axes <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br><br>col <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;#A9CCE3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#EC7063&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#7D3C98&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-string">&quot;#A9CCE3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#EC7063&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#7D3C98&quot;</span><span class="hljs-punctuation">,</span><br>         <span class="hljs-string">&quot;#A9CCE3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#EC7063&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#7D3C98&quot;</span><span class="hljs-punctuation">)</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241106/&quot;</span><span class="hljs-punctuation">)</span><br>pdf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;sankey_S2_only.pdf&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">)</span><br>ggplot<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x<span class="hljs-punctuation">,</span> y<span class="hljs-operator">=</span>num<span class="hljs-punctuation">,</span> fill<span class="hljs-operator">=</span>stratum<span class="hljs-punctuation">,</span> label<span class="hljs-operator">=</span>stratum<span class="hljs-punctuation">,</span><br>               stratum <span class="hljs-operator">=</span> stratum<span class="hljs-punctuation">,</span> alluvium  <span class="hljs-operator">=</span> alluvium<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span> <span class="hljs-comment"># input data</span><br>  geom_flow<span class="hljs-punctuation">(</span>width <span class="hljs-operator">=</span> <span class="hljs-number">0.22</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># Line width</span><br>            curve_type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;arctangent&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-comment">#Curve shapes: linearcubicquinticsinearctangentsigmoid</span><br>            alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span> <br>            color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;white&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span> <span class="hljs-comment"># the color of intervals</span><br>  geom_stratum<span class="hljs-punctuation">(</span>width <span class="hljs-operator">=</span> <span class="hljs-number">0.20</span><span class="hljs-punctuation">,</span> alpha<span class="hljs-operator">=</span><span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span> <span class="hljs-comment"># The width and transparency of the rectangle in the image</span><br>  geom_text<span class="hljs-punctuation">(</span>stat <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;stratum&#x27;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;black&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_fill_manual<span class="hljs-punctuation">(</span>values <span class="hljs-operator">=</span> col<span class="hljs-punctuation">)</span><span class="hljs-operator">+</span> <span class="hljs-comment">#  Color</span><br>  theme_void<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span> <span class="hljs-comment"># Theme (without axes or grid lines)</span><br>  theme<span class="hljs-punctuation">(</span>legend.position <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;none&#x27;</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># Remove the legend</span><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/03/25/20250325-sankey-diagram/sankey%20diagram.png" alt="sankey diagram"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Peak in AS-event region</title>
    <link href="/2025/03/20/20250320-Peak-in-AS-event-region/"/>
    <url>/2025/03/20/20250320-Peak-in-AS-event-region/</url>
    
    <content type="html"><![CDATA[<h3 id="Peak-in-AS-event-region"><a href="#Peak-in-AS-event-region" class="headerlink" title="Peak in AS-event region"></a>Peak in AS-event region</h3><p>.</p><p><strong>Algorithm:</strong></p><p>To quantify the number of splicing events <strong>directly</strong> influenced by RNA-binding proteins,</p><p>we consider the peak which locating in following region (yellow) as a regulator for alternative splicing.</p><p><img src="/2025/03/20/20250320-Peak-in-AS-event-region/region%20of%20splicing%20event%20with%20peak.png" alt="region of splicing event with peak"></p><p>.</p><p><strong>Scripts:</strong></p><p>Peak in AS-event-region </p><p>the region of AS-event shows in Figure peak_in_AS_events 2025-03-18.cvx</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">genome annotation <span class="hljs-keyword">for</span> geneID transform</span><br>setwd(&quot;E:/220625_PC/R workplace/20200110_exp_count_WM/&quot;)<br>library(rtracklayer)<br>genome.anno = import(&quot;dmel-all-r6.44.gtf&quot;) %&gt;% as.data.frame() <br>genome.anno=genome.anno[,c(&quot;gene_id&quot;,&quot;gene_symbol&quot;,&quot;seqnames&quot;,&quot;start&quot;,&quot;end&quot;,&quot;width&quot;,&quot;type&quot;)] <br>head(genome.anno)<br>genome.anno &lt;- genome.anno[genome.anno$type==&quot;gene&quot;,]<br>colnames(genome.anno) &lt;- c(&quot;GeneID&quot;,&quot;gene_symbol&quot;,&quot;seqnames&quot;,&quot;start&quot;,&quot;end&quot;,&quot;width&quot;,&quot;type&quot;)<br><br></code></pre></td></tr></table></figure><p>.</p><p>In light of the output file format from rMATS, the following diagram is instrumental in facilitating the extraction of each individual region within splicing events.</p><p><img src="/2025/03/20/20250320-Peak-in-AS-event-region/postion%20of%20AS-events%20by%20rMATS.png" alt="postion of AS-events by rMATS"></p><p>.</p><p>Extract the region of spliced sites of splcing events.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">------ splice site</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">SE</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;)<br>se_sxl_novelSS_S2 &lt;- read.table(&quot;SE.MATS.JC.txt&quot;,header = T)<br>se_sxl_novelSS_S2 &lt;- merge(se_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">se_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, se_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br><br>S2_se_upstreamEE &lt;- se_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;upstreamEE&quot;)]<br>S2_se_exonStart_0base &lt;- se_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;exonStart_0base&quot;)]<br>S2_se_exonEnd &lt;- se_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;exonEnd&quot;)]<br>S2_se_downstreamES &lt;- se_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;downstreamES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/splice.site/&quot;)<br>write.table(S2_se_upstreamEE,file = &quot;S2_se_upstreamEE.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_se_exonStart_0base,file = &quot;S2_se_exonStart_0base.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_se_exonEnd,file = &quot;S2_se_exonEnd.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_se_downstreamES,file = &quot;S2_se_downstreamES.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">RI</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/new/without_novel/&quot;)<br>ri_sxl_novelSS_S2 &lt;- read.table(&quot;RI.MATS.JC.txt&quot;,header = T)<br>ri_sxl_novelSS_S2 &lt;- merge(ri_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">ri_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, ri_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br><br>S2_ri_upstreamEE &lt;- ri_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;upstreamEE&quot;)]<br>S2_ri_downstreamES &lt;- ri_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;downstreamES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/splice.site/&quot;)<br>write.table(S2_ri_upstreamEE,file = &quot;S2_ri_upstreamEE.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_ri_downstreamES,file = &quot;S2_ri_downstreamES.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">A5SS</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;) <br>a5ss_sxl_novelSS_S2 &lt;- read.table(&quot;A5SS.MATS.JC.txt&quot;,header = T)<br>a5ss_sxl_novelSS_S2 &lt;- merge(a5ss_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">a5ss_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, a5ss_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br>a5ss_sxl_novelSS_S2_p &lt;- a5ss_sxl_novelSS_S2[a5ss_sxl_novelSS_S2$strand == &quot;+&quot;,]<br>a5ss_sxl_novelSS_S2_m &lt;- a5ss_sxl_novelSS_S2[a5ss_sxl_novelSS_S2$strand == &quot;-&quot;,]<br><br>S2_a5ss_p_shortEE &lt;- a5ss_sxl_novelSS_S2_p[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;shortEE&quot;)]<br>S2_a5ss_p_longExonEnd &lt;- a5ss_sxl_novelSS_S2_p[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;longExonEnd&quot;)]<br>S2_a5ss_p_flankingES &lt;- a5ss_sxl_novelSS_S2_p[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;flankingES&quot;)]<br><br>S2_a5ss_m_flankingEE &lt;- a5ss_sxl_novelSS_S2_m[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;flankingEE&quot;)]<br>S2_a5ss_m_longExonStart_0base &lt;- a5ss_sxl_novelSS_S2_m[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;longExonStart_0base&quot;)]<br>S2_a5ss_m_shortES &lt;- a5ss_sxl_novelSS_S2_m[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;shortES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/splice.site/&quot;)<br>write.table(S2_a5ss_p_shortEE,file = &quot;S2_a5ss_p_shortEE.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a5ss_p_longExonEnd,file = &quot;S2_a5ss_p_longExonEnd.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a5ss_p_flankingES,file = &quot;S2_a5ss_p_flankingES.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a5ss_m_flankingEE,file = &quot;S2_a5ss_m_flankingEE.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a5ss_m_longExonStart_0base,file = &quot;S2_a5ss_m_longExonStart_0base.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a5ss_m_shortES,file = &quot;S2_a5ss_m_shortES.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">A3SS</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;) <br>a3ss_sxl_novelSS_S2 &lt;- read.table(&quot;A3SS.MATS.JC.txt&quot;,header = T)<br>a3ss_sxl_novelSS_S2 &lt;- merge(a3ss_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">a3ss_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, a3ss_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br>a3ss_sxl_novelSS_S2_p &lt;- a3ss_sxl_novelSS_S2[a3ss_sxl_novelSS_S2$strand == &quot;+&quot;,]<br>a3ss_sxl_novelSS_S2_m &lt;- a3ss_sxl_novelSS_S2[a3ss_sxl_novelSS_S2$strand == &quot;-&quot;,]<br><br>S2_a3ss_p_flankingEE &lt;- a3ss_sxl_novelSS_S2_p[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;flankingEE&quot;)]<br>S2_a3ss_p_longExonStart_0base &lt;- a3ss_sxl_novelSS_S2_p[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;longExonStart_0base&quot;)]<br>S2_a3ss_p_shortES &lt;- a3ss_sxl_novelSS_S2_p[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;shortES&quot;)]<br><br>S2_a3ss_m_shortEE &lt;- a3ss_sxl_novelSS_S2_m[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;shortEE&quot;)]<br>S2_a3ss_m_longExonEnd &lt;- a3ss_sxl_novelSS_S2_m[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;longExonEnd&quot;)]<br>S2_a3ss_m_flankingES &lt;- a3ss_sxl_novelSS_S2_m[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;flankingES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/splice.site/&quot;)<br>write.table(S2_a3ss_p_flankingEE,file = &quot;S2_a3ss_p_flankingEE.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a3ss_p_longExonStart_0base,file = &quot;S2_a3ss_p_longExonStart_0base.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a3ss_p_shortES,file = &quot;S2_a3ss_p_shortES.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a3ss_m_shortEE,file = &quot;S2_a3ss_m_shortEE.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a3ss_m_longExonEnd,file = &quot;S2_a3ss_m_longExonEnd.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a3ss_m_flankingES,file = &quot;S2_a3ss_m_flankingES.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">MXE</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;)<br>mxe_sxl_novelSS_S2 &lt;- read.table(&quot;MXE.MATS.JC.txt&quot;,header = T)<br>mxe_sxl_novelSS_S2 &lt;- merge(mxe_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">mxe_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, mxe_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br><br>S2_mxe_upstreamEE &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;upstreamEE&quot;)]<br>S2_mxe_X1stExonStart_0base &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;X1stExonStart_0base&quot;)]<br>S2_mxe_X1stExonEnd &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;X1stExonEnd&quot;)]<br>S2_mxe_X2ndExonStart_0base &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;X2ndExonStart_0base&quot;)]<br>S2_mxe_X2ndExonEnd &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;X2ndExonEnd&quot;)]<br>S2_mxe_downstreamES &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;downstreamES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/splice.site/&quot;)<br>write.table(S2_mxe_upstreamEE,file = &quot;S2_mxe_upstreamEE.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_mxe_X1stExonStart_0base,file = &quot;S2_mxe_X1stExonStart_0base.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_mxe_X1stExonEnd,file = &quot;S2_mxe_X1stExonEnd.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_mxe_X2ndExonStart_0base,file = &quot;S2_mxe_X2ndExonStart_0base.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_mxe_X2ndExonEnd,file = &quot;S2_mxe_X2ndExonEnd.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_mxe_X2ndExonEnd,file = &quot;S2_mxe_X2ndExonEnd.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_mxe_downstreamES,file = &quot;S2_mxe_downstreamES.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><br></code></pre></td></tr></table></figure><p>.</p><p>Extract the region of intron related to splcing events.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">------ splicing_related_intron</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">SE</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;)<br>se_sxl_novelSS_S2 &lt;- read.table(&quot;SE.MATS.JC.txt&quot;,header = T)<br>se_sxl_novelSS_S2 &lt;- merge(se_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">se_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, se_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br><br>S2_se_intron1 &lt;- se_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;upstreamEE&quot;,&quot;exonStart_0base&quot;)]<br>S2_se_intron2 &lt;- se_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;exonEnd&quot;,&quot;downstreamES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/intron/&quot;)<br>write.table(S2_se_intron1,file = &quot;S2_se_intron1.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_se_intron2,file = &quot;S2_se_intron2.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">RI</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/new/without_novel/&quot;)<br>ri_sxl_novelSS_S2 &lt;- read.table(&quot;RI.MATS.JC.txt&quot;,header = T)<br>ri_sxl_novelSS_S2 &lt;- merge(ri_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">ri_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, ri_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br><br>S2_ri_intron &lt;- ri_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;upstreamEE&quot;,&quot;downstreamES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/intron/&quot;)<br>write.table(S2_ri_intron,file = &quot;S2_ri_intron.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">A5SS</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;) <br>a5ss_sxl_novelSS_S2 &lt;- read.table(&quot;A5SS.MATS.JC.txt&quot;,header = T)<br>a5ss_sxl_novelSS_S2 &lt;- merge(a5ss_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">a5ss_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, a5ss_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br>a5ss_sxl_novelSS_S2_p &lt;- a5ss_sxl_novelSS_S2[a5ss_sxl_novelSS_S2$strand == &quot;+&quot;,]<br>a5ss_sxl_novelSS_S2_m &lt;- a5ss_sxl_novelSS_S2[a5ss_sxl_novelSS_S2$strand == &quot;-&quot;,]<br><br>S2_a5ss_p_intron &lt;- a5ss_sxl_novelSS_S2_p[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;longExonEnd&quot;,&quot;flankingES&quot;)]<br>S2_a5ss_m_intron &lt;- a5ss_sxl_novelSS_S2_m[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;flankingEE&quot;,&quot;longExonStart_0base&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/intron/&quot;)<br>write.table(S2_a5ss_p_intron,file = &quot;S2_a5ss_p_intron.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a5ss_m_intron,file = &quot;S2_a5ss_m_intron.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">A3SS</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;) <br>a3ss_sxl_novelSS_S2 &lt;- read.table(&quot;A3SS.MATS.JC.txt&quot;,header = T)<br>a3ss_sxl_novelSS_S2 &lt;- merge(a3ss_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">a3ss_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, a3ss_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br>a3ss_sxl_novelSS_S2_p &lt;- a3ss_sxl_novelSS_S2[a3ss_sxl_novelSS_S2$strand == &quot;+&quot;,]<br>a3ss_sxl_novelSS_S2_m &lt;- a3ss_sxl_novelSS_S2[a3ss_sxl_novelSS_S2$strand == &quot;-&quot;,]<br><br>S2_a3ss_p_intron &lt;- a3ss_sxl_novelSS_S2_p[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;flankingEE&quot;,&quot;longExonStart_0base&quot;)]<br>S2_a3ss_m_intorn &lt;- a3ss_sxl_novelSS_S2_m[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;longExonEnd&quot;,&quot;flankingES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/intron/&quot;)<br>write.table(S2_a3ss_p_intron,file = &quot;S2_a3ss_p_intron.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_a3ss_m_intorn,file = &quot;S2_a3ss_m_intorn.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">MXE</span><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;)<br>mxe_sxl_novelSS_S2 &lt;- read.table(&quot;MXE.MATS.JC.txt&quot;,header = T)<br>mxe_sxl_novelSS_S2 &lt;- merge(mxe_sxl_novelSS_S2,genome.anno, by=&quot;GeneID&quot;, all.x=TRUE)<br><span class="hljs-meta prompt_">mxe_sxl_novelSS_S2$</span><span class="language-bash">chr &lt;- gsub(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, mxe_sxl_novelSS_S2<span class="hljs-variable">$chr</span>)</span><br><br>S2_mxe_intron1 &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;upstreamEE&quot;,&quot;X1stExonStart_0base&quot;)]<br>S2_mxe_intron2 &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;X1stExonEnd&quot;,&quot;X2ndExonStart_0base&quot;)]<br>S2_mxe_intron3 &lt;- mxe_sxl_novelSS_S2[,c(&quot;GeneID&quot;,&quot;ID&quot;,&quot;gene_symbol&quot;,&quot;chr&quot;,&quot;strand&quot;,&quot;X2ndExonEnd&quot;,&quot;downstreamES&quot;)]<br><br>setwd(&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/intron/&quot;)<br>write.table(S2_mxe_intron1,file = &quot;S2_mxe_intron1.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_mxe_intron2,file = &quot;S2_mxe_intron2.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br>write.table(S2_mxe_intron3,file = &quot;S2_mxe_intron3.txt&quot;,quote = F,row.names = F,col.names = F,sep = &#x27;\t&#x27;)<br></code></pre></td></tr></table></figure><p>.</p><p>Get the peak which located on the identified region by shell script</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">------ splice site(-50bp &amp; +50bp)</span> <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">to bed</span><br>ls *.txt |while read id; do(less $id | awk &#x27;&#123;print $4&quot;\t&quot;$6-50&quot;\t&quot;$6+50&quot;\t&quot;$1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;$4&quot;\t&quot;$5&quot;\t&quot;$6&#125;&#x27;  &gt; $(basename $&#123;id&#125; &quot;.txt&quot;).bed );done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">get intersected peak</span><br>ls *bed | while read id; do(bedtools intersect -a ../../../F.peak.bed -b $id -wa -wb |sort -k4 &gt; peak_in_$(basename $&#123;id&#125; &quot;.bed&quot;));done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">------ intron</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Convert all irregular delimiters <span class="hljs-keyword">in</span> the file to tab (<span class="hljs-string">&quot;\t&quot;</span>) separation</span> <br>ls *.txt |while read id; do(tr -d &#x27;\r&#x27; &lt; $id | sed &#x27;s/ \+/\t/g&#x27;  &gt; $(basename $&#123;id&#125; &quot;.txt&quot;).TXT );done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">to bed</span><br>ls *.TXT |while read id; do(less $id | awk &#x27;&#123;print $4&quot;\t&quot;$6&quot;\t&quot;$7&quot;\t&quot;$1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;$5&#125;&#x27;  &gt; $(basename $&#123;id&#125; &quot;.TXT&quot;).bed );done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">get intersected peak</span><br>ls *bed | while read id; do(bedtools intersect -a ../../F.peak.bed -b $id -wa -wb |sort -k4 &gt; peak_in_$(basename $&#123;id&#125; &quot;.bed&quot;));done<br></code></pre></td></tr></table></figure><p>.</p><p>Peak in spliced-related region</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#------------------------------------ with peak </span><br><br><span class="hljs-comment"># the shell script &amp; data in : </span><br><span class="hljs-comment"># /data1/amliang/projects/sxl_DC/220906_peak_in_AS.events/20250318_peak_in_S2</span><br><br><span class="hljs-comment"># ------ peak in splice site</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/splice.site/&quot;</span><span class="hljs-punctuation">)</span><br>peak_in_S2_se_upstreamEE <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_se_upstreamEE&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_se_exonStart_0base <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_se_exonStart_0base&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_se_exonEnd <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_se_exonEnd&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_se_downstreamES <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_se_downstreamES&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_ri_upstreamEE <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_ri_upstreamEE&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_ri_downstreamES <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_ri_downstreamES&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_a5ss_p_shortEE <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a5ss_p_shortEE&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a5ss_p_longExonEnd <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a5ss_p_longExonEnd&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a5ss_p_flankingES <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a5ss_p_flankingES&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a5ss_m_flankingEE <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a5ss_m_flankingEE&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a5ss_m_longExonStart_0base <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a5ss_m_longExonStart_0base&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a5ss_m_shortES <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a5ss_m_shortES&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_a3ss_p_flankingEE <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a3ss_p_flankingEE&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a3ss_p_longExonStart_0base <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a3ss_p_longExonStart_0base&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a3ss_p_shortES <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a3ss_p_shortES&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a3ss_m_shortEE <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a3ss_m_shortEE&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a3ss_m_longExonEnd <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a3ss_m_longExonEnd&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a3ss_m_flankingES <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a3ss_m_flankingES&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_mxe_upstreamEE<span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_upstreamEE&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_mxe_X1stExonStart_0base <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_X1stExonStart_0base&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_mxe_X1stExonEnd<span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_X1stExonEnd&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_mxe_X2ndExonStart_0base<span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_X2ndExonStart_0base&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_mxe_X2ndExonEnd<span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_X2ndExonEnd&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_mxe_downstreamES<span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_downstreamES&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># </span><br>peak_in_S2_se_SS <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_se_upstreamEE<span class="hljs-punctuation">,</span><br>                       peak_in_S2_se_exonStart_0base<span class="hljs-punctuation">,</span><br>                       peak_in_S2_se_exonEnd<span class="hljs-punctuation">,</span><br>                       peak_in_S2_se_downstreamES<span class="hljs-punctuation">)</span><br><br>peak_in_S2_ri_SS <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_ri_upstreamEE<span class="hljs-punctuation">,</span><br>                       peak_in_S2_ri_downstreamES<span class="hljs-punctuation">)</span><br><br>peak_in_S2_a5ss_SS <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_a5ss_p_shortEE<span class="hljs-punctuation">,</span><br>                       peak_in_S2_a5ss_p_longExonEnd<span class="hljs-punctuation">,</span><br>                       peak_in_S2_a5ss_p_flankingES<span class="hljs-punctuation">,</span><br>                       peak_in_S2_a5ss_m_flankingEE<span class="hljs-punctuation">,</span><br>                       peak_in_S2_a5ss_m_longExonStart_0base<span class="hljs-punctuation">,</span><br>                       peak_in_S2_a5ss_m_shortES<span class="hljs-punctuation">)</span><br><br>peak_in_S2_a3ss_SS <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_a3ss_p_flankingEE<span class="hljs-punctuation">,</span><br>                            peak_in_S2_a3ss_p_longExonStart_0base<span class="hljs-punctuation">,</span><br>                            peak_in_S2_a3ss_p_shortES<span class="hljs-punctuation">,</span><br>                            peak_in_S2_a3ss_m_shortEE<span class="hljs-punctuation">,</span><br>                            peak_in_S2_a3ss_m_longExonEnd<span class="hljs-punctuation">,</span><br>                            peak_in_S2_a3ss_m_flankingES<span class="hljs-punctuation">)</span><br><br>peak_in_S2_mxe_SS <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_mxe_upstreamEE<span class="hljs-punctuation">,</span><br>                            peak_in_S2_mxe_X1stExonStart_0base<span class="hljs-punctuation">,</span><br>                            peak_in_S2_mxe_X1stExonEnd<span class="hljs-punctuation">,</span><br>                            peak_in_S2_mxe_X2ndExonStart_0base<span class="hljs-punctuation">,</span><br>                            peak_in_S2_mxe_X2ndExonEnd<span class="hljs-punctuation">,</span><br>                            peak_in_S2_mxe_downstreamES<span class="hljs-punctuation">)</span><br><br>col_name_ss <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                     <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;pos&quot;</span><span class="hljs-punctuation">)</span><br><br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_se_SS<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_ss <br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_ri_SS<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_ss <br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_a5ss_SS<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_ss <br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_a3ss_SS<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_ss <br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_mxe_SS<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_ss <br><br><br><span class="hljs-comment"># ------ peak in splice site</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250318/intron/&quot;</span><span class="hljs-punctuation">)</span><br>peak_in_S2_se_intron1 <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_se_intron1&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_se_intron2 <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_se_intron2&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_ri_intron <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_ri_intron&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_a5ss_p_intron <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a5ss_p_intron&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a5ss_m_intron <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a5ss_m_intron&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_a3ss_p_intron <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a3ss_p_intron&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_a3ss_m_intron <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_a3ss_m_intorn&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_mxe_intron1 <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_intron1&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_mxe_intron2 <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_intron2&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>peak_in_S2_mxe_intron3 <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_in_S2_mxe_intron3&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><br>peak_in_S2_se_intron <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_se_intron1<span class="hljs-punctuation">,</span><br>                              peak_in_S2_se_intron2<span class="hljs-punctuation">)</span><br>peak_in_S2_a5ss_intron <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_a5ss_p_intron<span class="hljs-punctuation">,</span><br>                                peak_in_S2_a5ss_m_intron<span class="hljs-punctuation">)</span><br>peak_in_S2_a3ss_intron <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_a3ss_p_intron<span class="hljs-punctuation">,</span><br>                                peak_in_S2_a3ss_m_intron<span class="hljs-punctuation">)</span><br>peak_in_S2_mxe_intron <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_mxe_intron1<span class="hljs-punctuation">,</span><br>                               peak_in_S2_mxe_intron2<span class="hljs-punctuation">,</span><br>                               peak_in_S2_mxe_intron3<span class="hljs-punctuation">)</span><br><br>col_name_intron <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                 <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><br><br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_se_intron<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_intron <br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_ri_intron<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_intron <br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_a5ss_intron<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_intron <br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_a3ss_intron<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_intron <br>colnames<span class="hljs-punctuation">(</span>peak_in_S2_mxe_intron<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> col_name_intron <br><br><br><span class="hljs-comment"># ------ merge peak in splice site and intron</span><br>peak_in_S2_se_SS <span class="hljs-operator">&lt;-</span> peak_in_S2_se_SS<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>peak_in_S2_ri_SS <span class="hljs-operator">&lt;-</span> peak_in_S2_ri_SS<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>peak_in_S2_a5ss_SS <span class="hljs-operator">&lt;-</span> peak_in_S2_a5ss_SS<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>peak_in_S2_a3ss_SS <span class="hljs-operator">&lt;-</span> peak_in_S2_a3ss_SS<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>peak_in_S2_mxe_SS <span class="hljs-operator">&lt;-</span> peak_in_S2_mxe_SS<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak_chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                                        <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br><br>peak_SE_S2 <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_se_SS<span class="hljs-punctuation">,</span>peak_in_S2_se_intron<span class="hljs-punctuation">)</span><br>peak_RI_S2 <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_ri_SS<span class="hljs-punctuation">,</span>peak_in_S2_ri_intron<span class="hljs-punctuation">)</span><br>peak_A5SS_S2 <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_a5ss_SS<span class="hljs-punctuation">,</span>peak_in_S2_a5ss_intron<span class="hljs-punctuation">)</span><br>peak_A3SS_S2 <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_a3ss_SS<span class="hljs-punctuation">,</span>peak_in_S2_a3ss_intron<span class="hljs-punctuation">)</span><br>peak_MXE_S2 <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>peak_in_S2_mxe_SS<span class="hljs-punctuation">,</span>peak_in_S2_mxe_intron<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># filter</span><br>peak_SE_S2  <span class="hljs-operator">&lt;-</span> peak_SE_S2<span class="hljs-punctuation">[</span>peak_SE_S2<span class="hljs-operator">$</span>peak.strand <span class="hljs-operator">==</span> peak_SE_S2<span class="hljs-operator">$</span>strand<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>peak_RI_S2  <span class="hljs-operator">&lt;-</span> peak_RI_S2<span class="hljs-punctuation">[</span>peak_RI_S2<span class="hljs-operator">$</span>peak.strand <span class="hljs-operator">==</span> peak_RI_S2<span class="hljs-operator">$</span>strand<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>peak_A5SS_S2  <span class="hljs-operator">&lt;-</span> peak_A5SS_S2<span class="hljs-punctuation">[</span>peak_A5SS_S2<span class="hljs-operator">$</span>peak.strand <span class="hljs-operator">==</span> peak_A5SS_S2<span class="hljs-operator">$</span>strand<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>peak_A3SS_S2  <span class="hljs-operator">&lt;-</span> peak_A3SS_S2<span class="hljs-punctuation">[</span>peak_A3SS_S2<span class="hljs-operator">$</span>peak.strand <span class="hljs-operator">==</span> peak_A3SS_S2<span class="hljs-operator">$</span>strand<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>peak_MXE_S2  <span class="hljs-operator">&lt;-</span> peak_MXE_S2<span class="hljs-punctuation">[</span>peak_MXE_S2<span class="hljs-operator">$</span>peak.strand <span class="hljs-operator">==</span> peak_MXE_S2<span class="hljs-operator">$</span>strand<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure><p>.</p><p>Significant alternative splicing events</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#------ AS-events</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/raw_gtf/novel/&quot;</span><span class="hljs-punctuation">)</span> <br>S2_se_novelSS <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;SE.MATS.JC.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>S2_a3ss_novelSS <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;A3SS.MATS.JC.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>S2_a5ss_novelSS <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;A5SS.MATS.JC.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>S2_mxe_novelSS <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;MXE.MATS.JC.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/220421_SXL.S2/AS/230806_AS/new/without_novel/&quot;</span><span class="hljs-punctuation">)</span> <br>S2_ri_novelSS <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;RI.MATS.JC.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br><br>library<span class="hljs-punctuation">(</span>stringr<span class="hljs-punctuation">)</span><br>S2_se_novelSS<span class="hljs-operator">$</span>SJC_WT_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_se_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_se_novelSS<span class="hljs-operator">$</span>SJC_WT_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_se_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_se_novelSS<span class="hljs-operator">$</span>SJC_WT_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_se_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br>S2_se_novelSS<span class="hljs-operator">$</span>SJC_Sxl_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_se_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_se_novelSS<span class="hljs-operator">$</span>SJC_Sxl_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_se_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_se_novelSS<span class="hljs-operator">$</span>SJC_Sxl_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_se_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br><br>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_WT_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_WT_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_WT_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_Sxl_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_Sxl_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_Sxl_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_ri_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br><br>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_WT_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_WT_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_WT_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_Sxl_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_Sxl_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_Sxl_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a5ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br><br>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_WT_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_WT_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_WT_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_Sxl_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_Sxl_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_Sxl_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_a3ss_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br><br>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_WT_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_WT_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_WT_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_1<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_Sxl_1 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_Sxl_2 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_Sxl_3 <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>S2_mxe_novelSS<span class="hljs-operator">$</span>SJC_SAMPLE_2<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\,&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br><br><br><span class="hljs-comment"># gene ID transform</span><br>S2_se_novelSS <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>S2_se_novelSS<span class="hljs-punctuation">,</span>genome.anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>S2_ri_novelSS <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>S2_ri_novelSS<span class="hljs-punctuation">,</span>genome.anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>S2_a5ss_novelSS <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>S2_a5ss_novelSS<span class="hljs-punctuation">,</span>genome.anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>S2_a3ss_novelSS <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>S2_a3ss_novelSS<span class="hljs-punctuation">,</span>genome.anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>S2_mxe_novelSS <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>S2_mxe_novelSS<span class="hljs-punctuation">,</span> genome.anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><br>S2_diff_se_up <span class="hljs-operator">&lt;-</span> S2_se_novelSS<span class="hljs-punctuation">[</span>S2_se_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_se_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&gt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_se_down <span class="hljs-operator">&lt;-</span> S2_se_novelSS<span class="hljs-punctuation">[</span>S2_se_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_se_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&lt;</span> <span class="hljs-operator">-</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_ri_up <span class="hljs-operator">&lt;-</span> S2_ri_novelSS<span class="hljs-punctuation">[</span>S2_ri_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_ri_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&gt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_ri_down <span class="hljs-operator">&lt;-</span> S2_ri_novelSS<span class="hljs-punctuation">[</span>S2_ri_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_ri_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&lt;</span> <span class="hljs-operator">-</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a3ss_up <span class="hljs-operator">&lt;-</span> S2_a3ss_novelSS<span class="hljs-punctuation">[</span>S2_a3ss_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_a3ss_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&gt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a3ss_down <span class="hljs-operator">&lt;-</span> S2_a3ss_novelSS<span class="hljs-punctuation">[</span>S2_a3ss_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_a3ss_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&lt;</span> <span class="hljs-operator">-</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a5ss_up <span class="hljs-operator">&lt;-</span> S2_a5ss_novelSS<span class="hljs-punctuation">[</span>S2_a5ss_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_a5ss_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&gt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a5ss_down <span class="hljs-operator">&lt;-</span> S2_a5ss_novelSS<span class="hljs-punctuation">[</span>S2_a5ss_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_a5ss_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&lt;</span> <span class="hljs-operator">-</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_mxe_up <span class="hljs-operator">&lt;-</span> S2_mxe_novelSS<span class="hljs-punctuation">[</span>S2_mxe_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_mxe_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&gt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_mxe_down <span class="hljs-operator">&lt;-</span> S2_mxe_novelSS<span class="hljs-punctuation">[</span>S2_mxe_novelSS<span class="hljs-operator">$</span>FDR <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">&amp;</span> S2_mxe_novelSS<span class="hljs-operator">$</span>IncLevelDifference <span class="hljs-operator">&lt;</span> <span class="hljs-operator">-</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_se_up_filter <span class="hljs-operator">&lt;-</span> S2_diff_se_up<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_se_up<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                       <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_se_up<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                            <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                        apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_se_up<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                         <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_se_up<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                              <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_se_down_filter <span class="hljs-operator">&lt;-</span> S2_diff_se_down<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_se_down<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                           <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_se_down<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                            apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_se_down<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                             <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_se_down<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_ri_up_filter <span class="hljs-operator">&lt;-</span> S2_diff_ri_up<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_ri_up<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                       <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_ri_up<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                            <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                        apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_ri_up<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                         <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_ri_up<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                              <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_ri_down_filter <span class="hljs-operator">&lt;-</span> S2_diff_ri_down<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_ri_down<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                           <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_ri_down<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                            apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_ri_down<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                             <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_ri_down<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_a3ss_up_filter <span class="hljs-operator">&lt;-</span> S2_diff_a3ss_up<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a3ss_up<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                           <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a3ss_up<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                            apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a3ss_up<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                             <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a3ss_up<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a3ss_down_filter <span class="hljs-operator">&lt;-</span> S2_diff_a3ss_down<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a3ss_down<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                               <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a3ss_down<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                    <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                                apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a3ss_down<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                                 <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a3ss_down<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                      <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_a5ss_up_filter <span class="hljs-operator">&lt;-</span> S2_diff_a5ss_up<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a5ss_up<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                           <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a5ss_up<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                            apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a5ss_up<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                             <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a5ss_up<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a5ss_down_filter <span class="hljs-operator">&lt;-</span> S2_diff_a5ss_down<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a5ss_down<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                               <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a5ss_down<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                    <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                                apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a5ss_down<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                                 <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_a5ss_down<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                      <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_mxe_up_filter <span class="hljs-operator">&lt;-</span> S2_diff_mxe_up<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_mxe_up<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                         <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_mxe_up<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                              <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                          apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_mxe_up<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                           <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_mxe_up<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_mxe_down_filter <span class="hljs-operator">&lt;-</span> S2_diff_mxe_down<span class="hljs-punctuation">[</span>apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_mxe_down<span class="hljs-operator">$</span>SJC_WT_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                             <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_mxe_down<span class="hljs-operator">$</span>SJC_WT_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-operator">|</span><br>                                              apply<span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_mxe_down<span class="hljs-operator">$</span>SJC_Sxl_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                               <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>S2_diff_mxe_down<span class="hljs-operator">$</span>SJC_Sxl_2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                                    <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><p>.</p><p>Peak in AS-events-region</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------ peak in AS-events-region</span><br>S2_diff_se_up_peak <span class="hljs-operator">&lt;-</span> S2_diff_se_up_filter<span class="hljs-punctuation">[</span>S2_diff_se_up_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_SE_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_se_down_peak <span class="hljs-operator">&lt;-</span> S2_diff_se_down_filter<span class="hljs-punctuation">[</span>S2_diff_se_down_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_SE_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_ri_up_peak <span class="hljs-operator">&lt;-</span> S2_diff_ri_up_filter<span class="hljs-punctuation">[</span>S2_diff_ri_up_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_RI_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_ri_down_peak <span class="hljs-operator">&lt;-</span> S2_diff_ri_down_filter<span class="hljs-punctuation">[</span>S2_diff_ri_down_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_RI_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_a5ss_up_peak <span class="hljs-operator">&lt;-</span> S2_diff_a5ss_up_filter<span class="hljs-punctuation">[</span>S2_diff_a5ss_up_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_A5SS_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a5ss_down_peak <span class="hljs-operator">&lt;-</span> S2_diff_a5ss_down_filter<span class="hljs-punctuation">[</span>S2_diff_a5ss_down_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_A5SS_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_a3ss_up_peak <span class="hljs-operator">&lt;-</span> S2_diff_a3ss_up_filter<span class="hljs-punctuation">[</span>S2_diff_a3ss_up_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_A3SS_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a3ss_down_peak <span class="hljs-operator">&lt;-</span> S2_diff_a3ss_down_filter<span class="hljs-punctuation">[</span>S2_diff_a3ss_down_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_A3SS_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_mxe_up_peak <span class="hljs-operator">&lt;-</span> S2_diff_mxe_up_filter<span class="hljs-punctuation">[</span>S2_diff_mxe_up_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_MXE_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_mxe_down_peak <span class="hljs-operator">&lt;-</span> S2_diff_mxe_down_filter<span class="hljs-punctuation">[</span>S2_diff_mxe_down_filter<span class="hljs-operator">$</span>ID <span class="hljs-operator">%in%</span> peak_MXE_S2<span class="hljs-operator">$</span>ID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure><p>.</p><p>Peak in gene with AS-events</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------ peak in AS-events-genes</span><br><br><span class="hljs-comment"># peak</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/Fan.data/sxl_peak_bind_DEGs/20220328/&quot;</span><span class="hljs-punctuation">)</span><br>peak_intersect_feature <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Sxl-bind-feature.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>peak_intersect_feature<span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>peak_intersect_feature<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak.chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strat&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                                      <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V12&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID_feature&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><br>peak_feature <span class="hljs-operator">&lt;-</span> peak_intersect_feature<br>library<span class="hljs-punctuation">(</span>stringr<span class="hljs-punctuation">)</span><br>peak_feature<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>peak_feature<span class="hljs-operator">$</span>transID <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>peak_feature<span class="hljs-operator">$</span>feature <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br><br>peak_feature <span class="hljs-operator">&lt;-</span> peak_feature<span class="hljs-punctuation">[</span>peak_feature<span class="hljs-operator">$</span>strand <span class="hljs-operator">==</span> peak_feature<span class="hljs-operator">$</span>peak.strand<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>peak_feature<span class="hljs-operator">$</span>pos <span class="hljs-operator">&lt;-</span> paste0<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>peak.chr<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;:&quot;</span><span class="hljs-punctuation">,</span>peak_feature<span class="hljs-operator">$</span>peak.strat<span class="hljs-punctuation">)</span><br>peak_feature<span class="hljs-operator">$</span>pos <span class="hljs-operator">&lt;-</span> paste0<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>pos<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;-&quot;</span><span class="hljs-punctuation">,</span>peak_feature<span class="hljs-operator">$</span>peak.end<span class="hljs-punctuation">)</span><br>peak_gene <span class="hljs-operator">&lt;-</span> peak_feature<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>peak_feature<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><br><span class="hljs-comment"># </span><br>S2_diff_se_up_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_se_up_filter<span class="hljs-punctuation">[</span>S2_diff_se_up_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_se_down_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_se_down_filter<span class="hljs-punctuation">[</span>S2_diff_se_down_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_ri_up_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_ri_up_filter<span class="hljs-punctuation">[</span>S2_diff_ri_up_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_ri_down_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_ri_down_filter<span class="hljs-punctuation">[</span>S2_diff_ri_down_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_a3ss_up_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_a3ss_up_filter<span class="hljs-punctuation">[</span>S2_diff_a3ss_up_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a3ss_down_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_a3ss_down_filter<span class="hljs-punctuation">[</span>S2_diff_a3ss_down_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_a5ss_up_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_a5ss_up_filter<span class="hljs-punctuation">[</span>S2_diff_a5ss_up_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_a5ss_down_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_a5ss_down_filter<span class="hljs-punctuation">[</span>S2_diff_a5ss_down_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>S2_diff_mxe_up_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_mxe_up_filter<span class="hljs-punctuation">[</span>S2_diff_mxe_up_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>S2_diff_mxe_down_peak.gene <span class="hljs-operator">&lt;-</span> S2_diff_mxe_down_filter<span class="hljs-punctuation">[</span>S2_diff_mxe_down_filter<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><p>.</p><p>Count the number of splicing events associated with peak binding.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------ STATICS</span><br><br><span class="hljs-comment"># get all var in environment</span><br>peak_in_ss_names <span class="hljs-operator">&lt;-</span> ls<span class="hljs-punctuation">(</span>pattern <span class="hljs-operator">=</span> <span class="hljs-string">&quot;^S2_diff_.*_peak$&quot;</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># Get all variables with named &quot;S2_diff_xx_xx_peak&quot;</span><br>peak_in_gene_names <span class="hljs-operator">&lt;-</span> ls<span class="hljs-punctuation">(</span>pattern <span class="hljs-operator">=</span> <span class="hljs-string">&quot;^S2_diff_.*_peak\\.gene$&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-comment">#  &quot;S2_diff_xx_xx_peak.gene&quot;</span><br>diff_AS_names <span class="hljs-operator">&lt;-</span> ls<span class="hljs-punctuation">(</span>pattern <span class="hljs-operator">=</span> <span class="hljs-string">&quot;^S2_diff_.*_filter$&quot;</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># &quot;d.mut_f.wt_XX_XX&quot;</span><br><br><span class="hljs-comment"># sort and match names</span><br>peak_in_ss_names <span class="hljs-operator">&lt;-</span> sort<span class="hljs-punctuation">(</span>peak_in_ss_names<span class="hljs-punctuation">)</span><br>peak_in_gene_names <span class="hljs-operator">&lt;-</span> sort<span class="hljs-punctuation">(</span>peak_in_gene_names<span class="hljs-punctuation">)</span><br>diff_AS_names <span class="hljs-operator">&lt;-</span> sort<span class="hljs-punctuation">(</span>diff_AS_names<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># statics the nrow</span><br>row_counts_df <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  Dataset <span class="hljs-operator">=</span> peak_var_names<span class="hljs-punctuation">,</span> <br>  peak_in_ss_Counts <span class="hljs-operator">=</span> sapply<span class="hljs-punctuation">(</span>mget<span class="hljs-punctuation">(</span>peak_in_ss_names<span class="hljs-punctuation">,</span> ifnotfound <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  peak_in_gene_Counts <span class="hljs-operator">=</span> sapply<span class="hljs-punctuation">(</span>mget<span class="hljs-punctuation">(</span>peak_in_gene_names<span class="hljs-punctuation">,</span> ifnotfound <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  diff_AS_Counts <span class="hljs-operator">=</span> sapply<span class="hljs-punctuation">(</span>mget<span class="hljs-punctuation">(</span>diff_AS_names<span class="hljs-punctuation">,</span> ifnotfound <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>.</p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>TF_annotatoion for target_genes</title>
    <link href="/2025/03/16/20250315-TF-annotatoion-for-target-genes/"/>
    <url>/2025/03/16/20250315-TF-annotatoion-for-target-genes/</url>
    
    <content type="html"><![CDATA[<h3 id="Transcript-factor-annotation-for-target-genes"><a href="#Transcript-factor-annotation-for-target-genes" class="headerlink" title="Transcript factor annotation for target genes"></a>Transcript factor annotation for target genes</h3><p>.</p><p>First, I downloaded the data on human transcription factors and their target genes from <a href="https://www.grnpedia.org/trrust/downloadnetwork.php">https://www.grnpedia.org/trrust/downloadnetwork.php</a>, as shown in the picture below.</p><p><img src="/2025/03/16/20250315-TF-annotatoion-for-target-genes/TF%20and%20target%20genes.png" alt="TF and target genes"></p><p>.</p><p>and downloaded the table that lists transcription factors and their corresponding transcription factor families from <a href="https://guolab.wchscu.cn/AnimalTFDB4//#/Download">https://guolab.wchscu.cn/AnimalTFDB4//#/Download</a>, as illustrated below:</p><p><img src="/2025/03/16/20250315-TF-annotatoion-for-target-genes/TF%20and%20TF_family.png" alt="TF and TF_family"></p><p>.</p><p>the pipeline of TF_annotation of DEGs is as follows.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 1) download TF_target</span><br><span class="hljs-comment"># https://www.grnpedia.org/trrust/downloadnetwork.php</span><br><span class="hljs-comment"># 2) download TF_family</span><br><span class="hljs-comment"># https://guolab.wchscu.cn/AnimalTFDB4//#/Download</span><br><br><span class="hljs-comment"># TF for DEGs</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/230922_HJ/250305_TF/&quot;</span><span class="hljs-punctuation">)</span><br>annimalTFDB_homo_TF <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;animalTFDB_Homo_sapiens_TF.txt&quot;</span><span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;\t&#x27;</span><span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span> <br>head<span class="hljs-punctuation">(</span>annimalTFDB_homo_TF<span class="hljs-punctuation">)</span><br>TRRUST_homo <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;trrust_rawdata.human.tsv&quot;</span><span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span> <br>colnames<span class="hljs-punctuation">(</span>TRRUST_homo<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;TF&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;target_gene&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;regulation&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;PMID&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>TRRUST_homo<span class="hljs-punctuation">)</span><br><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>intersect<span class="hljs-punctuation">(</span>TRRUST_homo<span class="hljs-operator">$</span>TF<span class="hljs-punctuation">,</span>annimalTFDB_homo_TF<span class="hljs-operator">$</span>Symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="/2025/03/16/20250315-TF-annotatoion-for-target-genes/annimalTFBD_homo_TF.png" alt="annimalTFBD_homo_TF"></p><p><img src="/2025/03/16/20250315-TF-annotatoion-for-target-genes/TRRUST_homo.png" alt="TRRUST_homo"></p><p>.</p><p>load your genes (target genes)</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># DEGs</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/230922_HJ/250305_TF/Differentially_expressed_gene/Diff_exp/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>df_GFP.VEGF_shSND1.VEGF<span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;df_GFP.VEGF_shSND1.VEGF.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;gene_diff&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span> <span class="hljs-punctuation">)</span> <br>colnames<span class="hljs-punctuation">(</span>df_GFP.VEGF_shSND1.VEGF<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;gene_symbol&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;log2FC&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;pvalue&#x27;</span><span class="hljs-punctuation">)</span><br>df_GFP.VEGF_shSND1.VEGF<span class="hljs-operator">$</span>log2FC <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>df_GFP.VEGF_shSND1.VEGF<span class="hljs-operator">$</span>log2FC<span class="hljs-punctuation">)</span><br>df_GFP.VEGF_shSND1.VEGF<span class="hljs-operator">$</span>pvalue <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>df_GFP.VEGF_shSND1.VEGF<span class="hljs-operator">$</span>pvalue<span class="hljs-punctuation">)</span><br>DEG_GFP.VEGF_shSND1.VEGF <span class="hljs-operator">&lt;-</span> df_GFP.VEGF_shSND1.VEGF<span class="hljs-punctuation">[</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>df_GFP.VEGF_shSND1.VEGF<span class="hljs-operator">$</span>log2FC<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span><span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> <br>                                                      df_GFP.VEGF_shSND1.VEGF<span class="hljs-operator">$</span>pvalue <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>intersect<span class="hljs-punctuation">(</span>TRRUST_homo<span class="hljs-operator">$</span>target_gene<span class="hljs-punctuation">,</span>DEG_GFP.VEGF_shSND1.VEGF<span class="hljs-operator">$</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>.</p><p>merge the table and get the target genes of TF</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># merge TF and target genes</span><br>TF_target <span class="hljs-operator">&lt;-</span> TRRUST_homo<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>TF_target<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Symbol&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;gene_symbol&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;regulate&#x27;</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># Symbol is TF and gene_symbol is target_genes</span><br><br>DEG_tf <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>TF_target <span class="hljs-punctuation">,</span>DEG_GFP.VEGF_shSND1.VEGF<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span>all.y <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># gene_symbol is target_genes</span><br>DEG_tf <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>DEG_tf<span class="hljs-punctuation">)</span><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>unique<span class="hljs-punctuation">(</span>DEG_tf<span class="hljs-operator">$</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># mergr TF and TF_family</span><br>DEG_tf_family <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>DEG_tf<span class="hljs-punctuation">,</span>annimalTFDB_homo_TF<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Symbol&#x27;</span><span class="hljs-punctuation">,</span>all.x <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>DEG_tf_family <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>DEG_tf_family<span class="hljs-punctuation">)</span><br><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>unique<span class="hljs-punctuation">(</span>DEG_tf_family<span class="hljs-operator">$</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>table<span class="hljs-punctuation">(</span>DEG_tf_family<span class="hljs-operator">$</span>Family<span class="hljs-punctuation">)</span><br><br>write.csv<span class="hljs-punctuation">(</span>DEG_tf_family<span class="hljs-punctuation">,</span>file <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;DEG_tf_family.csv&#x27;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Its case_when, not ifelse</title>
    <link href="/2025/02/22/20250222-case-when-instead-of-multiple-if-else/"/>
    <url>/2025/02/22/20250222-case-when-instead-of-multiple-if-else/</url>
    
    <content type="html"><![CDATA[<h3 id="Its-case-when-not-ifelse"><a href="#Its-case-when-not-ifelse" class="headerlink" title="Its case_when(), not ifelse()"></a>Its case_when(), not ifelse()</h3><p>.</p><p>In order to create a groupings for the group variable with multiple conditional, but  the nested <code>ifelse()</code> approach would become unwieldy. So, I implemented the <code>case_when()</code> function from the <code>dplyr</code> package, combined with <code>mutate()</code> to systematically handle all combinatorial scenarios</p><p>.</p><p>the input data</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs R"><br><span class="hljs-comment"># export nuclear</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240508&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>new_FC <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;export_240508.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;new_FC&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>FC_up <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;export_240508.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;FC_up&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>FC_down <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;export_240508.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;FC_down&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># transla efficiency</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250118&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>TE_S2 <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;transla_241023.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>TE_up <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;transla_241023.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_up&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>TE_down <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;transla_241023.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_down&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># peak</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/Fan.data/sxl_peak_bind_DEGs/20220328/&quot;</span><span class="hljs-punctuation">)</span><br>peak_intersect_feature <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Sxl-bind-feature.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>peak_intersect_feature<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;peak.chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strat&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.xuhao&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log10Pv&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak.strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;siteScore&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V8&quot;</span><span class="hljs-punctuation">,</span><br>                                      <span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;V12&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ID_feature&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">)</span><br>peak <span class="hljs-operator">&lt;-</span> peak_intersect_feature<br>library<span class="hljs-punctuation">(</span>stringr<span class="hljs-punctuation">)</span><br>peak<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>peak<span class="hljs-operator">$</span>transID <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>peak<span class="hljs-operator">$</span>feature <span class="hljs-operator">&lt;-</span> str_split<span class="hljs-punctuation">(</span>peak<span class="hljs-operator">$</span>ID_feature<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;\\_&quot;</span><span class="hljs-punctuation">,</span>simplify <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><br>peak <span class="hljs-operator">&lt;-</span> peak<span class="hljs-punctuation">[</span>peak<span class="hljs-operator">$</span>strand <span class="hljs-operator">==</span> peak<span class="hljs-operator">$</span>peak.strand<span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>peak_gene <span class="hljs-operator">&lt;-</span> peak<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>peak<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># merge</span><br>export_dat <span class="hljs-operator">&lt;-</span> new_FC<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log2FC_Sxl.WT&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>transla_dat <span class="hljs-operator">&lt;-</span> TE_S2<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log2FoldChange&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>input_dat <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>export_dat<span class="hljs-punctuation">,</span>transla_dat<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span>all.x <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>input_dat<span class="hljs-punctuation">[</span><span class="hljs-built_in">is.na</span><span class="hljs-punctuation">(</span>input_dat<span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-number">0</span><br><br></code></pre></td></tr></table></figure><p>.</p><p>Groups need to be classified according to the conditions of export and transla, and there are 9 cases in total.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># group by case_when</span><br>library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>input_dat <span class="hljs-operator">&lt;-</span> <br>  input_dat <span class="hljs-operator">%&gt;%</span><br>  mutate<span class="hljs-punctuation">(</span><br>    export_group <span class="hljs-operator">=</span> case_when<span class="hljs-punctuation">(</span><br>      input_dat<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> FC_up<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">~</span> <span class="hljs-string">&quot;export_up&quot;</span><span class="hljs-punctuation">,</span><br>      input_dat<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> FC_down<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">~</span> <span class="hljs-string">&quot;export_down&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-literal">TRUE</span> <span class="hljs-operator">~</span> <span class="hljs-string">&quot;export_no&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    transla_group <span class="hljs-operator">=</span> case_when<span class="hljs-punctuation">(</span><br>      input_dat<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> TE_up<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">~</span> <span class="hljs-string">&quot;transla_up&quot;</span><span class="hljs-punctuation">,</span><br>      input_dat<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> TE_down<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">~</span> <span class="hljs-string">&quot;transla_down&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-literal">TRUE</span> <span class="hljs-operator">~</span> <span class="hljs-string">&quot;transla_no&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    group <span class="hljs-operator">=</span> paste<span class="hljs-punctuation">(</span>export_group<span class="hljs-punctuation">,</span> transla_group<span class="hljs-punctuation">,</span> sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot; &amp; &quot;</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span><br>  select<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span>export_group<span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span>transla_group<span class="hljs-punctuation">)</span>  <br><br>table<span class="hljs-punctuation">(</span>input_dat<span class="hljs-operator">$</span>group<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># </span><br>input_dat<span class="hljs-operator">$</span>peak <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>input_dat<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> peak_gene<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Peak&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;non_Peak&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> as.factor<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>table<span class="hljs-punctuation">(</span>input_dat<span class="hljs-operator">$</span>peak<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># ------</span><br><span class="hljs-comment"># pheatmap</span><br>library<span class="hljs-punctuation">(</span>pheatmap<span class="hljs-punctuation">)</span><br>paletteLength <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>rownames<span class="hljs-punctuation">(</span>input_dat<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>myColor <span class="hljs-operator">&lt;-</span> colorRampPalette<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;navy&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;white&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">(</span>paletteLength<span class="hljs-punctuation">)</span><br>myBreaks <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>seq<span class="hljs-punctuation">(</span><span class="hljs-built_in">min</span><span class="hljs-punctuation">(</span>input_dat<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                  <span class="hljs-operator">-</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> <br>                  length.out<span class="hljs-operator">=</span><span class="hljs-built_in">ceiling</span><span class="hljs-punctuation">(</span>paletteLength<span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>              seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <br>                  <span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>input_dat<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                  length.out<span class="hljs-operator">=</span><span class="hljs-built_in">floor</span><span class="hljs-punctuation">(</span>paletteLength<span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br>              <span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>annotation_row <span class="hljs-operator">&lt;-</span> input_dat<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;group&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;peak&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>row.names<span class="hljs-punctuation">(</span>annotation_row<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> input_dat<span class="hljs-operator">$</span>gene_symbol<br>annotation_row<span class="hljs-operator">$</span>group <span class="hljs-operator">&lt;-</span> as.factor<span class="hljs-punctuation">(</span>annotation_row<span class="hljs-operator">$</span>group<span class="hljs-punctuation">)</span><br>annotation_row<span class="hljs-operator">$</span>peak <span class="hljs-operator">&lt;-</span> as.factor<span class="hljs-punctuation">(</span>annotation_row<span class="hljs-operator">$</span>peak<span class="hljs-punctuation">)</span><br>annotation_row  <span class="hljs-operator">&lt;-</span> annotation_row<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br><br>groupcolor <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;#641E16&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#EC7063&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#F5B7B1&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#154360&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#2471A3&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#7FB3D5&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#45B39D&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#F2F3F4&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#97C8AF&#x27;</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>groupcolor<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;export_down &amp; transla_up&#x27;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-string">&#x27;export_down &amp; transla_down&#x27;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-string">&#x27;export_down &amp; transla_no&#x27;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-string">&#x27;export_up &amp; transla_up&#x27;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-string">&#x27;export_up &amp; transla_no&#x27;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-string">&#x27;export_up &amp; transla_down&#x27;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-string">&#x27;export_no &amp; transla_up&#x27;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-string">&#x27;export_no &amp; transla_no&#x27;</span><span class="hljs-punctuation">,</span><br>                       <span class="hljs-string">&#x27;export_no &amp; transla_down&#x27;</span><span class="hljs-punctuation">)</span><br><br>peakcolor <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;#4D5656&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;#CACFD2&#x27;</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>peakcolor<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Peak&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;non_Peak&quot;</span><span class="hljs-punctuation">)</span>                      <br>ann_colors <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>group<span class="hljs-operator">=</span>groupcolor<span class="hljs-punctuation">,</span> <br>                   peak<span class="hljs-operator">=</span> peakcolor<span class="hljs-punctuation">)</span> <br><br>rownames<span class="hljs-punctuation">(</span>input_dat<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> input_dat<span class="hljs-operator">$</span>gene_symbol<br>plot_dat <span class="hljs-operator">&lt;-</span> input_dat<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;log2FC_Sxl.WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log2FoldChange&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;export&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;trabsla&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 1). cluster sorting by raw_clstuer (log2FC_S2)  ref: https://zhuanlan.zhihu.com/p/426355974</span><br>row_dist <span class="hljs-operator">=</span> dist<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-punctuation">)</span><br>hclust_1 <span class="hljs-operator">&lt;-</span> hclust<span class="hljs-punctuation">(</span>row_dist<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># plot(hclust_1, cex = 1, hang = -1)</span><br>dend <span class="hljs-operator">=</span> reorder<span class="hljs-punctuation">(</span>as.dendrogram<span class="hljs-punctuation">(</span>hclust_1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> wts<span class="hljs-operator">=</span>plot_dat<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-operator">*</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>row_cluster <span class="hljs-operator">&lt;-</span> as.hclust<span class="hljs-punctuation">(</span>dend<span class="hljs-punctuation">)</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250221/&quot;</span><span class="hljs-punctuation">)</span><br>pdf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;heatmap_export_transla.pdf&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">)</span><br>pheatmap<span class="hljs-punctuation">(</span>plot_dat<span class="hljs-punctuation">,</span><br>         cluster_row <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>         cluster_col<span class="hljs-operator">=</span><span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span><br>         cutree_rows<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>         cutree_cols <span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>         treeheight_row<span class="hljs-operator">=</span><span class="hljs-number">50</span><span class="hljs-punctuation">,</span><br>         legend_breaks<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>         breaks <span class="hljs-operator">=</span> myBreaks<span class="hljs-punctuation">,</span><br>         show_rownames <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span><br>         angle_col <span class="hljs-operator">=</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span><br>         cellwidth <span class="hljs-operator">=</span> <span class="hljs-number">35</span><span class="hljs-punctuation">,</span><br>         border_color <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>         color <span class="hljs-operator">=</span> myColor<span class="hljs-punctuation">,</span><br>         annotation_row <span class="hljs-operator">=</span> annotation_row<span class="hljs-punctuation">,</span><br>         annotation_colors <span class="hljs-operator">=</span> ann_colors<span class="hljs-punctuation">,</span><br>         cluster_rows <span class="hljs-operator">=</span> row_cluster<span class="hljs-punctuation">)</span><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br><br></code></pre></td></tr></table></figure><p>.</p><p>output_draw</p><p><img src="/2025/02/22/20250222-case-when-instead-of-multiple-if-else/output_draw.png" alt="output_draw"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Proportional-area Venn diagram</title>
    <link href="/2025/02/19/20250219-proportional-area-Venn-diagram/"/>
    <url>/2025/02/19/20250219-proportional-area-Venn-diagram/</url>
    
    <content type="html"><![CDATA[<h3 id="drawing-a-proportional-area-Venn-diagram-in-R"><a href="#drawing-a-proportional-area-Venn-diagram-in-R" class="headerlink" title="drawing a proportional area Venn diagram in R"></a>drawing a proportional area Venn diagram in R</h3><p>.</p><p>Sometimes, when creating a Venn diagram, we need the size of each area to be proportional to the values it represents. In this case, we require a proportional-area Venn diagram.</p><p>.</p><p>the input data need to be a list</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs R">setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/250219_veen/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>peak_3UTR <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;input_data.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;3UTR&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>peak_5UTR <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;input_data.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;5UTR&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>peak_Intron <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;input_data.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Intron&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><br>data_list <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;3UTR&quot;</span> <span class="hljs-operator">=</span> peak_3UTR<span class="hljs-operator">$</span>geneID<span class="hljs-punctuation">,</span><br>                  <span class="hljs-string">&quot;5UTR&quot;</span> <span class="hljs-operator">=</span> peak_5UTR<span class="hljs-operator">$</span>geneID<span class="hljs-punctuation">,</span><br>                  <span class="hljs-string">&quot;Intron&quot;</span> <span class="hljs-operator">=</span> peak_Intron<span class="hljs-operator">$</span>geneID<span class="hljs-punctuation">)</span><br>data_list <span class="hljs-operator">&lt;-</span> lapply<span class="hljs-punctuation">(</span>data_list<span class="hljs-punctuation">,</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> x<span class="hljs-punctuation">[</span>x <span class="hljs-operator">!=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <br><span class="hljs-comment"># Remove empty strings (&quot;&quot;) from each vector in the list</span><br>data_list  <span class="hljs-operator">&lt;-</span> lapply<span class="hljs-punctuation">(</span>data_list <span class="hljs-punctuation">,</span> unique<span class="hljs-punctuation">)</span>  <br><span class="hljs-comment"># Remove duplicate elements from each vector </span><br></code></pre></td></tr></table></figure><p>.</p><p>plot</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>eulerr<span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>euler<span class="hljs-punctuation">(</span><br>  data_list<span class="hljs-punctuation">,</span><br>  shape <span class="hljs-operator">=</span> <span class="hljs-string">&quot;circle&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-comment"># Shape of the pattern: ellipse or circle</span><br>  quantities <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>type <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;percent&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;counts&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>cex<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-comment"># Display type: percentage and numbers, with the ability to adjust the size of the numbers.</span><br>  labels<span class="hljs-operator">=</span><span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>cex<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>                   <br>  <span class="hljs-comment"># Size of the group labels</span><br>  edges <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> lex <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-comment"># Edge color and size of the shapes</span><br>  fills <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;#f18c8d&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#8ec7ff&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#bfff7f&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.7</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-comment"># Fill color and transparency (opacity)</span><br>  legend <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>side <span class="hljs-operator">=</span> <span class="hljs-string">&quot;right&quot;</span><span class="hljs-punctuation">)</span>       <br>  <span class="hljs-comment"># Position of the legend</span><br><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>.</p><p><img src="/2025/02/19/20250219-proportional-area-Venn-diagram/Veen%20plot.png" alt="Veen plot"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Fold enrichment of diff TE genes in chromosome</title>
    <link href="/2025/02/11/20250211-Fold-enrichment-of-diff-transla-efficiency-genes-in-chromosome/"/>
    <url>/2025/02/11/20250211-Fold-enrichment-of-diff-transla-efficiency-genes-in-chromosome/</url>
    
    <content type="html"><![CDATA[<h3 id="Fold-enrichment-of-diff-TE-genes-in-Chr"><a href="#Fold-enrichment-of-diff-TE-genes-in-Chr" class="headerlink" title="Fold enrichment of diff TE genes in Chr"></a>Fold enrichment of diff TE genes in Chr</h3><p>.</p><p>I need to ceate a plot which showing the enrichment fold of TE genes compared to genome annoted genes on each chomosome of drosophila.</p><p>.</p><p>the calculation method for the fold enrichment is as follows:</p><p><img src="/2025/02/11/20250211-Fold-enrichment-of-diff-transla-efficiency-genes-in-chromosome/fold%20enrichment.png" alt="fold enrichment"></p><p>.</p><p>the input data</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250126&quot;</span><span class="hljs-punctuation">)</span><br>chr_dT <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chr_distrib_250126_.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;absolute_transla&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>chr_dT<span class="hljs-operator">$</span>group <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;dT&quot;</span><br><br><span class="hljs-comment">#</span><br>chr_dT_up <span class="hljs-operator">&lt;-</span> chr_dT<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_up&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;enirch_up&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;group&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>chr_dT_down <span class="hljs-operator">&lt;-</span> chr_dT<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_down&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;enrich_down&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;group&quot;</span> <span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br><br>chr_dT_up<span class="hljs-operator">$</span>type <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;up&quot;</span><br>chr_dT_down<span class="hljs-operator">$</span>type <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;down&quot;</span><br><br>colnames<span class="hljs-punctuation">(</span>chr_dT_up<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene.num&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;enrich_fold&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;group&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>chr_dT_down<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene.num&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;enrich_fold&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;group&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">)</span><br><br><br>plot_dT <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>chr_dT_up<span class="hljs-punctuation">,</span><br>                 chr_dT_down<span class="hljs-punctuation">)</span><br>plot_dT<span class="hljs-operator">$</span>chr<span class="hljs-punctuation">[</span>plot_dT<span class="hljs-operator">$</span>chr <span class="hljs-operator">==</span> <span class="hljs-string">&quot;X&quot;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;a.X&quot;</span><br>plot_dT<span class="hljs-operator">$</span>chr<span class="hljs-punctuation">[</span>plot_dT<span class="hljs-operator">$</span>chr <span class="hljs-operator">==</span> <span class="hljs-string">&quot;2L&quot;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;b.2L&quot;</span><br>plot_dT<span class="hljs-operator">$</span>chr<span class="hljs-punctuation">[</span>plot_dT<span class="hljs-operator">$</span>chr <span class="hljs-operator">==</span> <span class="hljs-string">&quot;2R&quot;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;c.2R&quot;</span><br>plot_dT<span class="hljs-operator">$</span>chr<span class="hljs-punctuation">[</span>plot_dT<span class="hljs-operator">$</span>chr <span class="hljs-operator">==</span> <span class="hljs-string">&quot;3L&quot;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;d.3L&quot;</span><br>plot_dT<span class="hljs-operator">$</span>chr<span class="hljs-punctuation">[</span>plot_dT<span class="hljs-operator">$</span>chr <span class="hljs-operator">==</span> <span class="hljs-string">&quot;3R&quot;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;e.3R&quot;</span><br><br>plot_dT<span class="hljs-operator">$</span>chr <span class="hljs-operator">&lt;-</span> factor<span class="hljs-punctuation">(</span>plot_dT<span class="hljs-operator">$</span>chr<span class="hljs-punctuation">,</span> levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;e.3R&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;d.3L&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;c.2R&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;b.2L&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;a.X&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>plot_dT<span class="hljs-operator">$</span>type <span class="hljs-operator">&lt;-</span> factor<span class="hljs-punctuation">(</span>plot_dT<span class="hljs-operator">$</span>type<span class="hljs-punctuation">,</span> levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;up&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;down&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>View<span class="hljs-punctuation">(</span>plot_dT<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="/2025/02/11/20250211-Fold-enrichment-of-diff-transla-efficiency-genes-in-chromosome/input%20data.png" alt="input data"></p><p>.</p><p>plot</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------</span><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/250210/&quot;</span><span class="hljs-punctuation">)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;50210_dT.tiff&quot;</span><span class="hljs-punctuation">,</span> units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span> width <span class="hljs-operator">=</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> height <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span> res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;t_dT.tiff&quot;</span><span class="hljs-punctuation">,</span> units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span> width <span class="hljs-operator">=</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> height <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span> res <span class="hljs-operator">=</span> <span class="hljs-number">900</span><span class="hljs-punctuation">)</span><br>ggplot<span class="hljs-punctuation">(</span>plot_dT<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> chr<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> enrich_fold<span class="hljs-punctuation">,</span> fill <span class="hljs-operator">=</span> type<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> gene.num<span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> type<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.6</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  scale_fill_manual<span class="hljs-punctuation">(</span>values <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;#EC7063&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#45B39D&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  scale_color_manual<span class="hljs-punctuation">(</span>values <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;#EC7063&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;#45B39D&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  <br>  coord_flip<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>angle <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> colour <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> family <span class="hljs-operator">=</span> <span class="hljs-string">&quot;blod&quot;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">14</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>family <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Times&quot;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span> face <span class="hljs-operator">=</span> <span class="hljs-string">&quot;plain&quot;</span><span class="hljs-punctuation">,</span> colour <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>family <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Times&quot;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">14</span><span class="hljs-punctuation">,</span> face <span class="hljs-operator">=</span> <span class="hljs-string">&quot;plain&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>family <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Times&quot;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">14</span><span class="hljs-punctuation">,</span> face <span class="hljs-operator">=</span> <span class="hljs-string">&quot;plain&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.border <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        axis.line <span class="hljs-operator">=</span> element_line<span class="hljs-punctuation">(</span>colour <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>        panel.grid.major <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        panel.grid.minor <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>legend.text <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">12</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  theme<span class="hljs-punctuation">(</span>legend.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">12</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  guides<span class="hljs-punctuation">(</span>colour <span class="hljs-operator">=</span> guide_legend<span class="hljs-punctuation">(</span>override.aes <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_size_continuous<span class="hljs-punctuation">(</span><span class="hljs-built_in">range</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  xlab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot; &quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> ylab<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Fold enrichment&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.border <span class="hljs-operator">=</span> element_rect<span class="hljs-punctuation">(</span>fill <span class="hljs-operator">=</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> linetype <span class="hljs-operator">=</span> <span class="hljs-string">&quot;solid&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.line.x <span class="hljs-operator">=</span> element_line<span class="hljs-punctuation">(</span>linetype <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>axis.line.y <span class="hljs-operator">=</span> element_line<span class="hljs-punctuation">(</span>linetype <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2.5</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>aes<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> linetype <span class="hljs-operator">=</span> <span class="hljs-string">&quot;dashed&quot;</span><span class="hljs-punctuation">)</span><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p><img src="/2025/02/11/20250211-Fold-enrichment-of-diff-transla-efficiency-genes-in-chromosome/output_plot.png" alt="output_plot"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/02/08/20250208-%E8%AF%BB%E3%80%8A%E7%97%85%E9%9A%99%E7%A2%8E%E7%AC%94%E3%80%8B%E5%8F%B2%E9%93%81%E7%94%9F/"/>
    <url>/2025/02/08/20250208-%E8%AF%BB%E3%80%8A%E7%97%85%E9%9A%99%E7%A2%8E%E7%AC%94%E3%80%8B%E5%8F%B2%E9%93%81%E7%94%9F/</url>
    
    <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>.</p><p></p><p></p><p><img src="/2025/02/08/20250208-%E8%AF%BB%E3%80%8A%E7%97%85%E9%9A%99%E7%A2%8E%E7%AC%94%E3%80%8B%E5%8F%B2%E9%93%81%E7%94%9F/%E5%8F%B2%E9%93%81%E7%94%9F%E3%80%8A%E7%97%85%E9%9A%99%E7%A2%8E%E7%AC%94%E8%AE%B0%E3%80%8B.png" alt=""></p><p></p><p></p><p><em></em></p><p></p><p></p><p></p><p></p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2024</title>
    <link href="/2025/02/04/20250204-2024%E5%B9%B4%E6%80%BB%E7%BB%93/"/>
    <url>/2025/02/04/20250204-2024%E5%B9%B4%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h3 id="2024"><a href="#2024" class="headerlink" title="2024"></a>2024</h3><p>.</p><p>2024</p><p>SXL2023</p><p>81400</p><p></p><p>512</p><p></p><p>.</p><p>2025</p><p></p><p>125</p><p></p><p></p><p></p><hr><p>.</p><p></p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Adjusting extremely small p-values in a volcano plot</title>
    <link href="/2025/02/02/20250202-Adjusting-extremely-small-p-values-in-a-volcano-plot/"/>
    <url>/2025/02/02/20250202-Adjusting-extremely-small-p-values-in-a-volcano-plot/</url>
    
    <content type="html"><![CDATA[<h3 id="Adjusting-extremely-small-p-values-in-a-volcano-plot"><a href="#Adjusting-extremely-small-p-values-in-a-volcano-plot" class="headerlink" title="Adjusting extremely small p-values in a volcano plot"></a>Adjusting extremely small p-values in a volcano plot</h3><p>.</p><p>When creating a volcano plot for differential gene expression, a few points (genes) with extremely small or even zero p-values can cause the Y-axis range to become very large. To zoom in Y-axis, its often necessary to either remove these extremely small p-values or replace them with more reasonable values.</p><p>.</p><p>This is the plot with the raw data.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240516&quot;</span><span class="hljs-punctuation">)</span><br><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>T_up <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_up&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>T_down <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_down&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br>T_S2<span class="hljs-operator">$</span>group <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> T_up<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;up&#x27;</span><span class="hljs-punctuation">,</span><br>                     ifelse<span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> T_down<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;down&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;non&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>ggplot<span class="hljs-punctuation">(</span>data <span class="hljs-operator">=</span> T_S2<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span>log2FoldChange <span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_point<span class="hljs-punctuation">(</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span> size<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> group<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>xlim<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">300</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_color_manual<span class="hljs-punctuation">(</span>values<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;darkred&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gray&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;darkblue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_vline<span class="hljs-punctuation">(</span>xintercept<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  labs<span class="hljs-punctuation">(</span>title<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;log2 Fold Change&#x27;</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;-log10(pvalue)&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>   <br>  theme<span class="hljs-punctuation">(</span>plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  theme<span class="hljs-punctuation">(</span>legend.text<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>        legend.title<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br><br></code></pre></td></tr></table></figure><p><img src="/2025/02/02/20250202-Adjusting-extremely-small-p-values-in-a-volcano-plot/raw.png" alt="raw"></p><p>.</p><p>Set the Y-axis range to 150. For points with -log10(p-value) greater than 150, assign values within the range of 145  5.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>p_value10 <span class="hljs-operator">&lt;-</span> subset<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span><span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>pvalue<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">150</span><span class="hljs-punctuation">)</span><br>pval_jitter <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">round</span><span class="hljs-punctuation">(</span>rnorm<span class="hljs-punctuation">(</span>nrow<span class="hljs-punctuation">(</span>p_value10<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>mean <span class="hljs-operator">=</span> <span class="hljs-number">145</span><span class="hljs-punctuation">,</span>sd<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>pval_jitter <span class="hljs-operator">&lt;-</span> 1<span class="hljs-operator">*</span><span class="hljs-number">10</span><span class="hljs-operator">^</span><span class="hljs-operator">-</span>pval_jitter<br>p_value10<span class="hljs-operator">$</span>pvalue <span class="hljs-operator">&lt;-</span> pval_jitter<br><br>p_value_raw <span class="hljs-operator">&lt;-</span> subset<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span><span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>pvalue<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;=</span> <span class="hljs-number">150</span><span class="hljs-punctuation">)</span><br><br>df <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>p_value_raw<span class="hljs-punctuation">,</span>p_value10<span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>.</p><p>This is the modified version of the plot</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>ggplot<span class="hljs-punctuation">(</span>data <span class="hljs-operator">=</span> df<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span>log2FoldChange <span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_point<span class="hljs-punctuation">(</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span> size<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> group<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>xlim<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">160</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_color_manual<span class="hljs-punctuation">(</span>values<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;darkred&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gray&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;darkblue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_vline<span class="hljs-punctuation">(</span>xintercept<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  labs<span class="hljs-punctuation">(</span>title<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;log2 Fold Change&#x27;</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;-log10(pvalue)&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>   <br>  theme<span class="hljs-punctuation">(</span>plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  theme<span class="hljs-punctuation">(</span>legend.text<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>        legend.title<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br><br></code></pre></td></tr></table></figure><p><img src="/2025/02/02/20250202-Adjusting-extremely-small-p-values-in-a-volcano-plot/modified.png" alt="modified"></p><hr><p>en, It looks much better.</p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-02-01 </title>
    <link href="/2025/02/01/20250201-%E5%AF%92%E5%81%87/"/>
    <url>/2025/02/01/20250201-%E5%AF%92%E5%81%87/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-02-01-"><a href="#2025-02-01-" class="headerlink" title="2025-02-01 "></a>2025-02-01 </h3><p>.</p><p>12721</p><p>.</p><p>128</p><p></p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E9%99%A4%E5%A4%95%E5%9C%A8%E5%AE%B6%20%E9%83%BD%E6%98%AF%E6%B9%96%E5%8D%97%E8%8F%9C.jpg" alt=" "></p><p>.</p><p>29</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E6%9C%97%E5%9B%AD%E9%87%8C%E7%9A%84%E4%B8%AD%E5%A4%AE%E7%81%AB%E8%BD%A6%E7%AB%99.jpg" alt=""></p><p>.</p><p>30</p><p></p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E9%95%BF%E5%9F%8E.jpg" alt=""></p><p></p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E5%85%AB%E8%BE%BE%E5%B2%AD%E9%95%BF%E5%9F%8E%E8%84%9A%E4%B8%8B%E6%88%9A%E7%BB%A7%E5%85%89%E5%83%8F.jpg" alt=""></p><p>.</p><p>31</p><p></p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E5%9C%86%E6%98%8E%E5%9B%AD%20%E6%B9%96%E9%9D%A2%E7%BB%93%E5%86%B0%E7%9A%84%E7%A6%8F%E6%B5%B7.jpg" alt=" "></p><p>100</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E5%9C%86%E6%98%8E%E5%9B%AD%20%E8%A2%AB%E6%8D%A3%E6%AF%81%E7%9A%84%E5%BA%9F%E5%A2%9F.jpg" alt=" "></p><p>.</p><p>21</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E6%97%A9%E6%99%A8%E7%9A%84%E6%B1%89%E5%8F%A3%E7%81%AB%E8%BD%A6%E7%AB%99.jpg" alt=""></p><p>.</p><p></p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E5%AE%BF%E8%88%8D.jpg" alt=""></p><hr><p></p><p>Good Luck</p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-01-27 </title>
    <link href="/2025/01/28/20250127-%E4%BC%91%E5%81%87/"/>
    <url>/2025/01/28/20250127-%E4%BC%91%E5%81%87/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-01-27-"><a href="#2025-01-27-" class="headerlink" title="2025-01-27 "></a>2025-01-27 </h3><p>.</p><p>27</p><p>38</p><p>.</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E6%A2%A8%E5%9B%AD.jpg" alt=""></p><p>.</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E9%9D%A0%E8%BF%91%E6%AD%A6%E6%B1%89%E7%81%AB%E8%BD%A6%E7%AB%99.jpg" alt=""></p><p>.</p><p>1</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E8%90%BD%E9%9B%81%E6%99%AF%E5%8C%BA.jpg" alt=""></p><p>.</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E4%B8%9C%E6%B9%96%E8%90%BD%E9%9B%81%E5%B2%9B.jpg" alt=""></p><p>.</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E4%B8%9C%E6%B9%96%E5%88%98%E5%A4%87%E7%A5%AD%E5%A4%A9%E5%8F%B0.jpg" alt=""></p><p>.</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E4%B8%9C%E6%B9%96%E6%A2%85%E5%9B%AD.jpg" alt=""></p><p>.</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E5%AF%B9%E9%9D%A2%E6%98%AF%E6%A2%A8%E5%9B%AD.jpg" alt=""></p><p>.</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E5%B7%A5%E5%AD%A6%E9%83%A8%E5%AE%BF%E8%88%8D%E5%A4%A9%E5%8F%B0.jpg" alt=""></p><p>.</p><p>11</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E6%B1%89%E5%8F%A3%E7%81%AB%E8%BD%A6%E7%AB%99.jpg" alt=""></p><p>.</p><p></p><p></p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E8%BF%87%E4%BF%9D%E5%AE%9A%E4%B8%8D%E8%BF%9C.jpg" alt=""></p><p>.</p><p></p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E4%BF%9D%E5%AE%9A%E9%9B%AA%E6%99%AF.jpg" alt=""></p><p>.</p><p></p><hr><p>.</p><p>2025</p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Homologous gene conversion across different species</title>
    <link href="/2025/01/24/20250124-Homologous-gene-conversion-across-different-species/"/>
    <url>/2025/01/24/20250124-Homologous-gene-conversion-across-different-species/</url>
    
    <content type="html"><![CDATA[<h3 id="Homologous-gene-conversion-across-different-species"><a href="#Homologous-gene-conversion-across-different-species" class="headerlink" title="Homologous gene conversion across different species"></a>Homologous gene conversion across different species</h3><p>.</p><p> Here, we use three mouse genes as an example. The method is the same for more genes.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>library<span class="hljs-punctuation">(</span>homologene<span class="hljs-punctuation">)</span><br>genelist<span class="hljs-operator">&lt;-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Acadm&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Eno2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Acadvl&quot;</span><span class="hljs-punctuation">)</span><br>homologene<span class="hljs-punctuation">(</span>genelist<span class="hljs-punctuation">,</span> inTax <span class="hljs-operator">=</span> <span class="hljs-number">10090</span><span class="hljs-punctuation">,</span> outTax <span class="hljs-operator">=</span> <span class="hljs-number">9606</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># Use homologene function for gene conversion</span><br><span class="hljs-comment"># genelist: the gene list to be converted</span><br><span class="hljs-comment"># inTax: the taxonomic ID of the species for the input gene list, 10090 for mouse</span><br><span class="hljs-comment"># outTax: the taxonomic ID of the species to convert to, 9606 for human</span><br></code></pre></td></tr></table></figure><p>.</p><p>result:</p><p><img src="/2025/01/24/20250124-Homologous-gene-conversion-across-different-species/convert%20mouse%20to%20human.png" alt="convert mouse to human"></p><p>.</p><p>The species IDs supported by Homologene </p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">homologene<span class="hljs-operator">::</span>taxData<br></code></pre></td></tr></table></figure><p>.</p><p>For commonly used organisms like mice and humans, there are even dedicated functions available</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R">mouse2human<span class="hljs-punctuation">(</span>genelist<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># and human to mouse</span><br>human2mouse<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ACADM&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ENO2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ACADVL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>human2mouse<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;H1.2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;TP53&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># and dme to homo</span><br>genelist<span class="hljs-operator">&lt;-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Sxl&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;msl-2&quot;</span><span class="hljs-punctuation">)</span><br>homologene<span class="hljs-operator">::</span>taxData<br>homologene<span class="hljs-punctuation">(</span>genelist<span class="hljs-punctuation">,</span> inTax <span class="hljs-operator">=</span> <span class="hljs-number">7227</span><span class="hljs-punctuation">,</span> outTax <span class="hljs-operator">=</span> <span class="hljs-number">9606</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><hr><p>ref : <a href="https://cloud.tencent.com/developer/article/2115727">https://cloud.tencent.com/developer/article/2115727</a></p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-01-20 </title>
    <link href="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/"/>
    <url>/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-01-20-"><a href="#2025-01-20-" class="headerlink" title="2025-01-20 "></a>2025-01-20 </h3><p>.</p><p>.</p><p>30</p><p></p><hr><p></p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/1.%E9%9D%A0%E8%BF%91%E6%AD%A6%E6%B1%89%E7%81%AB%E8%BD%A6%E7%AB%99%E9%99%84%E8%BF%91%E7%9A%84%E7%BB%BF%E9%81%93.jpg" alt="1."></p><p>.</p><p></p><p></p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/2.%E9%9D%A0%E8%BF%91%E6%AD%A6%E6%B1%89%E7%AB%99%E7%9A%84%E7%BB%BF%E9%81%93.jpg" alt="2."></p><p>.</p><p>10</p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/3.%E8%8D%86%E6%A5%9A%E9%9B%84%E9%A3%8E%E9%99%84%E8%BF%91.jpg" alt="3."></p><p>.</p><p></p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/4.%E4%B8%9C%E6%B9%96%E4%B9%8B%E7%9C%BC%E9%99%84%E4%BB%B6.jpg" alt="4."></p><p>.</p><p></p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/5.%E4%B8%9C%E6%B9%96%E4%B9%8B%E7%9C%BC%E8%87%B3%E6%A2%85%E5%9B%AD%E7%A0%81%E5%A4%B4%E9%99%84%E4%BB%B6.jpg" alt="5."></p><p></p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Plotting the transcript structure of a gene</title>
    <link href="/2025/01/12/20250112-Plotting-the-transcript-structure-of-a-gene/"/>
    <url>/2025/01/12/20250112-Plotting-the-transcript-structure-of-a-gene/</url>
    
    <content type="html"><![CDATA[<h3 id="Plotting-the-transcript-structure-of-a-gene"><a href="#Plotting-the-transcript-structure-of-a-gene" class="headerlink" title="Plotting the transcript structure of a gene"></a>Plotting the transcript structure of a gene</h3><p>.</p><p>Sometimes, we need to display the different transcript structures of a gene.  And this R script is designed for quickly accomplishing this task.</p><p>First, we need an annotation file that contains information about the gene transcripts.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>rtracklayer<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>transPlotR<span class="hljs-punctuation">)</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220910_annotation/Drosaphila/&quot;</span><span class="hljs-punctuation">)</span><br>gene.anno <span class="hljs-operator">&lt;-</span> import<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Drosophila_melanogaster.BDGP6.32.105.gtf&quot;</span> <span class="hljs-punctuation">,</span>format <span class="hljs-operator">=</span> <span class="hljs-string">&quot;gtf&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>gene.anno<span class="hljs-punctuation">)</span><br><br><br>trancriptVis<span class="hljs-punctuation">(</span>gtfFile <span class="hljs-operator">=</span> gene.anno<span class="hljs-punctuation">,</span><br>             gene <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Rala&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ssx&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># Target gene to plot</span><br>             facetByGene <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>             addNormalArrow <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span><br>             newStyleArrow <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>             base_size <span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># Theme basesize, default(14).</span><br>             textLabel<span class="hljs-operator">=</span><span class="hljs-string">&quot;transcript_name&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># The text label aesthetic mappings, default(&#x27;transcript_id&#x27;)</span><br>             textLabelSize<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># The text label size</span><br>             textLabelColor <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># The text label color</span><br>             intronSize<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># Intron line size</span><br>             exonWidth<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span>     <span class="hljs-comment"># exon width </span><br>             relTextDist<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># marked_name relative to exon</span><br>             reverse.y<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><br>             xAxis.info<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># Whether retain X axis ticks and text</span><br><br><br><br></code></pre></td></tr></table></figure><p>output</p><p><img src="/2025/01/12/20250112-Plotting-the-transcript-structure-of-a-gene/all%20transcripts%20for%20genes.png" alt="all transcripts for genes"></p><p>.</p><p>.</p><p>If we only want to display the specific transcripts of a gene that we are interested in, we can use this script as follows:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># select and plot only the target transcript by myTranscript (&quot;transcript&quot;_id)</span><br>trancriptVis<span class="hljs-punctuation">(</span>gtfFile <span class="hljs-operator">=</span> gene.anno<span class="hljs-punctuation">,</span><br>             gene <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;ssx&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>             myTranscript <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;FBtr0070215&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;FBtr0339773&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             addNormalArrow <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span><br>             newStyleArrow <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>             base_size <span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span> <br>             textLabel<span class="hljs-operator">=</span><span class="hljs-string">&quot;transcript_name&quot;</span><span class="hljs-punctuation">,</span> <br>             textLabelSize<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <br>             textLabelColor <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> <br>             intronSize<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <br>             exonWidth<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span>     <br>             relTextDist<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span> <br>             reverse.y<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><br>             xAxis.info<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span> <br></code></pre></td></tr></table></figure><p>output</p><p><img src="/2025/01/12/20250112-Plotting-the-transcript-structure-of-a-gene/only%20target%20transcripts.png" alt="only target transcripts"></p><hr><p>There are better ways to solve this problem.</p><p> link:</p><p><a href="https://www.jingege.wang/2022/06/04/ggtranscript/">https://www.jingege.wang/2022/06/04/ggtranscript/</a></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Calculate the GC content in a DNA/RNA sequence</title>
    <link href="/2025/01/10/20250110-to-calculate-the-GC-content-in-a-DNARNA-sequence/"/>
    <url>/2025/01/10/20250110-to-calculate-the-GC-content-in-a-DNARNA-sequence/</url>
    
    <content type="html"><![CDATA[<h3 id="Calculate-the-GC-content-in-a-DNA-RNA-sequence"><a href="#Calculate-the-GC-content-in-a-DNA-RNA-sequence" class="headerlink" title="Calculate the GC content in a DNA&#x2F;RNA sequence"></a>Calculate the GC content in a DNA&#x2F;RNA sequence</h3><p>.</p><p>This is a simple initial Python script to calculate the GC content of DNA&#x2F;RNA sequences, specifically for cases where each FASTA file contains only one sequence.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> os,sys,re<br>ms, infile, outfile = sys.argv<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(infile) <span class="hljs-keyword">as</span> f:<br>    f=f.read()  <br>    f=re.sub(<span class="hljs-string">&#x27;&gt;.*\n|\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, f)  <br>    <span class="hljs-string">&quot;&quot;&quot;Remove the header line and newline characters&quot;&quot;&quot;</span><br>    <br>    size=<span class="hljs-built_in">len</span>(f)<br>    nG=f.count(<span class="hljs-string">&quot;g&quot;</span>)+f.count(<span class="hljs-string">&quot;G&quot;</span>)<br>    nC=f.count(<span class="hljs-string">&quot;c&quot;</span>)+f.count(<span class="hljs-string">&quot;C&quot;</span>)<br>    percent_GC=(nG+nC)/size<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(outfile, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> out:<br>    out.write(<span class="hljs-string">&quot;ID\tsize\tpercent_gc\n&quot;</span>)<br>    ID=re.sub(<span class="hljs-string">&#x27;.fasta&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, infile)<br>    out.write(<span class="hljs-string">&quot;&#123;&#125;\t&#123;&#125;\t&#123;&#125;\n&quot;</span>.<span class="hljs-built_in">format</span>(ID, size, percent_GC))<br>    <span class="hljs-string">&quot;&quot;&quot;Add a newline character (\n) at the end of each line in output_file&quot;&quot;&quot;</span><br>   <br><br><span class="hljs-comment">#use : python3 GC_content.py input.fa out.file </span><br><br></code></pre></td></tr></table></figure><p>.</p><p>After encapsulating the script into an executable file named <strong>GC_content.py</strong> ,  then use it on Linux as follows:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls *fa |while read id ;do(python GC_content.py $id $&#123;id&#125;.out.txt);done &amp;&amp; cat *out.txt &gt; output.txt<br></code></pre></td></tr></table></figure><p>.</p><p>output</p><p>The last column is the calculated GC content ratio for the corresponding sequence.</p><p><img src="/2025/01/10/20250110-to-calculate-the-GC-content-in-a-DNARNA-sequence/outfile%20of%20GC_content.png" alt="outfile of GC_content"></p><p>.</p><p>.</p><p>If a the fasta file contains multiple sequences, we can use this python script following:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> Bio <span class="hljs-keyword">import</span> SeqIO<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_gc_content</span>(<span class="hljs-params">sequence</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;define a function to calculate the GC percentage for sequence&quot;&quot;&quot;</span><br>    sequence = sequence.upper()<br>    gc_count = sequence.count(<span class="hljs-string">&#x27;G&#x27;</span>) + sequence.count(<span class="hljs-string">&#x27;C&#x27;</span>)<br>    total_count = <span class="hljs-built_in">len</span>(sequence)<br>    <span class="hljs-keyword">if</span> total_count == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> (gc_count / total_count) * <span class="hljs-number">100</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_fasta_file</span>(<span class="hljs-params">input_file, output_file</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;process a fasta file and calculate the GC content of each sequence&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> output:<br>        <span class="hljs-comment"># FASTA</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-string">&quot;&quot;&quot;file is input_file&quot;&quot;&quot;</span><br>            <span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> SeqIO.parse(file, <span class="hljs-string">&quot;fasta&quot;</span>):<br>                seq_id = record.<span class="hljs-built_in">id</span><br>                <span class="hljs-string">&quot;&quot;&quot;Obtain the ID of the current sequence,usually the part following the &gt; in the FASTA file header&quot;&quot;&quot;</span><br>                sequence = <span class="hljs-built_in">str</span>(record.seq)<br>                <span class="hljs-string">&quot;&quot;&quot;Convert the sequence object (record.seq) into a string format&quot;&quot;&quot;</span><br>                gc_content = calculate_gc_content(sequence)<br>                output.write(<span class="hljs-string">f&quot;&gt;<span class="hljs-subst">&#123;seq_id&#125;</span> GC_content: <span class="hljs-subst">&#123;gc_content:<span class="hljs-number">.2</span>f&#125;</span>%\n&quot;</span>)<br>                <span class="hljs-string">&quot;&quot;&quot;the format for output.write is: &gt;sequence ID GC_content: GC content%, where .2f indicates that the GC_content will be rounded to two decimal places&quot;&quot;&quot;</span><br><br>                <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># ()</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Usage: python3 calculate_gc_content.py input_file output_file&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    input_file = sys.argv[<span class="hljs-number">1</span>]<br>    output_file = sys.argv[<span class="hljs-number">2</span>]<br><br>    <span class="hljs-string">&quot;&quot;&quot;Execute the file processing&quot;&quot;&quot;</span><br>    process_fasta_file(input_file, output_file)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;GC content calculation completed. Results saved to <span class="hljs-subst">&#123;output_file&#125;</span>.&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>.</p><p>After encapsulating the script into an executable file named <strong>calculate_gc_content.py</strong>, then use it on Linux as follows:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python3 calculate_gc_content.py input_file output_file<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Add full name and description for target genes</title>
    <link href="/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/"/>
    <url>/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/</url>
    
    <content type="html"><![CDATA[<h3 id="Add-full-name-and-description-for-target-genes"><a href="#Add-full-name-and-description-for-target-genes" class="headerlink" title="Add full name and description for target genes"></a>Add full name and description for target genes</h3><p>.</p><p>Some genes functions may not be easily inferred from their abbreviated names, therefore, to be better understand the genes, we need to include their full names and other forms of ID numbers for the target genes.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------</span><br><span class="hljs-comment"># function and detail description of target genes by gtf</span><br><br><span class="hljs-comment"># anno.</span><br>library<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">)</span><br>eg2Symbol<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egSYMBOL<span class="hljs-punctuation">)</span><br>eg2name<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egGENENAME<span class="hljs-punctuation">)</span><br>eg2ENSEMBL<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egENSEMBL<span class="hljs-punctuation">)</span><br>anno<span class="hljs-operator">=</span>merge<span class="hljs-punctuation">(</span>eg2ENSEMBL<span class="hljs-punctuation">,</span>merge<span class="hljs-punctuation">(</span>eg2Symbol<span class="hljs-punctuation">,</span>eg2name<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;gene_id&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;gene_id&#x27;</span><span class="hljs-punctuation">)</span>  <br>colnames<span class="hljs-punctuation">(</span>anno<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ENTREID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Gene_name&quot;</span><span class="hljs-punctuation">)</span><br>anno <span class="hljs-operator">&lt;-</span> anno<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>anno<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># target genes</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/RiboSeq/featureCount_CDS_multi/&quot;</span><span class="hljs-punctuation">)</span><br>target_genes <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;riborex_translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;tranlation_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># add detail description to target genes</span><br>new_target_genes <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>target_genes<span class="hljs-punctuation">,</span>anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>intersect<span class="hljs-punctuation">(</span>anno<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span>target_genes<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># save</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240222_question.daily/17.detail.description_diff_translation.genes/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>openxlsx<span class="hljs-punctuation">)</span><br>wb <span class="hljs-operator">&lt;-</span> createWorkbook<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>addWorksheet<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;new_target_genes&quot;</span><span class="hljs-punctuation">)</span><br>writeData<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;new_target_genes&quot;</span><span class="hljs-punctuation">,</span> new_target_genes<span class="hljs-punctuation">,</span>startCol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> startRow <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> rowNames <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>saveWorkbook<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> file<span class="hljs-operator">=</span><span class="hljs-string">&#x27;target_genes_with_detial_description.xlsx&#x27;</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>output file :</p><p>the full names are indicated by the red box.</p><p><img src="/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/target%20genes%20with%20their%20full%20names%20already%20added.png" alt="target genes with their full names already added"></p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Highlighting the target gene in scatterplot</title>
    <link href="/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/"/>
    <url>/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/</url>
    
    <content type="html"><![CDATA[<h3 id="Highlighting-the-target-gene-in-scatterplot"><a href="#Highlighting-the-target-gene-in-scatterplot" class="headerlink" title="Highlighting the target gene in scatterplot"></a>Highlighting the target gene in scatterplot</h3><p>.</p><p>the scatter points with different colors and sizes  were used to distinguish the target gene from other genes, and labeled the target gene with  gene symbol.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs R"><br><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>latex2exp<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>mdthemes<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggrepel<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240506&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>diff_gene_all <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;DEGs_240506.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;new.diff_gene_all_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br>new.res<span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>diff_gene_all<span class="hljs-punctuation">)</span> <br>new.res<span class="hljs-operator">$</span>group <span class="hljs-operator">=</span> as.factor<span class="hljs-punctuation">(</span>ifelse<span class="hljs-punctuation">(</span> <span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>new.res<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> new.res<span class="hljs-operator">$</span>padj<span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><br>                                  ifelse<span class="hljs-punctuation">(</span>new.res<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Up&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Down&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                  <span class="hljs-string">&quot;NS&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>target_gene_1 <span class="hljs-operator">&lt;-</span> new.res<span class="hljs-punctuation">[</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Ugt37A3&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;CG43845&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span>   <br>target_gene_2 <span class="hljs-operator">&lt;-</span> new.res<span class="hljs-punctuation">[</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Sox21a&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;CG14669&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>new.res_F <span class="hljs-operator">&lt;-</span> filter<span class="hljs-punctuation">(</span>new.res<span class="hljs-punctuation">,</span><span class="hljs-operator">!</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> target_gene_1<span class="hljs-operator">$</span>gene_symbol <span class="hljs-punctuation">)</span><br>new.res_F <span class="hljs-operator">&lt;-</span> filter<span class="hljs-punctuation">(</span>new.res_F<span class="hljs-punctuation">,</span><span class="hljs-operator">!</span>new.res_F<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> target_gene_2<span class="hljs-operator">$</span>gene_symbol <span class="hljs-punctuation">)</span><br><br>My_Theme <span class="hljs-operator">=</span> theme<span class="hljs-punctuation">(</span><br>  panel.background <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">16</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  text <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>  axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>  axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>  axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>  axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  legend.text<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  legend.title<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br>ggplot<span class="hljs-punctuation">(</span>data <span class="hljs-operator">=</span> new.res_F<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_point<span class="hljs-punctuation">(</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span> size<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> group<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_color_manual<span class="hljs-punctuation">(</span>values<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gray&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;blue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span> <br>  geom_vline<span class="hljs-punctuation">(</span>xintercept<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  labs<span class="hljs-punctuation">(</span>title<span class="hljs-operator">=</span><span class="hljs-string">&quot;differential expr. genes&quot;</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;log2 Fold Change&#x27;</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;-log10 p-value&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  xlim<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  <br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">300</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  My_Theme <span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_1<span class="hljs-punctuation">,</span> <br>             aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             size<span class="hljs-operator">=</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span> col<span class="hljs-operator">=</span><span class="hljs-string">&quot;darkred&quot;</span><span class="hljs-punctuation">,</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_2<span class="hljs-punctuation">,</span> <br>             aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             size<span class="hljs-operator">=</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span> col<span class="hljs-operator">=</span><span class="hljs-string">&quot;darkblue&quot;</span><span class="hljs-punctuation">,</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_text_repel<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_1<span class="hljs-punctuation">,</span><br>                  aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>label<span class="hljs-operator">=</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                  color<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_text_repel<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_2<span class="hljs-punctuation">,</span><br>                  aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>label<span class="hljs-operator">=</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                  color<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>output files :</p><p><img src="/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/differential%20expression%20genes.png" alt="differential expression genes"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Differential translation gene by RiboSeq</title>
    <link href="/2025/01/02/differential-translation-gene-by-RiboSeq/"/>
    <url>/2025/01/02/differential-translation-gene-by-RiboSeq/</url>
    
    <content type="html"><![CDATA[<h3 id="Ribo-Seq-analysis-for-mRNA-translation"><a href="#Ribo-Seq-analysis-for-mRNA-translation" class="headerlink" title="Ribo-Seq analysis for mRNA translation"></a>Ribo-Seq analysis for mRNA translation</h3><p>.</p><p>we use Ribo-Seq in combination with RNA-Seq data to investigate the sig. differential translation genes in transcriptome by condition.</p><h4 id="1-Data-prepare"><a href="#1-Data-prepare" class="headerlink" title="1.  Data prepare"></a>1.  Data prepare</h4><h6 id="1-1-verify-the-integrity-of-raw-sequence-data"><a href="#1-1-verify-the-integrity-of-raw-sequence-data" class="headerlink" title="1.1  verify the integrity of raw sequence data"></a>1.1  verify the integrity of raw sequence data</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls *fastq.gz | xargs  md5sum &gt; md5.lam.txt<br></code></pre></td></tr></table></figure><h6 id="1-2-quality-control"><a href="#1-2-quality-control" class="headerlink" title="1.2  quality control"></a>1.2  quality control</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir qc_raw &amp;&amp; cd qc_raw<br>source activate rnaseq<br>ls ../*.gz | xargs fastqc -o ./<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h5 id><a href="#" class="headerlink" title></a></h5><h6 id="1-3-adapter-trimming"><a href="#1-3-adapter-trimming" class="headerlink" title="1.3  adapter trimming"></a>1.3  adapter trimming</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir clean.SE &amp;&amp; cd clean.SE<br>source activate rnaseq<br>dir=&#x27;/data1/amliang/projects/sxl_DC/2308_RiboSeq/231221_Ribo_S2/rawdata/clean.SE&#x27;<br>trim_galore -q 25 --phred33 -a AAAAAAAAAA  --clip_R1 4  --length 20  -e 0.1 --stringency 3  -o $dir   ../*.R1.fastq.gz <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">&amp;&amp; and QC</span> <br>mkdir qc_clean.SE &amp;&amp; cd qc_clean.SE<br>ls ../clean.SE/*.gz | xargs fastqc -o ./<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="2-remove-rRNA"><a href="#2-remove-rRNA" class="headerlink" title="2. remove rRNA"></a>2. remove rRNA</h4><h6 id="2-1-download-rRNA-fasta"><a href="#2-1-download-rRNA-fasta" class="headerlink" title="2.1 download rRNA fasta"></a>2.1 download rRNA fasta</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget -c https://ftp.ncbi.nlm.nih.gov/genomes/refseq/invertebrate/Drosophila_melanogaster/latest_assembly_versions/GCF_000001215.4_Release_6_plus_ISO1_MT/GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">rRNA index building</span><br>less GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz | grep &quot;^&gt;&quot; | grep &quot;gbkey=rRNA&quot; | awk &#x27;&#123;print $1&#125;&#x27;|sed &#x27;s/&gt;//g&#x27; &gt; id.rRNA.list<br>source activate py2<br>seqkit grep -f id.rRNA.list  GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz  &gt; rRNA.fa<br><br>mkdir rRNA &amp;&amp; cd rRNA <br>bowtie2-build ../rRNA.fa  rRNA<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">tRNA index building</span><br>less GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz | grep &quot;^&gt;&quot; | grep &quot;gbkey=tRNA&quot; | awk &#x27;&#123;print $1&#125;&#x27;|sed &#x27;s/&gt;//g&#x27; &gt; id.tRNA.list<br>source activate py2<br>seqkit grep -f id.tRNA.list  GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz  &gt; tRNA.fa<br><br>mkdir tRNA &amp;&amp; cd tRNA <br>bowtie2-build ../tRNA.fa  rRNA<br><br></code></pre></td></tr></table></figure><h6 id="2-2-remove-rRNA-and-tRNA"><a href="#2-2-remove-rRNA-and-tRNA" class="headerlink" title="2.2 remove rRNA and tRNA"></a>2.2 remove rRNA and tRNA</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">remove rRNA by mapping reads to rRNA</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">save reads <span class="hljs-built_in">which</span> unmapped as non_rRNA reads</span><br>mkdir rm.rRNA &amp;&amp; cd rm.rRNA<br>ln -s ../clean.SE/*gz ./<br><br>source activate rnaseq<br>ls ./*.gz | while read id; do (echo $id &amp;&amp; bowtie2  -p 18  -x /data1/amliang/reference/rRNA/Drosophila.M/rRNA/rRNA --un-gz $(basename $&#123;id&#125; &quot;.fq.gz&quot;).rm.rRNA.fq.gz  -U $id  -S $(basename $&#123;id&#125; &quot;.fq.gz&quot;).rRNA.sam);done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">remove rRNA by mapping reads to rRNA</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">save reads <span class="hljs-built_in">which</span> unmapped as non_rRNA reads</span><br>mkdir rm.tRNA &amp;&amp; cd rm.tRNA<br>ln -s ../rm.tRNA/*.rm.rRNA.fq.gz ./<br><br>ls ./*.rm.rRNA.fq.gz | while read id; do (echo $id &amp;&amp; bowtie2  -p 18  -x /data1/amliang/reference/rRNA/Drosophila.M/tRNA/tRNA --un-gz $(basename $&#123;id&#125; &quot;.rm.rRNA.fq.gz&quot;).rm.rRNA.tRNA.fq.gz  -U $id  -S $(basename $&#123;id&#125; &quot;.rm.rRNA.fq.gz&quot;).rRNA.tRNA.sam);done<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="3-mapping-to-genome-read-counting"><a href="#3-mapping-to-genome-read-counting" class="headerlink" title="3. mapping to genome &amp; read counting"></a>3. mapping to genome &amp; read counting</h4><h6 id="3-1-mapping-to-genome"><a href="#3-1-mapping-to-genome" class="headerlink" title="3.1 mapping to genome"></a>3.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">mapping</span><br>ln -s ../rm.tRNA/*rm.rRNA.tRNA.fq.gz<br>Ref_index=/data1/amliang/reference/index/star/flybase_m6/<br>Read_dir=./<br>Run_log=runlog.txt<br>GTF=/data1/amliang/annotation/fly/flyase/gtf/dmel-all-r6.31.gtf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">input/output file</span> <br>for id in &#123;P1_L2_Q0023W0073,P2_L3_Q0013W0073,P3_L3_Q0028W0073,S4_L3_Q0016W0073,S5_L3_Q0014W0073,S6_L3_Q0021W0073&#125;;<br>do<br>Read=$&#123;Read_dir&#125;/$&#123;id&#125;.R1.rm.rRNA.tRNA.fq.gz<br>BAM=$&#123;id&#125;.bam<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Cycle Running</span><br>STAR \<br>--runThreadN 10 \<br>--outFilterType BySJout \<br>--outFilterMismatchNmax 2 \<br>--outFilterMultimapNmax 1 \<br>--genomeDir $Ref_index \<br>--readFilesIn $Read \<br>--readFilesCommand zcat \<br>--outFileNamePrefix $&#123;id&#125;_ \<br>--outSAMtype BAM SortedByCoordinate \<br>--quantMode TranscriptomeSAM GeneCounts \<br>--outSAMattributes All \<br>--outSAMattrRGline ID:1 LB:ribo_seq PL:ILLUMINA SM:$&#123;id&#125; \<br>--outBAMcompression 6 \<br>--outReadsUnmapped Fastx<br>done<br>conda deactivate<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">sort</span> &amp; index</span><br>source activate chipseq<br>ls *.out.bam|while read id ;do (samtools sort -O bam  -T sorted -o $(basename $&#123;id&#125; &quot;.out.bam&quot;).sort.bam   $&#123;id&#125;);done<br><br>ls *.sort.bam | while read id ; do (samtools index $id); done<br>conda deactivate<br></code></pre></td></tr></table></figure><h6 id="3-2-CDS-reads-count"><a href="#3-2-CDS-reads-count" class="headerlink" title="3.2 CDS reads count"></a>3.2 CDS reads count</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">source activate rnaseq<br>featureCounts -T 16  -t CDS -g gene_id -a /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gtf  -o  Ribo.CDS_count.a.txt  ./*.bam<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="4-corresponding-RNA-Seq-data"><a href="#4-corresponding-RNA-Seq-data" class="headerlink" title="4. corresponding RNA-Seq data"></a>4. corresponding RNA-Seq data</h4><h6 id="4-1-mapping-to-genome"><a href="#4-1-mapping-to-genome" class="headerlink" title="4.1 mapping to genome"></a>4.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">source activate rnaseq<br>Ref_index=/data1/amliang/reference/index/bowtie2/flybase_m6_bowtie2/<br>Read_dir=/data1/amliang/projects/sxl_DC/2308_RiboSeq/240108_RNASeq_S2/data<br>Run_log=runlog.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">input/output file</span> <br>for id in &#123;P1_L2_UDI296,P2_L2_UDI297,P3_L2_UDI298,S4_L2_UDI299,S5_L2_UDI300,S6_L2_UDI301&#125;;<br>do<br>R1=$&#123;Read_dir&#125;/$&#123;id&#125;.R1.fastq.gz<br>R2=$&#123;Read_dir&#125;/$&#123;id&#125;.R2.fastq.gz<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Cycle Running</span><br>bowtie2  -p 18 -N 0 -x $Ref_index/fly -1 $R1 -2 $R2 -S $&#123;id&#125;.sam 2&gt;&gt;$Run_log <br> <br>done<br>conda deactivate<br></code></pre></td></tr></table></figure><h6 id="4-1-mapping-to-genome-1"><a href="#4-1-mapping-to-genome-1" class="headerlink" title="4.1 mapping to genome"></a>4.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">Note: reads_count <span class="hljs-keyword">for</span> CDS not exon</span><br><br>source activate rnaseq<br>featureCounts -T 16 -p -M -t CDS -g gene_id  -a /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gtf  -o  RNASeq.CDS_count.txt  ../*.bam<br>conda deactivate<br></code></pre></td></tr></table></figure><h4 id="5-differential-translation"><a href="#5-differential-translation" class="headerlink" title="5. differential translation"></a>5. differential translation</h4><h6 id="5-1-expr-count"><a href="#5-1-expr-count" class="headerlink" title="5.1 expr. count"></a>5.1 expr. count</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#Ribo</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/RiboSeq/featureCount_CDS_multi/&quot;</span><span class="hljs-punctuation">)</span><br>Ribo_count <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Ribo.CDS.multi_count.a.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>rownames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-operator">$</span>Geneid<br>colnames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;Geneid&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;End&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Length&quot;</span><span class="hljs-punctuation">,</span>                          <span class="hljs-string">&quot;WT_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;WT_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;WT_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_3&quot;</span><span class="hljs-punctuation">)</span><br>Ribo_exp <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>Ribo_exp <span class="hljs-operator">&lt;-</span> Ribo_exp<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># RNASeq</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/transla_by_Cyt.RNAseq/&quot;</span><span class="hljs-punctuation">)</span><br>RNA_count <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;RNASeq.CDS_count.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>rownames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-operator">$</span>Geneid<br>colnames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;Geneid&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;End&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Length&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_3&quot;</span><span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;C.wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_3&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_3&quot;</span><span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> RNA_exp<span class="hljs-punctuation">[</span>rownames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span> <span class="hljs-operator">%in%</span> rownames<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure><h6 id="5-2-PCA"><a href="#5-2-PCA" class="headerlink" title="5.2 PCA"></a>5.2 PCA</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#normalized - Ribo</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br>Ribo_exp_read.count <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">]</span><br>Ribo_exp_read.count <span class="hljs-operator">&lt;-</span> Ribo_exp_read.count<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>condition <span class="hljs-operator">&lt;-</span>factor<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                   levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>colData <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>row.names<span class="hljs-operator">=</span>colnames<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeqDataSetFromMatrix<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">,</span> colData<span class="hljs-punctuation">,</span> design<span class="hljs-operator">=</span> <span class="hljs-operator">~</span> condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeq<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">)</span><br>Ribo_normalized_counts <span class="hljs-operator">&lt;-</span> counts<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">,</span> normalized<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>Ribo_normalized_counts <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>Ribo_normalized_counts<span class="hljs-punctuation">)</span><br>Ribo_normalized_counts<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>Ribo_normalized_counts<span class="hljs-punctuation">)</span><br>Ribo_rpkm<span class="hljs-operator">&lt;-</span> Ribo_normalized_counts<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">7</span><span class="hljs-punctuation">]</span><br><br>library<span class="hljs-punctuation">(</span>FactoMineR<span class="hljs-punctuation">)</span><br>gene <span class="hljs-operator">&lt;-</span> t<span class="hljs-punctuation">(</span>Ribo_rpkm<span class="hljs-punctuation">)</span><br>gene.pca <span class="hljs-operator">&lt;-</span> PCA<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">,</span> ncp <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> scale.unit <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> graph <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>gene.pca<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># chose: WT_1,WT_3,SXL_1,SXL2</span><br><br><br><span class="hljs-comment">#normalized - RNAS</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br>RNA_exp_read.count <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>RNA_exp_read.count <span class="hljs-operator">&lt;-</span> RNA_exp_read.count<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>condition <span class="hljs-operator">&lt;-</span>factor<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                   levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>colData <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>row.names<span class="hljs-operator">=</span>colnames<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeqDataSetFromMatrix<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">,</span> colData<span class="hljs-punctuation">,</span> design<span class="hljs-operator">=</span> <span class="hljs-operator">~</span> condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeq<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">)</span><br>RNA_normalized_counts <span class="hljs-operator">&lt;-</span> counts<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">,</span> normalized<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>RNA_normalized_counts <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>RNA_normalized_counts<span class="hljs-punctuation">)</span><br>RNA_normalized_counts<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>RNA_normalized_counts<span class="hljs-punctuation">)</span><br>RNA_rpkm<span class="hljs-operator">&lt;-</span> RNA_normalized_counts<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">7</span><span class="hljs-punctuation">]</span><br><br>library<span class="hljs-punctuation">(</span>FactoMineR<span class="hljs-punctuation">)</span><br>gene <span class="hljs-operator">&lt;-</span> t<span class="hljs-punctuation">(</span>RNA_rpkm<span class="hljs-punctuation">)</span><br>gene.pca <span class="hljs-operator">&lt;-</span> PCA<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">,</span> ncp <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> scale.unit <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> graph <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>gene.pca<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># chose: WT_1,WT_2,SXL_2,SXL3</span><br></code></pre></td></tr></table></figure><h6 id="5-3-calculating-differential-translation-genes-by-riborex"><a href="#5-3-calculating-differential-translation-genes-by-riborex" class="headerlink" title="5.3 calculating differential translation genes by riborex"></a>5.3 calculating differential translation genes by riborex</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs R">Ribo_exp <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># riborex</span><br>library<span class="hljs-punctuation">(</span>fdrtool<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>riborex<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br><br>RNACntTable <span class="hljs-operator">&lt;-</span> RNA_exp<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>RiboCntTable <span class="hljs-operator">&lt;-</span> Ribo_exp<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>head<span class="hljs-punctuation">(</span>RNACntTable<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>RiboCntTable<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br><br>rnaCond <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">)</span><br>riboCond <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">)</span><br>res.deseq2 <span class="hljs-operator">&lt;-</span> riborex<span class="hljs-punctuation">(</span>RNACntTable<span class="hljs-punctuation">,</span> RiboCntTable<span class="hljs-punctuation">,</span> rnaCond<span class="hljs-punctuation">,</span> riboCond<span class="hljs-punctuation">,</span> engine <span class="hljs-operator">=</span> <span class="hljs-string">&quot;DESeq2&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br>hist<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-operator">$</span>pvalue<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;DESeq2 unadjusted p-values&#x27;</span><span class="hljs-punctuation">,</span> xlab<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Unadjusted p-values&#x27;</span><span class="hljs-punctuation">,</span><br>     col <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;#F4C7AB&#x27;</span><span class="hljs-punctuation">)</span><br><br>result <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-punctuation">)</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> result<span class="hljs-punctuation">[</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>result<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span><span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> result<span class="hljs-operator">$</span>padj<span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&gt;</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>tranla_diff<span class="hljs-punctuation">)</span><br>tranla_up <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_down <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220910_annotation/Drosaphila/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>rtracklayer<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>genome.anno <span class="hljs-operator">&lt;-</span> import<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;dmel-all-r6.44.gtf&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> as.data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>genome.anno<span class="hljs-operator">=</span>genome.anno<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;gene_id&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;seqnames&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;width&quot;</span><span class="hljs-punctuation">,</span><br>                           <span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>head<span class="hljs-punctuation">(</span>genome.anno<span class="hljs-punctuation">)</span><br>genome.anno <span class="hljs-operator">&lt;-</span> genome.anno<span class="hljs-punctuation">[</span>genome.anno<span class="hljs-operator">$</span>type<span class="hljs-operator">==</span><span class="hljs-string">&quot;gene&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>genome.anno<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;seqnames&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;length&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">)</span><br><br>result<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>result<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>result<span class="hljs-punctuation">,</span>genome.anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>Ribo_exp<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span>  rownames<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span>Ribo_exp<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>RNA_exp<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span>RNA_exp<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><br>T_diff <span class="hljs-operator">&lt;-</span> T_S2<span class="hljs-punctuation">[</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> T_S2<span class="hljs-operator">$</span>pvalue <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_diff <span class="hljs-operator">&lt;-</span> dplyr<span class="hljs-operator">::</span>filter<span class="hljs-punctuation">(</span>T_diff<span class="hljs-punctuation">,</span> <span class="hljs-operator">!</span><span class="hljs-built_in">is.na</span><span class="hljs-punctuation">(</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>T_test <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&lt;=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_diff <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&gt;</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_up <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_down <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-01-01</title>
    <link href="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/"/>
    <url>/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-01-01"><a href="#2025-01-01" class="headerlink" title="2025-01-01"></a>2025-01-01</h3><p>.</p><hr><p>573</p><p></p><p>.</p><p>910</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E5%AF%B9%E9%9D%A2%E6%98%AF%E5%8C%BB%E5%AD%A6%E9%83%A8.jpg" alt="20250101  "></p><p>.</p><p></p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E6%B9%96%E5%B2%B8%E8%BE%B9%E9%BB%84%E4%BA%86%E7%9A%84%E6%9F%B3%E6%A0%91.jpg" alt="20250101  "></p><p>.</p><p></p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E4%B8%AD%E5%8D%88%E5%88%B0%E8%BE%BE%E4%B9%9D%E5%B3%B0%E6%A1%A5.jpg" alt="20250101  "></p><p>.</p><p></p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E4%B9%9D%E5%B3%B0%E8%8F%9C%E5%B8%82%E5%9C%BA%E9%99%84%E4%BB%B6%20%E8%82%A5%E8%82%A0%E7%B2%89.jpg" alt="20250101   "></p><p>.</p><p></p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E6%B2%B9%E8%8F%9C%E5%B9%BC%E8%8B%97.jpg" alt="20250101  "></p><p>.</p><p></p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E5%A4%95%E9%98%B3.jpg" alt="20250101  "></p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>GSEA in drosophila</title>
    <link href="/2024/12/31/GSEA%20in%20drosophila/"/>
    <url>/2024/12/31/GSEA%20in%20drosophila/</url>
    
    <content type="html"><![CDATA[<h3 id="GSEA-in-drosophila"><a href="#GSEA-in-drosophila" class="headerlink" title="GSEA in drosophila"></a>GSEA in drosophila</h3><p>.</p><p>This is a work log using R script to perform Gene Set Enrichment Analysis by differentialy expression genes in drosophila.</p><p>and this script also applies to other species, such as human and mouse.</p><p>human : org.Hs.eg.db</p><p>mouse : org.Mm.eg.db</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>library<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>clusterProfiler<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>DOSE<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>topGO<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>pathview<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>KEGG.db<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>enrichplot<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># RNA-Seq data</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240506&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>expr_gene <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;DEGs_240506.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;new.diff_gene_all_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># transfer ENSEMBL into ENTREZID</span><br>geneList<span class="hljs-operator">&lt;-</span>expr_gene<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log2FoldChange&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>eg <span class="hljs-operator">&lt;-</span> bitr<span class="hljs-punctuation">(</span>geneList<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span> <br>           fromType<span class="hljs-operator">=</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span> <br>           toType<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ENTREZID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;SYMBOL&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>           OrgDb<span class="hljs-operator">=</span><span class="hljs-string">&quot;org.Dm.eg.db&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>eg<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># sorted by log2FC</span><br>input_data <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>eg<span class="hljs-punctuation">,</span>geneList<span class="hljs-punctuation">,</span>by.x<span class="hljs-operator">=</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span>by.y<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">)</span><br>input_data_sort <span class="hljs-operator">&lt;-</span> input_data<span class="hljs-punctuation">[</span>order<span class="hljs-punctuation">(</span>input_data<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">,</span> decreasing <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>gene_fc <span class="hljs-operator">=</span> input_data_sort<span class="hljs-operator">$</span>log2FoldChange<br><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>gene_fc<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> input_data_sort<span class="hljs-operator">$</span>ENTREZID<br>head<span class="hljs-punctuation">(</span>gene_fc<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># gseGO</span><br>GO <span class="hljs-operator">&lt;-</span> gseGO<span class="hljs-punctuation">(</span><br>  gene_fc<span class="hljs-punctuation">,</span> <span class="hljs-comment">#gene_fc</span><br>  ont <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ALL&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># &quot;BP&quot;,&quot;MF&quot;,&quot;CC&quot; or &quot;ALL&quot;</span><br>  OrgDb <span class="hljs-operator">=</span> org.Dm.eg.db<span class="hljs-punctuation">,</span><br>  keyType <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ENTREZID&quot;</span><span class="hljs-punctuation">,</span><br>  pvalueCutoff <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>  pAdjustMethod <span class="hljs-operator">=</span> <span class="hljs-string">&quot;BH&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>go_terms <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># diaw plot</span><br><span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>file.exists<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  dir.create<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br>  setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>  setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;sex_differentiation.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">7.2</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">600</span><span class="hljs-punctuation">)</span><br>gseaplot2<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;GO:0007548&quot;</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;firebrick&quot;</span><span class="hljs-punctuation">,</span> <br>          title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;sex differentiation&quot;</span><span class="hljs-punctuation">,</span><br>          rel_heights<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>output files :</p><p>I chose to show a term about sex determination pathway:</p><p><img src="/2024/12/31/GSEA%20in%20drosophila/Terms.png" alt="Terms"></p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Texcel</title>
    <link href="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="Texcel"><a href="#Texcel" class="headerlink" title="Texcel"></a>Texcel</h3><p>.</p><p>Excel</p><p>tut</p><p>t</p><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p></p><p><strong></strong></p><p>nkm1m2m3mkm1m2m3mk</p><p>n Bin(<em>n, p</em>) N(<em>np</em>, <em>np</em>(<em>1-p</em>))</p><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p><strong></strong></p><p>50%10<br>    </p><p>H0 50%<br>H1</p><p>H00.510 0.5^10 &#x3D; 0.00098H0H0H1</p><p></p><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p></p><p>tz</p><p></p><p>zpp</p><p>H0pp</p><p>p10.05p</p><p></p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83.png" alt=""></p><p>tutt-test</p><h5 id="t"><a href="#t" class="headerlink" title="t"></a>t</h5><p>tstudent  student student test</p><p>tn &lt; 30&gt;&#x3D;30z</p><p></p><p>t<em>df</em> &#x3D; <em>n - 1</em>tdfdftdft</p><hr><p>texcel</p><p></p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/input_data%201.png" alt="input_data 1"></p><p>exceltt.test()Array1controlArray2treat</p><p>Tail</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/Tails.png" alt="Tails"></p><p>t.test()    </p><p></p><p>10</p><p> (AB) ABBA</p><p></p><p>Tailtype</p><p>type3</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/Type.png" alt="Type"></p><p>t</p><p>ttt</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/input_data%202.png" alt="input_data 2"></p><p>tt</p><p>t</p><p></p><p></p><p> Levene </p><p></p><p></p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/"/>
    <url>/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/</url>
    
    <content type="html"><![CDATA[<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>.</p><p></p><p></p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0.png" alt=""></p><p></p><p>107943</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E5%AE%9A%E9%A3%8E%E6%B3%A2.jpg" alt=""></p><p></p><p></p><p>108448</p><p>1080</p><p></p><p></p><p></p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E5%A4%8F%E5%A4%9C%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C.jpg" alt=""></p><p></p><p></p><p>word[2]</p><p></p>]]></content>
    
    
    <categories>
      
      <category></category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Peak calling for CLIP-Seq data by omniCLIP [1]</title>
    <link href="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/"/>
    <url>/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/</url>
    
    <content type="html"><![CDATA[<h3 id="Peak-calling-for-CLIP-Seq-data-by-omniCLIP-1"><a href="#Peak-calling-for-CLIP-Seq-data-by-omniCLIP-1" class="headerlink" title="Peak calling for CLIP-Seq data by omniCLIP [1]"></a>Peak calling for CLIP-Seq data by omniCLIP [1]</h3><p>.</p><p> I have used omniCLIP to analyze CLIP data a few months ago, but the software is poorly maintained. The author is also incompetent, as they didnt even clearly explain the output files. </p><p>Although the software is quite bad, I still want to record how to use it.</p><hr><p>I have skimmed through this papers (about the omniCLIP), and now I will provide a brief explanation of its computational principles and algorithm.</p><p>This paper ( Philipp et. al. 2018,Genome biology)  employ a Non-Homogeneous Hidden Markov Model (NHMM) to segment the genome into peaks and non-peaks. The emission probability of the NHMM is given by the product of the joint probability of the coverage and the probability of the observed diagnostic event frequency in all replicate CLIP and background libraries.</p><p>And a Negative Binomial based Generalized Linear Model (that models both confounding by the gene expression, and confounding of local effects and also allows to account for excess variance) are used to model the reads coverage.</p><p>Besides, the diagnostic events are modeled using a Dirichlet-Multinomial mixture model. The transition probabilities of the model are based on a logistic function that depends on the coverage. </p><h5 id="The-diagram-below-illustrates-the-algorithmic-of-omniCLIP"><a href="#The-diagram-below-illustrates-the-algorithmic-of-omniCLIP" class="headerlink" title="The diagram below illustrates the algorithmic of omniCLIP."></a>The diagram below illustrates the algorithmic of omniCLIP.</h5><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/Illustration%20of%20omniCLIP%20peak%20calling%20.png" alt="Illustration of omniCLIP peak calling "></p><p>show on the (left) is peak calling for a lowly expressed genes with strong RNA binding protein (RBP) RNA-binding and on the (right) a highly expressed gene with weak RBP RNA-binding. During peak calling, local background coverage is taken into account to correct for confounding by local effects or biases. Furthermore, overall the RNA abundance is estimated and accounted for. This allows better ranking peaks with identical local coverage by sharing of information along the transcript, as illustrated for the leftmost peaks in both genes.  </p><hr><h3 id="1-data-preparation"><a href="#1-data-preparation" class="headerlink" title="1. data preparation"></a>1. data preparation</h3><h4 id="1-1-data"><a href="#1-1-data" class="headerlink" title="1.1). data"></a>1.1). data</h4><p><strong>GSE98188</strong> from paper : </p><p>  Drosophila Sister-of-Sex-lethal reinforces a male-specific gene expression pattern by controlling Sex-lethal alternative splicing.  </p><p>  <em>Nucleic Acids Res</em> 2019</p><p> <strong>data download</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">iCLIP <span class="hljs-keyword">in</span> SL2 cells</span><br>lftp -e &#x27;pget -n 15 -c &quot;ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR548/007/SRR5480967/SRR5480967.fastq.gz&quot;;exit&#x27; # Similar methods for other samples.<br></code></pre></td></tr></table></figure><h4 id="1-2-data-clean"><a href="#1-2-data-clean" class="headerlink" title="1.2). data clean"></a>1.2). data clean</h4><p> <strong>Since the paper did not provide the adapter sequences and the length and position of the UMI</strong>.</p><p> I  tried different methods  to mark and remove the UMI and adapter.</p><p> <strong>a). remove adapter</strong></p><p>To detect the adapter sequences used, I first processed the raw sequencing data with trim_galore.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls ../*fastq.gz |while read id;do (trim_galore --quality 20  --length 20 -o ./ $id);done<br></code></pre></td></tr></table></figure><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/remove%20adapter.png" alt="remove adapter"></p><p>Based on the auto-detection adapter in the above figure, we can infer that the adapter sequence is AGATCGGAAGAGC.</p><p>The same processing method was applied to the other samples as well.   </p><p>Therefore,  removing the adapter from the raw sequence data based on the sequences identified above.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in *.fastq.gz;<br>do<br>id=$&#123;i%.fastq.gz&#125;<br>echo $i,$id<br>cutadapt -q 25 -a AGATCGGAAGAGC  --overlap=3 -n 1 -m 24 -o $&#123;id&#125;_cutadap.fastq.gz  $&#123;id&#125;.fastq.gz<br>done<br></code></pre></td></tr></table></figure><p> <strong>b). mark UMI</strong></p><p> I used the adapters-removed reads for a BLAST against the genome in flybase and found that there are always 10 unpaired  bases at the 5 end of the reads. Therefore, I suspect these are the UMI, as shown in the figure below.</p><p><a href="mailto:&#114;&#101;&#97;&#100;&#45;&#64;&#x53;&#82;&#x52;&#53;&#52;&#56;&#x30;&#57;&#x36;&#x37;&#46;&#49;&#x31;">&#114;&#101;&#97;&#100;&#45;&#64;&#x53;&#82;&#x52;&#53;&#52;&#56;&#x30;&#57;&#x36;&#x37;&#46;&#49;&#x31;</a> 11&#x2F;1   length &#x3D; 53 bp       <img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/reads%20blast%201.png" alt="reads blast 1">                         </p><p><a href="mailto:&#x72;&#101;&#97;&#100;&#45;&#x40;&#83;&#82;&#x52;&#x35;&#52;&#x38;&#x30;&#x39;&#x36;&#55;&#x2e;&#x32;&#49;&#56;">&#x72;&#101;&#97;&#100;&#45;&#x40;&#83;&#82;&#x52;&#x35;&#52;&#x38;&#x30;&#x39;&#x36;&#55;&#x2e;&#x32;&#49;&#56;</a> 218&#x2F;1   length &#x3D; 51 bp</p><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/reads%20blast%202.png" alt="reads blast 2"></p><p>Next, I used the <strong>flexbar</strong> software to mark the UMIs in the reads.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat &gt;  barcodes.fa   # create a file, with 10 N (length of UMI is 10 bp)<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">umi</span><br>NNNNNNNNNN<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda activate py39<br><br>for i in *_cutadapt.fastq.gz;<br>do<br>id=$&#123;i%_cutadapt.fastq.gz&#125;<br>echo $i,$id<br>flexbar -r $&#123;id&#125;_cutadapt.fastq.gz  -b barcodes.fa --umi-tags -t $&#123;id&#125; -z GZ<br>done<br></code></pre></td></tr></table></figure><h3 id="2-omniCLIP-for-CLIP-Seq-peaks-calling"><a href="#2-omniCLIP-for-CLIP-Seq-peaks-calling" class="headerlink" title="2.omniCLIP for CLIP-Seq peaks calling"></a>2.omniCLIP for CLIP-Seq peaks calling</h3><h4 id="2-1-intsall-omniCLIP"><a href="#2-1-intsall-omniCLIP" class="headerlink" title="2.1). intsall omniCLIP"></a>2.1). intsall omniCLIP</h4><p><strong>download</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git clone https://github.com/philippdre/omniCLIP.git <br></code></pre></td></tr></table></figure><p><strong>create conda env</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd omniCLIP/<br>conda env create -f environment.yml<br>conda activate omniEnv<br></code></pre></td></tr></table></figure><p><strong>install</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python3 setup.py install<br></code></pre></td></tr></table></figure><h4 id="2-2-build-a-db-files-of-annotation-gtf"><a href="#2-2-build-a-db-files-of-annotation-gtf" class="headerlink" title="2.2). build a db files of annotation gtf"></a>2.2). build a db files of annotation gtf</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /home/xuyz_g/soft/omniCLIP # programs can only run successfully in directory of omniCLIPdon&#x27;t know why<br><br>omniCLIP generateDB --gff-file /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gff3 --db-file /data1/amliang/annotation/fly/flyase/gff/omniCLIP/dmel-all-r6.45.gff.db # <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">At the same <span class="hljs-keyword">time</span>, you also need to prepare a reference genome sequence and divide it into chromosomes</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">like this <span class="hljs-keyword">in</span> : /data3/tmp_g/genome_anno/fly/genome/chroms</span><br>  2L.fa.gz<br>  2R.fa.gz<br>  3L.fa.gz<br>  3R.fa.gz<br>  4.fa.gz<br>  X.fa.gz<br>  Y.fa.gz<br></code></pre></td></tr></table></figure><h4 id="error"><a href="#error" class="headerlink" title="error"></a>error</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1) If an error message appears saying that like this:</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">   FileNotFoundError: [Errno 2] No such file or directory: <span class="hljs-string">&#x27;version.py&#x27;</span>,</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash"> just copy it from another directory to this directory.</span><br>cp /data1/tmp/soft/omniCLIP/version.py  yourPath/omniCLIP-0.2.0-py3.8-linux-x86_64.egg/omniCLIP/<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2) <span class="hljs-keyword">if</span> a error shows:</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash"> File <span class="hljs-string">&quot;yourPath/omniCLIP/data_parsing/ParsingArgs.py&quot;</span>, line 44, <span class="hljs-keyword">in</span> parsing_argparse</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">   NameError: name <span class="hljs-string">&#x27;verifying_args&#x27;</span> is not defined</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Just vim into ParsingArgs.py and comment out or delete this line of verifying_args : like picture</span><br></code></pre></td></tr></table></figure><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/debug.png" alt="debug"></p><h4 id="2-3-parsing-the-background-files"><a href="#2-3-parsing-the-background-files" class="headerlink" title="2.3). parsing the background files"></a>2.3). parsing the background files</h4><h6 id="Usually-RNA-SEQ-data-but-sometimes-input-data-is-used"><a href="#Usually-RNA-SEQ-data-but-sometimes-input-data-is-used" class="headerlink" title="(Usually RNA-SEQ data, but sometimes input data is used)"></a>(Usually RNA-SEQ data, but sometimes input data is used)</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP parsingBG --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db --genome-dir /data3/tmp_g/projects/omniCLIP/chroms/ --bg-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ctrl_IP1.bam --bg-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ctrl_IP2.bam  --out-file /data3/tmp_g/projects/SSX_CLIP/4.peak/CTRL.dat<br></code></pre></td></tr></table></figure><h4 id="2-4-parsing-the-CLIP-files"><a href="#2-4-parsing-the-CLIP-files" class="headerlink" title="2.4). parsing the CLIP files"></a>2.4). parsing the CLIP files</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP parsingCLIP --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db --genome-dir /data3/tmp_g/projects/omniCLIP/chroms/ --clip-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ssx_IP1.bam  --clip-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ssx_IP2.bam  --out-file /data3/tmp_g/projects/SSX_CLIP/4.peak/SSX.dat<br></code></pre></td></tr></table></figure><h4 id="2-5-Running-the-omniCLIP-algorithm"><a href="#2-5-Running-the-omniCLIP-algorithm" class="headerlink" title="2.5). Running the omniCLIP algorithm"></a>2.5). Running the omniCLIP algorithm</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP run_omniCLIP --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db  --bg-dat /data3/tmp_g/projects/SSX_CLIP/4.peak/CTRL.dat  --clip-dat /data3/tmp_g/projects/SSX_CLIP/4.peak/SSX.dat  --out-dir /data3/tmp_g/projects/SSX_CLIP/4.peak/reslut<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Brief Introduction</title>
    <link href="/2024/09/24/Brief-Introduction/"/>
    <url>/2024/09/24/Brief-Introduction/</url>
    
    <content type="html"><![CDATA[<p>Dont think Im boring !</p><p>This is just a test text !</p><p>There will be more interesting things to share later !</p><p></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
