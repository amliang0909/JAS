<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Add full name and description for target genes</title>
    <link href="/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/"/>
    <url>/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/</url>
    
    <content type="html"><![CDATA[<h3 id="Add-full-name-and-description-for-target-genes"><a href="#Add-full-name-and-description-for-target-genes" class="headerlink" title="Add full name and description for target genes"></a>Add full name and description for target genes</h3><p>.</p><p>Some genesâ€™ functions may not be easily inferred from their abbreviated names, therefore, to be better understand the genes, we need to include their full names and other forms of ID numbers for the target genes.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------</span><br><span class="hljs-comment"># function and detail description of target genes by gtf</span><br><br><span class="hljs-comment"># anno.</span><br>library<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">)</span><br>eg2Symbol<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egSYMBOL<span class="hljs-punctuation">)</span><br>eg2name<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egGENENAME<span class="hljs-punctuation">)</span><br>eg2ENSEMBL<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egENSEMBL<span class="hljs-punctuation">)</span><br>anno<span class="hljs-operator">=</span>merge<span class="hljs-punctuation">(</span>eg2ENSEMBL<span class="hljs-punctuation">,</span>merge<span class="hljs-punctuation">(</span>eg2Symbol<span class="hljs-punctuation">,</span>eg2name<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;gene_id&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;gene_id&#x27;</span><span class="hljs-punctuation">)</span>  <br>colnames<span class="hljs-punctuation">(</span>anno<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ENTREID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Gene_name&quot;</span><span class="hljs-punctuation">)</span><br>anno <span class="hljs-operator">&lt;-</span> anno<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>anno<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># target genes</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/RiboSeq/featureCount_CDS_multi/&quot;</span><span class="hljs-punctuation">)</span><br>target_genes <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;riborex_translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;tranlation_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># add detail description to target genes</span><br>new_target_genes <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>target_genes<span class="hljs-punctuation">,</span>anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>intersect<span class="hljs-punctuation">(</span>anno<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span>target_genes<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># save</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240222_question.daily/17.detail.description_diff_translation.genes/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>openxlsx<span class="hljs-punctuation">)</span><br>wb <span class="hljs-operator">&lt;-</span> createWorkbook<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>addWorksheet<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;new_target_genes&quot;</span><span class="hljs-punctuation">)</span><br>writeData<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;new_target_genes&quot;</span><span class="hljs-punctuation">,</span> new_target_genes<span class="hljs-punctuation">,</span>startCol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> startRow <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> rowNames <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>saveWorkbook<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> file<span class="hljs-operator">=</span><span class="hljs-string">&#x27;target_genes_with_detial_description.xlsx&#x27;</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>output file :</p><p>the full names are indicated by the red box.</p><p><img src="/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/target%20genes%20with%20their%20full%20names%20already%20added.png" alt="target genes with their full names already added"></p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Highlighting the target gene in scatterplot</title>
    <link href="/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/"/>
    <url>/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/</url>
    
    <content type="html"><![CDATA[<h3 id="Highlighting-the-target-gene-in-scatterplot"><a href="#Highlighting-the-target-gene-in-scatterplot" class="headerlink" title="Highlighting the target gene in scatterplot"></a>Highlighting the target gene in scatterplot</h3><p>.</p><p>the scatter points with different colors and sizes  were used to distinguish the target gene from other genes, and labeled the target gene with  gene symbol.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs R"><br><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>latex2exp<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>mdthemes<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggrepel<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240506&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>diff_gene_all <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;DEGs_240506.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;new.diff_gene_all_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br>new.res<span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>diff_gene_all<span class="hljs-punctuation">)</span> <br>new.res<span class="hljs-operator">$</span>group <span class="hljs-operator">=</span> as.factor<span class="hljs-punctuation">(</span>ifelse<span class="hljs-punctuation">(</span> <span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>new.res<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> new.res<span class="hljs-operator">$</span>padj<span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><br>                                  ifelse<span class="hljs-punctuation">(</span>new.res<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Up&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Down&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                  <span class="hljs-string">&quot;NS&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>target_gene_1 <span class="hljs-operator">&lt;-</span> new.res<span class="hljs-punctuation">[</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Ugt37A3&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;CG43845&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span>   <br>target_gene_2 <span class="hljs-operator">&lt;-</span> new.res<span class="hljs-punctuation">[</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Sox21a&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;CG14669&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>new.res_F <span class="hljs-operator">&lt;-</span> filter<span class="hljs-punctuation">(</span>new.res<span class="hljs-punctuation">,</span><span class="hljs-operator">!</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> target_gene_1<span class="hljs-operator">$</span>gene_symbol <span class="hljs-punctuation">)</span><br>new.res_F <span class="hljs-operator">&lt;-</span> filter<span class="hljs-punctuation">(</span>new.res_F<span class="hljs-punctuation">,</span><span class="hljs-operator">!</span>new.res_F<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> target_gene_2<span class="hljs-operator">$</span>gene_symbol <span class="hljs-punctuation">)</span><br><br>My_Theme <span class="hljs-operator">=</span> theme<span class="hljs-punctuation">(</span><br>  panel.background <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">16</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  text <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>  axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>  axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>  axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>  axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  legend.text<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  legend.title<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br>ggplot<span class="hljs-punctuation">(</span>data <span class="hljs-operator">=</span> new.res_F<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_point<span class="hljs-punctuation">(</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span> size<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> group<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_color_manual<span class="hljs-punctuation">(</span>values<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gray&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;blue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span> <br>  geom_vline<span class="hljs-punctuation">(</span>xintercept<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  labs<span class="hljs-punctuation">(</span>title<span class="hljs-operator">=</span><span class="hljs-string">&quot;differential expr. genes&quot;</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;log2 Fold Change&#x27;</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;-log10 p-value&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  xlim<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  <br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">300</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  My_Theme <span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_1<span class="hljs-punctuation">,</span> <br>             aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             size<span class="hljs-operator">=</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span> col<span class="hljs-operator">=</span><span class="hljs-string">&quot;darkred&quot;</span><span class="hljs-punctuation">,</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_2<span class="hljs-punctuation">,</span> <br>             aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             size<span class="hljs-operator">=</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span> col<span class="hljs-operator">=</span><span class="hljs-string">&quot;darkblue&quot;</span><span class="hljs-punctuation">,</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_text_repel<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_1<span class="hljs-punctuation">,</span><br>                  aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>label<span class="hljs-operator">=</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                  color<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_text_repel<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_2<span class="hljs-punctuation">,</span><br>                  aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>label<span class="hljs-operator">=</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                  color<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>output files :</p><p><img src="/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/differential%20expression%20genes.png" alt="differential expression genes"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Differential translation gene by RiboSeq</title>
    <link href="/2025/01/02/differential-translation-gene-by-RiboSeq/"/>
    <url>/2025/01/02/differential-translation-gene-by-RiboSeq/</url>
    
    <content type="html"><![CDATA[<h3 id="Ribo-Seq-analysis-for-mRNA-translation"><a href="#Ribo-Seq-analysis-for-mRNA-translation" class="headerlink" title="Ribo-Seq analysis for mRNA translation"></a>Ribo-Seq analysis for mRNA translation</h3><p>.</p><p>we use Ribo-Seq in combination with RNA-Seq data to investigate the sig. differential translation genes in transcriptome by condition.</p><h4 id="1-Data-prepare"><a href="#1-Data-prepare" class="headerlink" title="1.  Data prepare"></a>1.  Data prepare</h4><h6 id="1-1-verify-the-integrity-of-raw-sequence-data"><a href="#1-1-verify-the-integrity-of-raw-sequence-data" class="headerlink" title="1.1  verify the integrity of raw sequence data"></a>1.1  verify the integrity of raw sequence data</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls *fastq.gz | xargs  md5sum &gt; md5.lam.txt<br></code></pre></td></tr></table></figure><h6 id="1-2-quality-control"><a href="#1-2-quality-control" class="headerlink" title="1.2  quality control"></a>1.2  quality control</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir qc_raw &amp;&amp; cd qc_raw<br>source activate rnaseq<br>ls ../*.gz | xargs fastqc -o ./<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h5 id><a href="#" class="headerlink" title></a></h5><h6 id="1-3-adapter-trimming"><a href="#1-3-adapter-trimming" class="headerlink" title="1.3  adapter trimming"></a>1.3  adapter trimming</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir clean.SE &amp;&amp; cd clean.SE<br>source activate rnaseq<br>dir=&#x27;/data1/amliang/projects/sxl_DC/2308_RiboSeq/231221_Ribo_S2/rawdata/clean.SE&#x27;<br>trim_galore -q 25 --phred33 -a AAAAAAAAAA  --clip_R1 4  --length 20  -e 0.1 --stringency 3  -o $dir   ../*.R1.fastq.gz <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">&amp;&amp; and QC</span> <br>mkdir qc_clean.SE &amp;&amp; cd qc_clean.SE<br>ls ../clean.SE/*.gz | xargs fastqc -o ./<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="2-remove-rRNA"><a href="#2-remove-rRNA" class="headerlink" title="2. remove rRNA"></a>2. remove rRNA</h4><h6 id="2-1-download-rRNA-fasta"><a href="#2-1-download-rRNA-fasta" class="headerlink" title="2.1 download rRNA fasta"></a>2.1 download rRNA fasta</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget -c https://ftp.ncbi.nlm.nih.gov/genomes/refseq/invertebrate/Drosophila_melanogaster/latest_assembly_versions/GCF_000001215.4_Release_6_plus_ISO1_MT/GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">rRNA index building</span><br>less GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz | grep &quot;^&gt;&quot; | grep &quot;gbkey=rRNA&quot; | awk &#x27;&#123;print $1&#125;&#x27;|sed &#x27;s/&gt;//g&#x27; &gt; id.rRNA.list<br>source activate py2<br>seqkit grep -f id.rRNA.list  GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz  &gt; rRNA.fa<br><br>mkdir rRNA &amp;&amp; cd rRNA <br>bowtie2-build ../rRNA.fa  rRNA<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">tRNA index building</span><br>less GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz | grep &quot;^&gt;&quot; | grep &quot;gbkey=tRNA&quot; | awk &#x27;&#123;print $1&#125;&#x27;|sed &#x27;s/&gt;//g&#x27; &gt; id.tRNA.list<br>source activate py2<br>seqkit grep -f id.tRNA.list  GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz  &gt; tRNA.fa<br><br>mkdir tRNA &amp;&amp; cd tRNA <br>bowtie2-build ../tRNA.fa  rRNA<br><br></code></pre></td></tr></table></figure><h6 id="2-2-remove-rRNA-and-tRNA"><a href="#2-2-remove-rRNA-and-tRNA" class="headerlink" title="2.2 remove rRNA and tRNA"></a>2.2 remove rRNA and tRNA</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">remove rRNA by mapping reads to rRNA</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">save reads <span class="hljs-built_in">which</span> unmapped as non_rRNA reads</span><br>mkdir rm.rRNA &amp;&amp; cd rm.rRNA<br>ln -s ../clean.SE/*gz ./<br><br>source activate rnaseq<br>ls ./*.gz | while read id; do (echo $id &amp;&amp; bowtie2  -p 18  -x /data1/amliang/reference/rRNA/Drosophila.M/rRNA/rRNA --un-gz $(basename $&#123;id&#125; &quot;.fq.gz&quot;).rm.rRNA.fq.gz  -U $id  -S $(basename $&#123;id&#125; &quot;.fq.gz&quot;).rRNA.sam);done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">remove rRNA by mapping reads to rRNA</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">save reads <span class="hljs-built_in">which</span> unmapped as non_rRNA reads</span><br>mkdir rm.tRNA &amp;&amp; cd rm.tRNA<br>ln -s ../rm.tRNA/*.rm.rRNA.fq.gz ./<br><br>ls ./*.rm.rRNA.fq.gz | while read id; do (echo $id &amp;&amp; bowtie2  -p 18  -x /data1/amliang/reference/rRNA/Drosophila.M/tRNA/tRNA --un-gz $(basename $&#123;id&#125; &quot;.rm.rRNA.fq.gz&quot;).rm.rRNA.tRNA.fq.gz  -U $id  -S $(basename $&#123;id&#125; &quot;.rm.rRNA.fq.gz&quot;).rRNA.tRNA.sam);done<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="3-mapping-to-genome-read-counting"><a href="#3-mapping-to-genome-read-counting" class="headerlink" title="3. mapping to genome &amp; read counting"></a>3. mapping to genome &amp; read counting</h4><h6 id="3-1-mapping-to-genome"><a href="#3-1-mapping-to-genome" class="headerlink" title="3.1 mapping to genome"></a>3.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">mapping</span><br>ln -s ../rm.tRNA/*rm.rRNA.tRNA.fq.gz<br>Ref_index=/data1/amliang/reference/index/star/flybase_m6/<br>Read_dir=./<br>Run_log=runlog.txt<br>GTF=/data1/amliang/annotation/fly/flyase/gtf/dmel-all-r6.31.gtf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">input/output file</span> <br>for id in &#123;P1_L2_Q0023W0073,P2_L3_Q0013W0073,P3_L3_Q0028W0073,S4_L3_Q0016W0073,S5_L3_Q0014W0073,S6_L3_Q0021W0073&#125;;<br>do<br>Read=$&#123;Read_dir&#125;/$&#123;id&#125;.R1.rm.rRNA.tRNA.fq.gz<br>BAM=$&#123;id&#125;.bam<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Cycle Running</span><br>STAR \<br>--runThreadN 10 \<br>--outFilterType BySJout \<br>--outFilterMismatchNmax 2 \<br>--outFilterMultimapNmax 1 \<br>--genomeDir $Ref_index \<br>--readFilesIn $Read \<br>--readFilesCommand zcat \<br>--outFileNamePrefix $&#123;id&#125;_ \<br>--outSAMtype BAM SortedByCoordinate \<br>--quantMode TranscriptomeSAM GeneCounts \<br>--outSAMattributes All \<br>--outSAMattrRGline ID:1 LB:ribo_seq PL:ILLUMINA SM:$&#123;id&#125; \<br>--outBAMcompression 6 \<br>--outReadsUnmapped Fastx<br>done<br>conda deactivate<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">sort</span> &amp; index</span><br>source activate chipseq<br>ls *.out.bam|while read id ;do (samtools sort -O bam  -T sorted -o $(basename $&#123;id&#125; &quot;.out.bam&quot;).sort.bam   $&#123;id&#125;);done<br><br>ls *.sort.bam | while read id ; do (samtools index $id); done<br>conda deactivate<br></code></pre></td></tr></table></figure><h6 id="3-2-CDS-reads-count"><a href="#3-2-CDS-reads-count" class="headerlink" title="3.2 CDS reads count"></a>3.2 CDS reads count</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">source activate rnaseq<br>featureCounts -T 16  -t CDS -g gene_id -a /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gtf  -o  Ribo.CDS_count.a.txt  ./*.bam<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="4-corresponding-RNA-Seq-data"><a href="#4-corresponding-RNA-Seq-data" class="headerlink" title="4. corresponding RNA-Seq data"></a>4. corresponding RNA-Seq data</h4><h6 id="4-1-mapping-to-genome"><a href="#4-1-mapping-to-genome" class="headerlink" title="4.1 mapping to genome"></a>4.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">source activate rnaseq<br>Ref_index=/data1/amliang/reference/index/bowtie2/flybase_m6_bowtie2/<br>Read_dir=/data1/amliang/projects/sxl_DC/2308_RiboSeq/240108_RNASeq_S2/data<br>Run_log=runlog.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">input/output file</span> <br>for id in &#123;P1_L2_UDI296,P2_L2_UDI297,P3_L2_UDI298,S4_L2_UDI299,S5_L2_UDI300,S6_L2_UDI301&#125;;<br>do<br>R1=$&#123;Read_dir&#125;/$&#123;id&#125;.R1.fastq.gz<br>R2=$&#123;Read_dir&#125;/$&#123;id&#125;.R2.fastq.gz<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Cycle Running</span><br>bowtie2  -p 18 -N 0 -x $Ref_index/fly -1 $R1 -2 $R2 -S $&#123;id&#125;.sam 2&gt;&gt;$Run_log <br> <br>done<br>conda deactivate<br></code></pre></td></tr></table></figure><h6 id="4-1-mapping-to-genome-1"><a href="#4-1-mapping-to-genome-1" class="headerlink" title="4.1 mapping to genome"></a>4.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">Note: reads_count <span class="hljs-keyword">for</span> CDS not exon</span><br><br>source activate rnaseq<br>featureCounts -T 16 -p -M -t CDS -g gene_id  -a /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gtf  -o  RNASeq.CDS_count.txt  ../*.bam<br>conda deactivate<br></code></pre></td></tr></table></figure><h4 id="5-differential-translation"><a href="#5-differential-translation" class="headerlink" title="5. differential translation"></a>5. differential translation</h4><h6 id="5-1-expr-count"><a href="#5-1-expr-count" class="headerlink" title="5.1 expr. count"></a>5.1 expr. count</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#Ribo</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/RiboSeq/featureCount_CDS_multi/&quot;</span><span class="hljs-punctuation">)</span><br>Ribo_count <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Ribo.CDS.multi_count.a.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>rownames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-operator">$</span>Geneid<br>colnames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;Geneid&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;End&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Length&quot;</span><span class="hljs-punctuation">,</span>                          <span class="hljs-string">&quot;WT_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;WT_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;WT_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_3&quot;</span><span class="hljs-punctuation">)</span><br>Ribo_exp <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>Ribo_exp <span class="hljs-operator">&lt;-</span> Ribo_exp<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># RNASeq</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/transla_by_Cyt.RNAseq/&quot;</span><span class="hljs-punctuation">)</span><br>RNA_count <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;RNASeq.CDS_count.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>rownames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-operator">$</span>Geneid<br>colnames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;Geneid&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;End&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Length&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_3&quot;</span><span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;C.wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_3&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_3&quot;</span><span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> RNA_exp<span class="hljs-punctuation">[</span>rownames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span> <span class="hljs-operator">%in%</span> rownames<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure><h6 id="5-2-PCA"><a href="#5-2-PCA" class="headerlink" title="5.2 PCA"></a>5.2 PCA</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#normalized - Ribo</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br>Ribo_exp_read.count <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">]</span><br>Ribo_exp_read.count <span class="hljs-operator">&lt;-</span> Ribo_exp_read.count<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>condition <span class="hljs-operator">&lt;-</span>factor<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                   levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>colData <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>row.names<span class="hljs-operator">=</span>colnames<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeqDataSetFromMatrix<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">,</span> colData<span class="hljs-punctuation">,</span> design<span class="hljs-operator">=</span> <span class="hljs-operator">~</span> condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeq<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">)</span><br>Ribo_normalized_counts <span class="hljs-operator">&lt;-</span> counts<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">,</span> normalized<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>Ribo_normalized_counts <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>Ribo_normalized_counts<span class="hljs-punctuation">)</span><br>Ribo_normalized_counts<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>Ribo_normalized_counts<span class="hljs-punctuation">)</span><br>Ribo_rpkm<span class="hljs-operator">&lt;-</span> Ribo_normalized_counts<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">7</span><span class="hljs-punctuation">]</span><br><br>library<span class="hljs-punctuation">(</span>FactoMineR<span class="hljs-punctuation">)</span><br>gene <span class="hljs-operator">&lt;-</span> t<span class="hljs-punctuation">(</span>Ribo_rpkm<span class="hljs-punctuation">)</span><br>gene.pca <span class="hljs-operator">&lt;-</span> PCA<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">,</span> ncp <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> scale.unit <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> graph <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>gene.pca<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># chose: WT_1,WT_3,SXL_1,SXL2</span><br><br><br><span class="hljs-comment">#normalized - RNAS</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br>RNA_exp_read.count <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>RNA_exp_read.count <span class="hljs-operator">&lt;-</span> RNA_exp_read.count<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>condition <span class="hljs-operator">&lt;-</span>factor<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                   levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>colData <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>row.names<span class="hljs-operator">=</span>colnames<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeqDataSetFromMatrix<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">,</span> colData<span class="hljs-punctuation">,</span> design<span class="hljs-operator">=</span> <span class="hljs-operator">~</span> condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeq<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">)</span><br>RNA_normalized_counts <span class="hljs-operator">&lt;-</span> counts<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">,</span> normalized<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>RNA_normalized_counts <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>RNA_normalized_counts<span class="hljs-punctuation">)</span><br>RNA_normalized_counts<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>RNA_normalized_counts<span class="hljs-punctuation">)</span><br>RNA_rpkm<span class="hljs-operator">&lt;-</span> RNA_normalized_counts<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">7</span><span class="hljs-punctuation">]</span><br><br>library<span class="hljs-punctuation">(</span>FactoMineR<span class="hljs-punctuation">)</span><br>gene <span class="hljs-operator">&lt;-</span> t<span class="hljs-punctuation">(</span>RNA_rpkm<span class="hljs-punctuation">)</span><br>gene.pca <span class="hljs-operator">&lt;-</span> PCA<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">,</span> ncp <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> scale.unit <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> graph <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>gene.pca<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># chose: WT_1,WT_2,SXL_2,SXL3</span><br></code></pre></td></tr></table></figure><h6 id="5-3-calculating-differential-translation-genes-by-riborex"><a href="#5-3-calculating-differential-translation-genes-by-riborex" class="headerlink" title="5.3 calculating differential translation genes by riborex"></a>5.3 calculating differential translation genes by riborex</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs R">Ribo_exp <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># riborex</span><br>library<span class="hljs-punctuation">(</span>fdrtool<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>riborex<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br><br>RNACntTable <span class="hljs-operator">&lt;-</span> RNA_exp<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>RiboCntTable <span class="hljs-operator">&lt;-</span> Ribo_exp<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>head<span class="hljs-punctuation">(</span>RNACntTable<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>RiboCntTable<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br><br>rnaCond <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">)</span><br>riboCond <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">)</span><br>res.deseq2 <span class="hljs-operator">&lt;-</span> riborex<span class="hljs-punctuation">(</span>RNACntTable<span class="hljs-punctuation">,</span> RiboCntTable<span class="hljs-punctuation">,</span> rnaCond<span class="hljs-punctuation">,</span> riboCond<span class="hljs-punctuation">,</span> engine <span class="hljs-operator">=</span> <span class="hljs-string">&quot;DESeq2&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br>hist<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-operator">$</span>pvalue<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;DESeq2 unadjusted p-values&#x27;</span><span class="hljs-punctuation">,</span> xlab<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Unadjusted p-values&#x27;</span><span class="hljs-punctuation">,</span><br>     col <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;#F4C7AB&#x27;</span><span class="hljs-punctuation">)</span><br><br>result <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-punctuation">)</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> result<span class="hljs-punctuation">[</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>result<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span><span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> result<span class="hljs-operator">$</span>padj<span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&gt;</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>tranla_diff<span class="hljs-punctuation">)</span><br>tranla_up <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_down <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220910_annotation/Drosaphila/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>rtracklayer<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>genome.anno <span class="hljs-operator">&lt;-</span> import<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;dmel-all-r6.44.gtf&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> as.data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>genome.anno<span class="hljs-operator">=</span>genome.anno<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;gene_id&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;seqnames&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;width&quot;</span><span class="hljs-punctuation">,</span><br>                           <span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>head<span class="hljs-punctuation">(</span>genome.anno<span class="hljs-punctuation">)</span><br>genome.anno <span class="hljs-operator">&lt;-</span> genome.anno<span class="hljs-punctuation">[</span>genome.anno<span class="hljs-operator">$</span>type<span class="hljs-operator">==</span><span class="hljs-string">&quot;gene&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>genome.anno<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;seqnames&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;length&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">)</span><br><br>result<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>result<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>result<span class="hljs-punctuation">,</span>genome.anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>Ribo_exp<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span>  rownames<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span>Ribo_exp<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>RNA_exp<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span>RNA_exp<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><br>T_diff <span class="hljs-operator">&lt;-</span> T_S2<span class="hljs-punctuation">[</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> T_S2<span class="hljs-operator">$</span>pvalue <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_diff <span class="hljs-operator">&lt;-</span> dplyr<span class="hljs-operator">::</span>filter<span class="hljs-punctuation">(</span>T_diff<span class="hljs-punctuation">,</span> <span class="hljs-operator">!</span><span class="hljs-built_in">is.na</span><span class="hljs-punctuation">(</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>T_test <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&lt;=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_diff <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&gt;</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_up <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_down <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-01-01å…ƒæ—¦ä¸œæ¹–éª‘è¡Œ</title>
    <link href="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/"/>
    <url>/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-01-01å…ƒæ—¦ä¸œæ¹–éª‘è¡Œ"><a href="#2025-01-01å…ƒæ—¦ä¸œæ¹–éª‘è¡Œ" class="headerlink" title="2025-01-01å…ƒæ—¦ä¸œæ¹–éª‘è¡Œ"></a>2025-01-01å…ƒæ—¦ä¸œæ¹–éª‘è¡Œ</h3><p>.</p><hr><p>å…ƒæ—¦ä¼‘å‡ï¼Œä¸œæ¹–éª‘è¡Œçº¦5å°æ—¶ï¼Œ73å…¬é‡Œã€‚</p><p>çœ‹äº†é£Žæ™¯ï¼Œæ™’äº†å¤ªé˜³ã€‚</p><p>.</p><p>ä¸Šåˆ9ç‚¹èµ·ï¼Œ10ç‚¹ä»Žæ°´ç”Ÿæ‰€é—¨å‡ºå‘ï¼Œèµ°åŒ»å­¦éƒ¨åŽ»æ¢¨å›­ç»¿é“å…¥å£ã€‚</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E5%AF%B9%E9%9D%A2%E6%98%AF%E5%8C%BB%E5%AD%A6%E9%83%A8.jpg" alt="20250101 å…ƒæ—¦ å¯¹é¢æ˜¯åŒ»å­¦éƒ¨"></p><p>.</p><p>ä¸€æ¡ä¸çŸ¥åå°è·¯ï¼Œé»„äº†çš„æŸ³æ ‘å¶æœ‰ç‚¹å¥½çœ‹ï¼Œæ²¡äººã€‚</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E6%B9%96%E5%B2%B8%E8%BE%B9%E9%BB%84%E4%BA%86%E7%9A%84%E6%9F%B3%E6%A0%91.jpg" alt="20250101 å…ƒæ—¦ æ¹–å²¸è¾¹é»„äº†çš„æŸ³æ ‘"></p><p>.</p><p>ä¸­åˆåˆ°äº†ä¹å³°ï¼Œéª‘å¾—å¾ˆæ…¢ã€‚</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E4%B8%AD%E5%8D%88%E5%88%B0%E8%BE%BE%E4%B9%9D%E5%B3%B0%E6%A1%A5.jpg" alt="20250101 å…ƒæ—¦ ä¸­åˆåˆ°è¾¾ä¹å³°æ¡¥"></p><p>.</p><p>ä¹å³°èœå¸‚åœºçš„è‚¥è‚ ç²‰ï¼Œå‘³é“ä¸é”™ï¼Œä¸‹æ¬¡è¿˜åŽ»ã€‚</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E4%B9%9D%E5%B3%B0%E8%8F%9C%E5%B8%82%E5%9C%BA%E9%99%84%E4%BB%B6%20%E8%82%A5%E8%82%A0%E7%B2%89.jpg" alt="20250101 å…ƒæ—¦ ä¹å³°èœå¸‚åœºé™„ä»¶ è‚¥è‚ ç²‰"></p><p>.</p><p>è·¯ä¸Šçš„ä¸€ç‰‡æ²¹èœåœ°ï¼Œæ˜Žå¹´æ˜¥å¤©å®ƒåº”è¯¥ä¼šå¾ˆå¥½çœ‹ã€‚</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E6%B2%B9%E8%8F%9C%E5%B9%BC%E8%8B%97.jpg" alt="20250101 å…ƒæ—¦ æ²¹èœå¹¼è‹—"></p><p>.</p><p>å¤•é˜³ï¼Œä¸€é“æ®‹é˜³é“ºæ°´ä¸­ã€‚</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E5%A4%95%E9%98%B3.jpg" alt="20250101 å…ƒæ—¦ å¤•é˜³"></p>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>GSEA in drosophila</title>
    <link href="/2024/12/31/GSEA%20in%20drosophila/"/>
    <url>/2024/12/31/GSEA%20in%20drosophila/</url>
    
    <content type="html"><![CDATA[<h3 id="GSEA-in-drosophila"><a href="#GSEA-in-drosophila" class="headerlink" title="GSEA in drosophila"></a>GSEA in drosophila</h3><p>.</p><p>This is a work log using R script to perform Gene Set Enrichment Analysis by differentialy expression genes in drosophila.</p><p>and this script also applies to other species, such as human and mouse.</p><p>human : org.Hs.eg.db</p><p>mouse : org.Mm.eg.db</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>library<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>clusterProfiler<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>DOSE<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>topGO<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>pathview<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>KEGG.db<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>enrichplot<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># RNA-Seq data</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240506&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>expr_gene <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;DEGs_240506.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;new.diff_gene_all_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># transfer ENSEMBL into ENTREZID</span><br>geneList<span class="hljs-operator">&lt;-</span>expr_gene<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log2FoldChange&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>eg <span class="hljs-operator">&lt;-</span> bitr<span class="hljs-punctuation">(</span>geneList<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span> <br>           fromType<span class="hljs-operator">=</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span> <br>           toType<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ENTREZID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;SYMBOL&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>           OrgDb<span class="hljs-operator">=</span><span class="hljs-string">&quot;org.Dm.eg.db&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>eg<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># sorted by log2FC</span><br>input_data <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>eg<span class="hljs-punctuation">,</span>geneList<span class="hljs-punctuation">,</span>by.x<span class="hljs-operator">=</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span>by.y<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">)</span><br>input_data_sort <span class="hljs-operator">&lt;-</span> input_data<span class="hljs-punctuation">[</span>order<span class="hljs-punctuation">(</span>input_data<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">,</span> decreasing <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>gene_fc <span class="hljs-operator">=</span> input_data_sort<span class="hljs-operator">$</span>log2FoldChange<br><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>gene_fc<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> input_data_sort<span class="hljs-operator">$</span>ENTREZID<br>head<span class="hljs-punctuation">(</span>gene_fc<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># gseGO</span><br>GO <span class="hljs-operator">&lt;-</span> gseGO<span class="hljs-punctuation">(</span><br>  gene_fc<span class="hljs-punctuation">,</span> <span class="hljs-comment">#gene_fc</span><br>  ont <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ALL&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># &quot;BP&quot;,&quot;MF&quot;,&quot;CC&quot; or &quot;ALL&quot;</span><br>  OrgDb <span class="hljs-operator">=</span> org.Dm.eg.db<span class="hljs-punctuation">,</span><br>  keyType <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ENTREZID&quot;</span><span class="hljs-punctuation">,</span><br>  pvalueCutoff <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>  pAdjustMethod <span class="hljs-operator">=</span> <span class="hljs-string">&quot;BH&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>go_terms <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># diaw plot</span><br><span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>file.exists<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  dir.create<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br>  setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>  setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;sex_differentiation.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">7.2</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">600</span><span class="hljs-punctuation">)</span><br>gseaplot2<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;GO:0007548&quot;</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;firebrick&quot;</span><span class="hljs-punctuation">,</span> <br>          title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;sex differentiation&quot;</span><span class="hljs-punctuation">,</span><br>          rel_heights<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>output files :</p><p>I chose to show a term about sex determination pathway:</p><p><img src="/2024/12/31/GSEA%20in%20drosophila/Terms.png" alt="Terms"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Tæ£€éªŒåœ¨excelä¸­çš„ä½¿ç”¨</title>
    <link href="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="Tæ£€éªŒåœ¨excelä¸­çš„ä½¿ç”¨"><a href="#Tæ£€éªŒåœ¨excelä¸­çš„ä½¿ç”¨" class="headerlink" title="Tæ£€éªŒåœ¨excelä¸­çš„ä½¿ç”¨"></a>Tæ£€éªŒåœ¨excelä¸­çš„ä½¿ç”¨</h3><p>.</p><p>åœ¨Excelä¸­å¯¹ä¸¤ç»„æ•°æ®åšå·®å¼‚æ˜¾è‘—æ€§æ£€éªŒæ˜¯æˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°çš„æ–¹æ³•ï¼Œå¤šæ•°ä½¿ç”¨è€…éƒ½ç†è§£å¹¶ç†Ÿç»ƒå…¶åŽŸç†å’Œä½¿ç”¨æ–¹æ³•çš„ï¼Œä½†å¯èƒ½ä¹Ÿæœ‰å°‘æ•°äººï¼Œå°½ç®¡ä¼šç”¨å„ç§è½¯ä»¶æ¥åšå·®å¼‚æ€§æ£€éªŒï¼Œä½†å¯¹å…¶èƒŒåŽçš„æ•°ç†å¹¶ä¸å®Œå…¨æ¸…æ¥šï¼Œæ¯”å¦‚è¯´æˆ‘è‡ªå·±ã€‚å‰æ®µå‡ å¤©æœ‰äººé—®åˆ°æˆ‘ï¼Œæˆ‘æ”¯æ”¯å¾å¾ç»™è®²äº†ä¸ªå¤§æ¦‚ï¼Œå‘çŽ°è‡ªå·±å¥½å¤šç»†èŠ‚å¹¶ä¸æ¸…æ¥šï¼ŒåŽæ¥ç»è¿‡æœç´¢æ–‡ç« åŽï¼Œæˆ‘æ‰å¤§è‡´æœ‰ä¸€ä¸ªç›¸å¯¹æ¸…æ™°çš„è®¤è¯†ï¼ŒçŽ°åœ¨æˆ‘æŠŠå®ƒå†™ä¸‹æ¥ï¼Œä»¥ä¾›è¯¸å›å‚è€ƒã€‚</p><p>å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒæ˜¯ç»Ÿè®¡å‡è®¾æ£€éªŒçš„ä¸€ç§ï¼Œç”¨äºŽæ¯”è¾ƒä¸¤ç»„æˆ–å¤šç»„æ•°æ®ä¹‹é—´çš„å·®å¼‚æ˜¯å¦æ˜¾è‘—ã€‚å®ƒæœ‰å¥½å‡ ç§ç±»åž‹ï¼ŒåŒ…æ‹¬tæ£€éªŒï¼Œuæ£€éªŒï¼Œå¡æ–¹æ£€éªŒä»¥åŠæ–¹å·®åˆ†æžç­‰ï¼Œæˆ‘ä»¬è¿™é‡Œåªè®¨è®ºtæ£€éªŒã€‚</p><p>ä½†åœ¨è®²è¿°tæ£€éªŒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸­å¿ƒæžé™å®šç†ï¼Œå°æ¦‚çŽ‡äº‹ä»¶ç­‰æ¦‚å¿µåšä¸€ä¸ªç®€å•çš„å›žé¡¾å¤ä¹ ï¼Œè¿™ä¼šæ›´å¥½åœ°å¸®åŠ©æˆ‘ä»¬ç†è§£å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒèƒŒåŽçš„é€»è¾‘ã€‚</p><h5 id="ä¸­å¿ƒæžé™å®šç†"><a href="#ä¸­å¿ƒæžé™å®šç†" class="headerlink" title="ä¸­å¿ƒæžé™å®šç†"></a>ä¸­å¿ƒæžé™å®šç†</h5><p>ä»€ä¹ˆæ˜¯ä¸­å¿ƒæžé™å®šç†ï¼Œä¸­å¿ƒæžé™å®šç†æŒ‡çš„æ˜¯åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œç‹¬ç«‹éšæœºå˜é‡çš„æœŸæœ›éšç€æ ·æœ¬é‡çš„å¢žå¤§ä¼šè¶‹å‘äºŽæ­£æ€åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„ç´¯è®¡åˆ†å¸ƒå‡½æ•°ä¼šæ”¶æ•›äºŽæ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚</p><p>æ¢å¥è¯è¯´ï¼Œ<strong>ä¸ç®¡æ€»ä½“æ ·æœ¬æ˜¯ä»€ä¹ˆåˆ†å¸ƒï¼Œå½“æ ·æˆ‘ä»¬ä»»æ„ä»Žæ€»ä½“æ ·æœ¬ä¸­æŠ½å–è¶³å¤Ÿå¤§çš„æ ·æœ¬æ—¶ï¼Œè¿™äº›è¢«æŠ½æ ·çš„æ ·æœ¬å‡å€¼éƒ½ä¼šå›´ç»•åœ¨æ€»ä½“æ ·æœ¬çš„å‡å€¼å‘¨å›´ï¼Œå¹¶ä¸”å‘ˆæ­£æ€åˆ†å¸ƒã€‚</strong></p><p>å¦‚æžœå†å…·ä½“ä¸€ç‚¹è¯´ï¼Œå°±æ˜¯å¯¹æŸä¸€ä¸ªæ€»ä½“æ ·å“æ•°æ®ä¸­è¿›è¡Œæ”¾å›žéšæœºæŠ½æ ·ï¼Œæ¯æ¬¡æŠ½å–æ ·æœ¬æ•°é‡ä¸ºnï¼ŒæŠ½äº†kæ¬¡ï¼Œåˆ™æ¯æ¬¡æŠ½æ ·å¾—åˆ°çš„å‡å€¼æ˜¯m1ï¼Œm2ï¼Œm3ï¼Œâ€¦â€¦ï¼Œmkã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¼šå‘çŽ°ï¼Œè¿™äº›æŠ½æ ·æ ·æœ¬çš„å‡å€¼ï¼ˆå³m1ï¼Œm2ï¼Œm3ï¼Œâ€¦â€¦ï¼Œmkï¼‰æ˜¯æ»¡è¶³æ­£æ€åˆ†å¸ƒçš„ï¼Œè¿™å°±æ˜¯ä¸­å¿ƒæžé™å®šç†ã€‚</p><p>ä¸­å¿ƒæžé™å®šç†ä¸è¦æ±‚éšæœºå˜é‡æœ¬èº«æ˜¯æ­£æ€åˆ†å¸ƒçš„ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“æŽ¨æµ‹ï¼Œå½“åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¯¹æ­£æ€åˆ†å¸ƒæˆç«‹çš„æ–¹æ³•åŽ»åº”å¯¹éžæ­£æ€åˆ†å¸ƒã€‚æ¯”å¦‚ï¼Œå¯¹æ ·æœ¬é‡nè¶³å¤Ÿå¤§çš„æ—¶å€™ï¼ŒäºŒé¡¹åˆ†å¸ƒ Bin(<em>n, p</em>) å¯ä»¥ç”¨æ­£æ€åˆ†å¸ƒN(<em>np</em>, <em>np</em>(<em>1-p</em>))æ¥è¿‘ä¼¼ç­‰ç­‰ã€‚</p><h5 id="å°æ¦‚çŽ‡äº‹ä»¶"><a href="#å°æ¦‚çŽ‡äº‹ä»¶" class="headerlink" title="å°æ¦‚çŽ‡äº‹ä»¶"></a>å°æ¦‚çŽ‡äº‹ä»¶</h5><p>å°æ¦‚çŽ‡äº‹ä»¶å³æ˜¯æŒ‡å‘ç”Ÿæ¦‚çŽ‡æžå°çš„äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å‡è®¾æ£€éªŒçš„æ€æƒ³ä¸­ï¼Œ<strong>å°æ¦‚çŽ‡äº‹ä»¶åœ¨æŸä¸€æ¬¡è¯•éªŒä¸­åŸºæœ¬ä¸Šæ˜¯ä¸ä¼šå‘ç”Ÿçš„ï¼Œå¦‚æžœå‘ç”Ÿäº†ï¼Œåˆ™è¯´æ˜Žè¯¥å®žéªŒçš„åŽŸå‡è®¾å‡ºäº†é—®é¢˜ï¼Œåˆ™åº”è¯¥æ‹’ç»åŽŸå‡è®¾</strong>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå°±è¯´æŠ›ç¡¬å¸çš„é—®é¢˜å§ã€‚å¯¹äºŽä¸€ä¸ªæ­£å¸¸çš„æŠ›ç¡¬å¸äº‹ä»¶ï¼Œæˆ‘ä»¬çŸ¥é“å…¶å‡ºçŽ°æ­£åä¸¤é¢çš„æ¦‚çŽ‡å„æ˜¯50%ï¼Œå‡è®¾ä½ è·ŸåŒå­¦çŽ©æŠ›ç¡¬å¸çŒœæ­£åé¢çš„æ¸¸æˆï¼Œç»“æžœ10æ¬¡ä¸‹æ¥ï¼Œä½ ä¸€æ¬¡éƒ½æ²¡èµ¢è¿‡ã€‚è¿™ä¸ªæ—¶å€™èªæ˜Žçš„ä½ ä¸€å®šå¼€å§‹æ€€ç–‘è¿™æžšç¡¬å¸æ˜¯ä¸æ˜¯æœ‰é—®é¢˜ï¼Œå¹¶ä¸”ä½ ç”¨ä¸‹é¢è¿™ä¸€æ®µè¯æ®ç‹ ç‹ æ‰“è„¸äº†ä¸€ä¸‹è¿™ä¸ªåŒå­¦ï¼š<br>    å‡è®¾æ£€éªŒéªŒè¯è¯¥ç¡¬å¸æ˜¯å¦æ˜¯è´¨åœ°å‡åŒ€çš„æ­£å¸¸ç¡¬å¸</p><p>â€‹H0ï¼šé›¶å‡è®¾è¯¥ç¡¬å¸æ˜¯è´¨åœ°å‡åŒ€çš„æ­£å¸¸ç¡¬å¸ ï¼ˆå‡ºçŽ°æ­£åé¢çš„æ¦‚çŽ‡å‡ä¸º50%ï¼‰<br>â€‹H1ï¼šè¯¥ç¡¬å¸ä¸æ˜¯è´¨åœ°å‡åŒ€çš„æ­£å¸¸ç¡¬å¸</p><p>å‡è®¾H0æˆç«‹ï¼Œåˆ™æ¯æ¬¡æŠ›å‡ºç¡¬å¸å‡ºçŽ°æ­£åé¢çš„æ¦‚çŽ‡å‡ä¸º0.5ï¼Œé‚£ä¹ˆæŠ›10æ¬¡ç¡¬å¸ï¼Œå‡å‡ºçŽ°æ­£é¢çš„æ¦‚çŽ‡ä¸º 0.5^10 &#x3D; 0.00098ï¼Œè¯¥æ¦‚çŽ‡éžå¸¸å°ï¼Œå±žäºŽå°æ¦‚çŽ‡äº‹ä»¶ï¼ŒåŸºæœ¬ä¸å¯èƒ½å‡ºçŽ°ï¼Œå¦‚æžœå‡ºçŽ°äº†ï¼Œåˆ™è¯´æ˜Žé›¶å‡è®¾H0ä¸æ­£ç¡®ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ®æ­¤å¦å®šé›¶å‡è®¾H0ï¼Œå³â€œç¡¬å¸æ˜¯è´¨åœ°å‡åŒ€çš„æ­£å¸¸ç¡¬å¸â€è¿™ä¸€å‡è®¾ä¸èƒ½æˆç«‹ï¼Œæ•…è€ŒH1æˆç«‹ï¼Œç¡¬å¸ä¸æ˜¯æ­£å¸¸ç¡¬å¸ã€‚</p><p>ä»Žä¸Šè¿°å°ä¾‹å­å¯ä»¥çœ‹å‡ºå°æ¦‚çŽ‡äº‹ä»¶çš„æ•°å­¦æ€æƒ³å…¶å®žå°±æ˜¯ç”¨åè¯æ³•è¿›è¡Œå‡è®¾æ£€éªŒã€‚</p><h5 id="å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒ"><a href="#å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒ" class="headerlink" title="å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒ"></a>å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒ</h5><p>é‚£ä¸­å¿ƒæžé™å®šç†å’Œå°æ¦‚çŽ‡äº‹ä»¶ç­‰åˆä¸Žæˆ‘ä»¬ä»Šå¤©è¦è®¨è®ºçš„å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p><p>å› ä¸ºå‡è®¾æ£€éªŒï¼ˆæ¯”å¦‚tæ£€éªŒã€zæ£€éªŒç­‰ï¼‰æ˜¯åŸºäºŽæ­£æ€åˆ†å¸ƒçš„ä¸€ç±»ç»Ÿè®¡æ–¹æ³•ï¼Œå…¶è¦æ±‚æ ·æœ¬æ•°æ®è¦ç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚è€Œä¸­å¿ƒæžé™å®šç†åˆ™ä¸ºæˆ‘ä»¬æä¾›äº†ç†è®ºåŸºç¡€ï¼Œå³æ ¹æ®ä¸­å¿ƒæžé™å®šç†ï¼Œæ— è®ºåŽŸå§‹æ•°æ®æ˜¯å¦ä¸ºæ­£æ€åˆ†å¸ƒï¼Œåªè¦æ ·æœ¬å®¹é‡è¶³å¤Ÿå¤§ï¼ŒæŠ½æ ·æ ·æœ¬çš„å‡å€¼åˆ†å¸ƒå°±ä¼šæŽ¥è¿‘æ­£æ€åˆ†å¸ƒã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹ä¸æ˜¯æ­£æ€åˆ†å¸ƒçš„æ•°æ®è¿›è¡Œå·®å¼‚æ˜¾è‘—æ€§æ£€éªŒï¼ˆå‡è®¾æ£€éªŒï¼‰äº†ã€‚</p><p>å¹¶ä¸”ï¼Œä¸­å¿ƒæžé™å®šç†è¿˜å¸®åŠ©æˆ‘ä»¬ç†è§£å¦‚ä½•å°†æ ·æœ¬å‡å€¼è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæˆä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼ˆzå€¼ï¼‰ï¼Œä»Žè€Œå¯ä»¥è®¡ç®—på€¼ï¼ˆpå€¼çš„è®¡ç®—è¿‡ç¨‹æ˜¯åŸºäºŽæ­£æ€åˆ†å¸ƒçš„å‡è®¾ï¼Œè¿™ä¸€éƒ¨åˆ†å¦‚æžœéœ€è¦ï¼Œå°†æ¥ä¼šå¦å†™ä¸€æ–‡è¯¦ç»†è¯´æ˜Žï¼‰ã€‚</p><p>åœ¨å‡è®¾æ£€éªŒä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¾ˆå…³å¿ƒåœ¨é›¶å‡è®¾H0ä¸‹ä¼šæ˜¯å¦ä¼šå‡ºçŽ°æžç«¯ç»“æžœï¼Œå³å°æ¦‚çŽ‡äº‹ä»¶ã€‚è€Œå‰é¢çš„på€¼ï¼Œåˆ™åæ˜ äº†åœ¨é›¶å‡è®¾æˆç«‹çš„å‰æä¸‹ï¼Œè§‚å¯Ÿåˆ°å½“å‰æˆ–è€…æ›´æžç«¯ç»“æžœçš„æ¦‚çŽ‡ï¼Œpå€¼è¶Šå°ï¼Œè¯´æ˜Žè§‚å¯Ÿåˆ°çš„ç»“æžœè¶Šä¸å¯èƒ½åœ¨é›¶å‡è®¾æˆç«‹çš„æ¡ä»¶ä¸‹å‘ç”Ÿï¼Œè¿›è€Œå°±è¶Šå……åˆ†åœ°æ‹’ç»é›¶å‡è®¾ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£åˆ°ï¼Œå½“på€¼è¶³å¤Ÿå°çš„æ—¶å€™ï¼Œå‘ç”Ÿçš„äº‹ä»¶å°±å¯ä»¥è®¤ä¸ºæ˜¯å°æ¦‚çŽ‡äº‹ä»¶ï¼ˆå¦‚å›¾1æ‰€ç¤ºï¼‰ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥è®¾å®šä¸€ä¸ªæ˜¾è‘—æ€§æ°´å¹³ï¼ˆæ¯”å¦‚0.05ï¼‰ï¼Œå¦‚æžœæˆ‘ä»¬è§‚å¯Ÿåˆ°çš„ç»“æžœçš„på€¼å°äºŽè®¾å®šçš„æ˜¾è‘—æ€§æ°´å¹³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ‹’ç»é›¶å‡è®¾ï¼ˆä¾‹å¦‚ï¼Œåœ¨å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒä¸­ï¼Œæˆ‘ä»¬çš„é›¶å‡è®¾ä¸€èˆ¬æ˜¯æ ·æœ¬ä¹‹é—´æ²¡æœ‰å·®å¼‚ï¼‰ã€‚</p><p>åœ¨å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒä¸­ï¼Œåˆ¤æ–­å·®å¼‚æ˜¯å¦æ˜¾è‘—çš„æ ‡å‡†ï¼Œå°±æ˜¯çœ‹å·®å¼‚æ˜¯å¦å±žäºŽå°æ¦‚çŽ‡äº‹ä»¶ï¼Œå¦‚æžœå·®å¼‚å‡ºçŽ°çš„æ¦‚çŽ‡éžå¸¸ä½Žï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºè¿™ä¸ªå·®å¼‚ä¸æ˜¯å¶ç„¶çš„ï¼Œè€Œæ˜¯æœ‰ä¸€å®šçš„ç»Ÿè®¡å­¦æ„ä¹‰ã€‚</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83.png" alt="æ¦‚çŽ‡åˆ†å¸ƒ"></p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šæ¸…æ¥šäº†å·®å¼‚æ˜¾è‘—æ€§æ£€éªŒèƒŒåŽçš„æ¦‚çŽ‡åŽŸç†äº†ï¼Œå‰é¢æˆ‘ä»¬å·²ç»è¯´è¿‡ï¼Œå·®å¼‚æ˜¾è‘—æ€§æ£€éªŒåŒ…æ‹¬äº†å¥½å‡ ç§æ£€éªŒæ–¹æ³•ï¼ŒåŒ…æ‹¬tæ£€éªŒï¼Œuæ£€éªŒï¼Œå¡æ–¹æ£€éªŒå’Œæ–¹å·®åˆ†æžç­‰å¤šç§æ–¹æ³•ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬åªè®¨è®ºæœ€å¸¸ç”¨çš„tæ£€éªŒï¼ˆt-testï¼‰ã€‚</p><h5 id="tæ£€éªŒ"><a href="#tæ£€éªŒ" class="headerlink" title="tæ£€éªŒ"></a>tæ£€éªŒ</h5><p>tæ£€éªŒåˆå«student æ£€éªŒï¼ˆå­¦ç”Ÿæ£€éªŒï¼‰ï¼Œæœ€æ—©æ˜¯æ¬§æ´²ä¸€ä¸ªé…’åŽ‚çš„è´¨é‡æ£€æµ‹å‘˜ï¼Œä¸ºäº†è§‚æµ‹é…¿é…’å“è´¨æå‡ºæ¥çš„ç»Ÿè®¡å‡è¯´æ£€éªŒï¼Œå½“æ—¶é…’åŽ‚ä¸è®©éšä¾¿å…¬å¼€å‘è¡¨æ–‡ç« ï¼Œè¿™ä½å…ˆç”Ÿå°±ç”¨äº† â€œstudentâ€ è¿™æ ·ä¸€ä¸ªåŒ–åå‘è¡¨äº†ï¼Œæ‰€ä»¥åŽæ¥å°±åˆå«student testäº†ï¼Œè¿™ä¸ªæ•…äº‹åœ¨ã€Šå¥³å£«å“èŒ¶ã€‹é‡Œæœ‰è¯¦ç»†ä»‹ç»ã€‚</p><p>tæ£€éªŒä¸»è¦ç”¨äºŽæ ·æœ¬å«é‡è¾ƒå°ï¼ˆæ¯”å¦‚å½“æ ·æœ¬é‡n &lt; 30ï¼›å¦‚æžœæ ·æœ¬é‡&gt;&#x3D;30ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ›´å€¾å‘äºŽç”¨zæ£€éªŒï¼‰çš„å·®å¼‚æ£€éªŒã€‚</p><p>å—¯ï¼Ÿå‰é¢ä¸æ˜¯è¯´ï¼Œå½“æ ·æœ¬é‡è¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œä»Žä»»æ„æ€»ä½“ä¸­çš„æŠ½æ ·æ ·æœ¬å‡å€¼çš„åˆ†å¸ƒä¼šè¿‘ä¼¼æ­£æ€åˆ†å¸ƒï¼ˆä¸­å¿ƒæžé™å®šç†ï¼‰ï¼Œé‚£è¦æ˜¯æ ·æœ¬é‡ä¸å¤Ÿå¤§å‘¢ï¼Ÿ</p><p>å¦‚æžœä½ å¯¹æ¦‚çŽ‡åˆ†å¸ƒæœ‰ä¸€äº›äº†è§£çš„è¯ï¼Œä½ å°±ä¼šçŸ¥é“ï¼Œå¯¹äºŽå°æ ·æœ¬é‡çš„æ¥è¯´ï¼Œå…¶å‡å€¼å‘ˆçŽ°çš„åˆ†å¸ƒå«tåˆ†å¸ƒï¼Œå…¶è‡ªç”±åº¦ä¸º<em>df</em> &#x3D; <em>n - 1</em>ã€‚tåˆ†å¸ƒçš„å½¢çŠ¶ä¸Žæ­£æ€åˆ†å¸ƒç›¸ä¼¼ï¼Œå…¶æ›²çº¿å½¢æ€éšè‡ªç”±åº¦dfè€Œæ”¹å˜ï¼Œdfè¶Šå¤§ï¼Œåˆ™tåˆ†å¸ƒæ›²çº¿å°±è¶Šè¿‘ä¼¼æ­£æ€åˆ†å¸ƒï¼Œå½“è‡ªç”±åº¦dfä¸ºæ— ç©·å¤§æ—¶ï¼Œtåˆ†å¸ƒæ›²çº¿å³ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚</p><hr><p>å¥½ï¼Œé‚£æŽ¥ä¸‹æ¥æˆ‘ä»¬å…·ä½“è®¨è®ºä¸€ä¸‹æœ€å¸¸è§çš„tæ£€éªŒåœ¨æœ€å¸¸ç”¨çš„excelä¸­çš„ä½¿ç”¨ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬çŽ°åœ¨æƒ³è¦çœ‹ä¸€ä¸‹ä¸¤ç»„æ•°æ®æ˜¯ä¸æ˜¯æœ‰å·®å¼‚ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/input_data%201.png" alt="input_data 1"></p><p>æˆ‘ä»¬ä½¿ç”¨excelä¸­è‡ªå¸¦çš„tæ£€éªŒå‡½æ•°t.test()æ¥æ£€æµ‹ä¸¤ç»„æ•°æ®æ˜¯å¦æœ‰å·®å¼‚ã€‚Array1è¾“å…¥controlè¿™ç»„æ•°æ®ï¼ŒArray2è¾“å…¥treatè¿™ç»„æ•°æ®ï¼Œå‰é¢è¿™äº›æ•°æ®è¾“å…¥æ²¡å•¥å¥½è¯´çš„ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŽ¥ä¸‹æ¥çš„Tailé€‰é¡¹å¦‚ä½•é€‰ï¼Ÿï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/Tails.png" alt="Tails"></p><p>è¿™éœ€è¦æ ¹æ®ä½ çš„æ•°æ®ç±»åž‹å’Œåº”ç”¨åœºæ™¯æ¥è®¾å®šï¼Œåœ¨t.test()ä¸­ï¼Œä¸€èˆ¬åˆ†ä¸º â€˜å•å°¾â€™ å’Œ â€˜åŒå°¾â€™ ã€‚</p><p>å•å°¾æ£€éªŒå’ŒåŒå°¾æ£€éªŒéƒ½æ˜¯æ£€éªŒç»Ÿè®¡æ˜¾è‘—æ€§çš„æ–¹æ³•ï¼ŒåŒºåˆ«åœ¨äºŽï¼Œå•å°¾æ£€éªŒåªæ£€éªŒä¸€ä¸ªæ–¹å‘çš„æ˜¾è‘—æ€§ï¼Œè€ŒåŒå°¾æ£€éªŒåˆ™æ£€éªŒä¸¤ä¸ªæ–¹å‘çš„æ˜¾è‘—æ€§ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼ŒåŽ»å¹´ä½ å¯¹ä¸€ä¸ªå…¨ç¤¾åŒºçš„10å²ä»¥ä¸‹å°å­©èº«é«˜è¿›è¡Œäº†æµ‹é‡ï¼Œä¸€å¹´åŽçš„ä»Šå¹´ï¼Œä½ åˆå¯¹è¿™æ‰¹å°å­©çš„èº«é«˜åšäº†æµ‹é‡ï¼Œå› ä¸ºå°å­©çš„èº«é«˜åªæœ‰ä¸¤ç§å¯èƒ½ï¼Œè¦ä¹ˆå°±ä»Šå¹´çš„æ¯”åŽ»å¹´çš„æ˜¾è‘—å¢žé«˜äº†ï¼Œè¦ä¹ˆå°±æ˜¯å˜åŒ–ä¸æ˜¾è‘—ï¼Œä¸å¯èƒ½å‡ºçŽ°æ¯”åŽ»å¹´çš„è¿˜æ˜¾è‘—é™ä½Žçš„æƒ…å†µï¼Œå³èº«é«˜å˜åŒ–åªèƒ½æ˜¯å•å‘çš„ã€‚é‚£åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨å•ä½æ£€éªŒäº†ã€‚</p><p>ä½†å¦‚æžœä½ æµ‹é‡çš„æ˜¯ä¸¤ä¸ªä¸åŒç¤¾åŒº (ç¤¾åŒºAå’Œç¤¾åŒºB) çš„å°å­©èº«é«˜ï¼Œè¿™æ—¶å€™ï¼Œä½ ä¸ç¡®å®šAæ˜¯ä¸æ˜¯ä¸€å®šå°±æ¯”Bé«˜ï¼Œè¿˜æ˜¯Bæ¯”Aé«˜ï¼Œå³å…¶æ˜¾è‘—å˜åŒ–çš„æ–¹å‘æ˜¯åŒæ–¹å‘çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå°±ä½¿ç”¨åŒå°¾æ£€éªŒã€‚</p><p>æˆ‘è¿™é‡Œæä¾›çš„æ•°æ®ï¼Œæ˜¯å­˜åœ¨åŒå‘å˜åŒ–å¯èƒ½çš„ï¼Œæ‰€ä»¥é€‰æ‹©çš„æ˜¯åŒå°¾æ£€éªŒã€‚</p><p>è®¾å®šå¥½äº†Tailä¹‹åŽï¼Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªtypeéœ€è¦é€‰æ‹©ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰</p><p>è¿™é‡Œçš„typeé€šå¸¸åˆ†ä¸º3ä¸­ç±»åž‹ï¼Œå³æˆå¯¹æ£€éªŒï¼ŒåŒæ ·æœ¬ç­‰æ–¹å·®å‡è®¾å’ŒåŒæ ·æœ¬å¼‚æ–¹å·®æ£€éªŒã€‚</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/Type.png" alt="Type"></p><p>æˆ‘ä»¬å…ˆæ¥çœ‹æˆå¯¹æ£€éªŒï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„é…å¯¹æ ·æœ¬tæ£€éªŒã€‚é‚£ä»€ä¹ˆæƒ…å†µä¸‹é€‰ç”¨é…å¯¹æ ·æœ¬æ£€éªŒå‘¢ï¼Œ</p><p>å…¶å®žè¿™é‡Œçš„é…å¯¹æ ·æœ¬tæ£€éªŒï¼Œæ˜¯ä¸Žç‹¬ç«‹æ ·æœ¬tæ£€éªŒæ˜¯ç›¸å¯¹åº”çš„ï¼Œçœ‹åå­—ï¼Œæˆ‘ä»¬å°±å¤§æ¦‚èƒ½çŸ¥é“å„è‡ªæ˜¯å¹²å˜›çš„äº†ã€‚è¿˜æ˜¯å•°å—¦ä¸€ç‚¹ï¼Œæ€»ç»“ä¸€ä¸‹å§ï¼šé…å¯¹æ ·æœ¬æ£€éªŒä¸€èˆ¬é’ˆå¯¹çš„æ˜¯ï¼Œè§‚å¯Ÿå˜é‡ä¸ºè¿žç»­å˜é‡ï¼Œå¹¶ä¸”ä¸¤ç»„å˜é‡æ˜¯é…å¯¹è®¾è®¡çš„ï¼Œä¸¤ç»„å˜é‡æ˜¯ç›¸å…³çš„ç­‰ï¼Œè€Œç‹¬ç«‹æ ·æœ¬tæ£€éªŒï¼Œåˆ™é¡¾åæ€ä¹‰å°±æ˜¯ä¸¤ç»„æ ·æœ¬æ˜¯ç‹¬ç«‹çš„ã€‚</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/input_data%202.png" alt="input_data 2"></p><p>è¿˜æ˜¯å‰é¢é‚£ç»„æ•°æ®ï¼Œå¦‚æžœæˆ‘ä»¬ç»™æ¯ä¸ªæ•°æ®è®¾å®šä¸ºå…·ä½“çš„æŸä¸€ä¸ªäººï¼Œå°±æ¯”å¦‚è¿™æ˜¯å¿ƒè„ç“£è†œæ‰‹æœ¯åŽçš„ä¸€ç»„ç—…äººï¼Œåœ¨å¯¹å…¶æœç”¨åŽæ³•æž—ä¹‹å‰å’Œè¿žç»­æœç”¨ä¸€å‘¨åŽçš„å‡è¡€å€¼è¿›è¡Œtæ£€éªŒï¼Œè¿™ä¸ªæ—¶å€™åˆ™è¦ç”¨é…å¯¹æ ·æœ¬tæ£€éªŒã€‚</p><p>è€Œå¦‚æžœåªæ˜¯éšæœºåœ¨åŒ»é™¢æŒ‘é€‰äº†ä¸¤ç»„ï¼Œæœç”¨äº†åŽæ³•æž—çš„æœ¯åŽç—…äººå’Œæ²¡æœ‰æœç”¨åŽæ³•æž—çš„æœ¯åŽç—…äººï¼Œå°±æ˜¯è¿™äº›ç—…äººï¼Œä¸¤æ‰¹äººï¼Œè¿™ä¸ªæ—¶å€™åˆ™ç”¨ç‹¬ç«‹æ ·æœ¬tæ£€éªŒã€‚</p><p>æŽ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥çœ‹ï¼Œä»€ä¹ˆæ—¶å€™ç”¨ç­‰æ–¹å·®æ£€éªŒï¼Œä»€ä¹ˆæ—¶å€™ç”¨å¼‚æ–¹å·®æ£€éªŒï¼Ÿ</p><p>æœ¬è´¨ä¸Šï¼Œå…¶å®žæ˜¯åœ¨æ¯”è¾ƒä¸¤ç»„ç‹¬ç«‹æ ·æœ¬å‡å€¼æ—¶ï¼Œå¯¹äºŽè¿™ä¸¤ç»„æ ·æœ¬çš„æ–¹å·®æ˜¯å¦ç›¸ç­‰çš„å‡è®¾ã€‚é€‰æ‹©å“ªç§å‡è®¾å–å†³äºŽä½ å¯¹æ•°æ®çš„äº†è§£ï¼Œæˆ–è€…ä½ å¯¹æ•°æ®æ˜¯å¦æ»¡è¶³æ–¹å·®é½æ€§ï¼ˆç­‰æ–¹å·®ï¼‰å‡è®¾çš„æ£€éªŒã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå½“ä½ çŸ¥é“æˆ–è®¤ä¸ºä¸¤ä¸ªæ ·æœ¬çš„æ–¹å·®å·®å¼‚ä¸å¤§æ—¶ï¼Œå°±ä½¿ç”¨ç­‰æ–¹å·®æ£€éªŒï¼›è€Œå½“ä½ é€šè¿‡ç­‰æ–¹å·®æ£€éªŒï¼ˆæ¯”å¦‚ Levene æ£€éªŒï¼‰å‘çŽ°ä¸¤ä¸ªæ ·æœ¬çš„æ–¹å·®æ˜¾è‘—ä¸åŒï¼Œæˆ–è€…ä½ æœ¬æ¥å°±çŸ¥é“æ ·æœ¬æ¥æºå¯èƒ½å…·æœ‰ä¸åŒçš„æ–¹å·®æ—¶ï¼Œè¿™ä¸ªæ—¶å€™å°±å¾—ä½¿ç”¨å¼‚æ–¹å·®æ£€éªŒã€‚</p><p>ä½†ä¸ºäº†å‡ä½Žéº»çƒ¦ï¼Œæˆ‘åœ¨å¤„ç†è¿™ç±»æ•°æ®å‰ï¼Œä¸€èˆ¬ä¸åšæ–¹å·®é½æ€§æ£€éªŒï¼Œç”¨çœ¼ç›çœ‹ä¸€ä¸‹ï¼Œå¤§æ¦‚ç»™ä¸ªä¼°è®¡ï¼Œå°±åˆ¤æ–­äºŒè€…çš„æ–¹å·®æ˜¯ä¸æ˜¯ç›¸è¿‘ï¼Œä»Žè€Œé€‰æ‹©åšç­‰æ–¹å·®æ£€éªŒè¿˜æ˜¯å¼‚æ–¹å·®æ£€éªŒã€‚</p><p>ä¸Šé¢çš„è¿™äº›å†…å®¹ï¼Œçœ‹èµ·æ¥å…¶å®žå¾ˆç®€å•ï¼Œä½†åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œç”¨åˆ°çš„å®žåœ¨å¤ªé¢‘ç¹äº†ï¼Œå› è€Œè¿˜æ˜¯ä¸é¿å…¶ç¹åœ°è®°å½•äº†ä¸‹æ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç»Ÿè®¡</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è¯»ã€Šè‹ä¸œå¡æ–°ä¼ ã€‹æŽä¸€å†°</title>
    <link href="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/"/>
    <url>/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/</url>
    
    <content type="html"><![CDATA[<h3 id="è¯»ã€Šè‹ä¸œå¡æ–°ä¼ ã€‹æŽä¸€å†°"><a href="#è¯»ã€Šè‹ä¸œå¡æ–°ä¼ ã€‹æŽä¸€å†°" class="headerlink" title="è¯»ã€Šè‹ä¸œå¡æ–°ä¼ ã€‹æŽä¸€å†°"></a>è¯»ã€Šè‹ä¸œå¡æ–°ä¼ ã€‹æŽä¸€å†°</h3><p>.</p><p>æˆ‘è¯»è¿‡ä¸å°‘è‹è½¼çš„è¯—è¯ï¼Œä¹Ÿçœ‹è¿‡ä¸€äº›ä¸Žä»–ç›¸å…³çš„ä¼ é—»è½¶äº‹ï¼Œä½†å¯¹è‹è½¼çš„äº†è§£ä¾ç„¶æ˜¯é›¶ç¢Žæ‚ä¹±çš„ã€‚æ¯”å¦‚æˆ‘çŸ¥é“ä»–å¾ˆé£žæ‰¬ï¼Œå´ä¸çŸ¥é“ï¼Œä»–ä¹Ÿæœ‰æ²‰éƒçš„ä¸€é¢ï¼Œæˆ‘çŸ¥é“ä»–çš„è¯—è¯å¤šæ•°å¥”æ”¾è±è¾¾ï¼Œå´ä¸çŸ¥é“ä»–äº¦æ›¾åŽ†ç»ç£¨éš¾ã€‚äºŽæ˜¯æˆ‘å°è¯•æƒ³æ‰¾ä¸€æœ¬æ¯”è¾ƒå…¬æ­£çš„å…³äºŽè‹è½¼çš„ä¼ è®°è¯»ä¸€è¯»ã€‚</p><p>å¾ˆåº†å¹¸ï¼Œæˆ‘çœ‹åˆ°äº†ä»Šå¤©è¦ä»‹ç»çš„è¿™éƒ¨æŽä¸€å†°æ‰€è‘—çš„ã€Šè‹ä¸œå¡æ–°ä¼ ã€‹ã€‚çœŸçš„å¾ˆæƒŠå–œï¼Œåœ¨è¿™ä¹ˆå¤šã€Šè‹ä¼ ã€‹é‡Œï¼Œå±…ç„¶è¿˜æœ‰ç€ä¸€ä½å«æŽä¸€å†°çš„è€å…ˆç”Ÿï¼Œç©·å…«å¹´ä¹‹åŠ›ï¼Œåœ¨ç»åŽ†ç‰¢ç‹±ä¹‹ç¥¸åŽå†™å°±çš„ã€Šè‹ä¸œå¡æ–°ä¼ ã€‹ã€‚å…¶ä»–ä¸è¯´ï¼Œå•æ¯”èµ·æž—è¯­å ‚çš„ã€Šè‹ä¸œå¡ä¼ ã€‹æ¥ï¼Œå°±è¦é«˜æ˜Žé è°±å¾—å¤šï¼Œä¹Ÿæ›´æœ‰æ€§æƒ…ã€‚æž—è¯­å ‚ç‰ˆä½ è¯»äº†ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå¯¹ä½œè€…ç”Ÿå‡ºä¸€äº›è½»è§†ä¹‹æ„ï¼ŒåŽŸæ¥ä¹…è´Ÿç››åçš„å¤§ä½œå®¶ä¹Ÿä¸è¿‡å¦‚æ­¤ï¼Œä½†æŽä¸€å†°ç‰ˆï¼Œä½ å´åªä¼šè‚ƒç„¶èµ·æ•¬ã€‚</p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0.png" alt="è‹ä¸œå¡æ–°ä¼ "></p><p>å¾ˆå¿«å°±ç¿»åˆ°äº†è‹è½¼åœ¨é»„å·žçš„é‚£äº”å¹´ï¼Œè¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„ä¸€ä¸ªç« èŠ‚ï¼Œä¹Ÿæ˜¯æˆ‘è®¤ä¸ºè‹è½¼ä¸€ç”Ÿä¸­æœ€ç²¾å½©çš„ä¸€æ®µï¼Œæˆ‘æ‰€å–œæ¬¢çš„è‹è½¼è¯—è¯å¤šæ•°éƒ½æ˜¯ä½œäºŽæ­¤æ®µæ—¶é—´ã€‚</p><p>å…¬å…ƒ1079å¹´ï¼Œé‚£å¹´è‹è½¼43å²ï¼Œåˆšåˆšå°±ä»»æ¹–å·žå¼€å§‹ä¸»æ”¿ä¸€æ–¹ï¼Œæ­£æ˜¯æ„æ°”é£Žå‘çš„æ—¶å€™ã€‚ä½†æ—‹å³å°±é­åˆ°å¼¹åŠ¾å‘Šå‘ï¼Œè‹è½¼ä¹Ÿå› æ¶‰å«Œâ€œè®¥è®½æ–°æ³•â€è€Œè¢«ç¼‰æ•å…¥ç‹±ï¼Œè¿™å°±æ˜¯åŽä¸–è‘—åçš„â€œä¹Œå°è¯—æ¡ˆâ€äº†ã€‚éšåŽæ­»é‡Œé€ƒç”Ÿï¼Œä»¥â€œçŠ¯å®˜â€çš„èº«ä»½ï¼Œè¾—è½¬è¢«è´¬é»„å·žã€‚</p><p>è‹è½¼æ˜¯å¦å«å†¤ï¼Œå§‘ä¸”ä¸è®ºï¼Œä½†æ˜¯è¿™æ®µä¹æ­»ä¸€ç”Ÿçš„å›šå¾’ç»åŽ†ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œå´æ˜¯å°†è‹è½¼çš„ä¸€ç”Ÿåˆ†å‰²æˆäº†ä¸¤æ®µã€‚åœ¨æ­¤ä¹‹å‰ï¼Œä»–åªæ˜¯åŒ—å®‹ä¸€ä¸ªæ™®é€šçš„å®˜åƒšï¼Œæœ€å¤šç®—æ˜¯æœ‰æ‰åŽä¸€ç‚¹ï¼Œä¸ŽæŽ©åŸ‹åŽ†å²å°˜åœŸä¸­çš„åƒåƒä¸‡ä¸‡ä¸­å›½å¤ä»£å£«å¤§å¤«ä»¬å¹¶æ— å¤ªå¤šåŒºåˆ«ã€‚ä½†é»„å·žä¹‹åŽï¼Œè‹è½¼å°±åƒä¸€é¢—æ˜Žæ˜Ÿä¸€æ ·ï¼Œä¸€ç›´é—ªçƒåœ¨ä¸­åŽæ–‡åŒ–å²ä¸Šï¼Œä»¤åŽäººæ•¬ä»°ã€‚</p><p>è‹è½¼åˆšåˆ°é»„å·žæ—¶ï¼Œå¯„å±…åœ¨å®šæƒ é™¢ï¼Œæ­¤æ—¶çš„ä»–å°šå¤„åœ¨åŠ«éš¾çš„æƒŠæä¸­ï¼Œå¦‚åŒä¸€åªæƒŠå¼“ä¹‹é¸Ÿï¼Œåªæ±‚èƒ½è‹Ÿå…¨æ€§å‘½ã€‚ç™½å¤©ä»–åªåœ¨ä½å¤„å§æ¦»ç¡è§‰ï¼Œåˆ°äº†æ™šä¸Šæ‰ä¸€ä¸ªäººæ‚„æ‚„è·‘åˆ°é™¢å¤–åŽ»æ•£æ•£æ­¥ï¼Œæ­£å¦‚ä»–å†™ç»™å…¶å¼Ÿè‹è¾™çš„è¯—ä¸­æ‰€è®°â€œç•è›‡ä¸ä¸‹æ¦»ï¼Œç¡è¶³å¾æ— æ±‚â€ä¸€æ ·ï¼Œæ»¡æ€€å¿§æƒ§ã€‚</p><p>åŽæ¥æ¢äº†ä¸€ä¸ªä½å¤„ï¼Œæ¬åˆ°äº†ä¸´çš‹äº­ï¼Œè¿™ä¸ªåœ°æ–¹éžå¸¸é è¿‘é•¿æ±Ÿï¼Œäº­ä¸‹å…«åä½™æ­¥ä¾¿æ˜¯å¤§æ±Ÿï¼Œè‹è½¼ç»å¸¸ç­–ä»—æ±Ÿè¾¹ã€‚æœ‰ä¸€æ¬¡ä¸Žé•¿å­è‹è¿ˆä¸€åŒæ¼«æ¸¸æ±Ÿå²¸ï¼Œè¿‡çŸ¥å·žå®˜é‚¸ä¸è¿‡ç™¾æ­¥ï¼Œå°±çœ‹è§ä¸€ç‰‡ç»›èµ¤è‰²çš„å´–å£ï¼ŒçŸ—ç«‹åœ¨æ·±ç¢§è‰²çš„æ±Ÿæ°´ä¸­ï¼Œæ°”è±¡æŒºæ‹”é›„ä¿Šã€‚å¬äººè¯´ï¼Œè¿™åœ°æ–¹å°±æ˜¯ä¸‰å›½æ—¶ä»£å‘¨ç‘œè”å†›å¤§ç ´æ›¹æ“çš„èµ¤å£å¤æˆ˜åœºã€‚æ›¾ç»æ»¡æ€€æµŽä¸–çƒ­æƒ…çš„è‹è½¼è¿™ä¼šå„¿æ­£å¤„äºŽäººç”Ÿæœ€ä½Žæ½®ï¼Œä»¥ä¸ºè‡ªå·±è¿™ä¸€ç”Ÿå¤§æ¦‚åŠŸåæ— æœ›äº†ï¼ŒäºŽæ˜¯åœ¨è¿™æ¬¡åˆæ¸¸èµ¤å£æ—¶ï¼Œä½œä¸‹ä¸€é¦–ã€Šèµ¤å£æ€€å¤ã€‹ã€‹ï¼šâ€œå¤§æ±Ÿä¸œåŽ»ï¼Œæµªæ·˜å°½ï¼Œåƒå¤é£Žæµäººç‰©ã€‚æ•…åž’è¥¿è¾¹ï¼Œäººé“æ˜¯ï¼Œä¸‰å›½å‘¨éƒŽèµ¤å£â€ï¼Œä»¥è¿½æ€åŽ†å²è‹±é›„äººç‰©æ¥å¼¥è¡¥å†…å¿ƒçš„ç©ºè™šã€‚</p><p>ä¹Ÿè®¸æ˜¯æ—¶é—´çš„æµé€ï¼Œè‹è½¼æ¸æ¸åœ°ä»Žæœ€åˆçš„æƒ¶æƒ§å’Œç©ºè™šä¸­èµ°å‡ºæ¥ï¼Œå¼€å§‹â€œæ‰èˆŸè‰å±¥ï¼Œæ”¾æµªå±±æ°´é—´ï¼Œä¸Žæ¨µæ¸”æ‚å¤„â€èµ·æ¥ï¼Œä¹Ÿæ­£æ˜¯è¿™ç§éšæ€§çš„æ¼«æ¸¸ï¼Œè®©ä»–æ›´çœŸåˆ‡åœ°æ„Ÿå—åˆ°è‡ªç„¶æ‰€å¸¦æ¥çš„æ—·ç„¶å¤©çœŸä¹‹ä¹ï¼Œå°±åƒä»–åœ¨ã€Šèµ¤å£èµ‹ã€‹é‡Œæ‰€ä½œï¼šâ€œæƒŸæ±Ÿä¸Šä¹‹æ¸…é£Žï¼Œä¸Žå±±é—´ä¹‹æ˜Žæœˆï¼Œè€³å¾—ä¹‹è€Œä¸ºå£°ï¼Œç›®é‡ä¹‹è€Œæˆè‰²ï¼Œå–ä¹‹æ— ç¦ï¼Œç”¨ä¹‹ä¸ç«­ã€‚æ˜¯é€ ç‰©è€…ä¹‹æ— å°½è—ä¹Ÿï¼Œè€Œå¾ä¸Žå­ä¹‹æ‰€å…±é€‚â€ä¸€æ ·ï¼Œçºµæƒ…å±±æœˆï¼Œæ€¡ç„¶è‡ªå¾—ã€‚</p><p>ä½†æ˜¯â€œå¤§æ±Ÿé£Žæœˆï¼Œå²‚å¯ç–—é¥¥ï¼Ÿâ€ï¼Œè´¬è°ªçŠ¯å®˜çš„æ”¶å…¥éš¾ä»¥æ”¯æ’‘èµ·å®¶åº­çš„ç”Ÿæ´»ï¼Œåˆ°äº†è¢«è´¬é»„å·žçš„ç¬¬äºŒå¹´ï¼Œè‹è½¼ä¸€å®¶å·²ç»æ‰‹å¤´å¾ˆæ‹®æ®äº†ï¼Œå¹¶ä¸”è¿™ç§æµæ”¾çš„æƒ©ç½šä¸çŸ¥ä½•æ—¶æ‰æ˜¯ç»ˆæœŸã€‚æ‰€ä»¥ï¼Œè‹è½¼å°±å¸Œæœ›èƒ½å¤Ÿæœ‰ä¸€å—åœŸåœ°ï¼Œä»¥å½“èº¬è€•è‡ªç»™ã€‚å¹¸å¾—äºŒåå¹´å‰åœ¨äº¬åšå®˜æ—¶è®¤è¯†çš„ä¸€ä½æœ‹å‹å¸®å¿™ï¼Œæ‰èŽ·å‡†å¾—åˆ°ä¸€å—åºŸå¼ƒçš„å¡åœ°ï¼Œè¯¥åœ°çº¦äº”åä½™äº©ï¼Œä½å¤„é»„å·žå·žåºœä¹‹ä¸œçš„å±±éº“ï¼Œæ•…è€Œå·åâ€œä¸œå¡â€ï¼Œè‹è½¼çš„ä¸œå¡å±…å£«ä¹‹åäº¦ç”±æ­¤è€Œæ¥ã€‚</p><p>è‹è½¼åœ¨é‚£å—è’åœ°ä¸Šäº²åž¦ç”°åœ°ï¼Œè‡ªç§é»„æ¡‘ï¼Œè™½ç„¶è¾›è‹¦ï¼Œä½†ä»–å¿ƒé‡Œå¾ˆä¸ºæ»¡è¶³ï¼Œâ€œè…å„’ç²—ç²æ”¯ç™¾å¹´ï¼ŒåŠ›è€•ä¸å—ä¼—ç›®æ€œâ€ã€‚ä»–è¿˜æŒ‰ç…§åœ°åŠ¿é«˜ä¸‹ï¼Œè§„åˆ’äº†ä¸€ä¸ªè“å›¾ï¼Œè¾ƒä½Žçš„æ¹¿åœ°ç§æ¤ç²³ç¨»ï¼›ä¸œé¢å¹³åœ°ä¸Šç§ä¸Šæž£æ ‘å’Œæ —æ ‘ï¼Œä½åœ¨å¯¹æ±Ÿçš„åŒä¹¡ï¼Œå·²ç»åº”å…é€ä»–æ¡‘æ ‘å’Œæžœè‹—ï¼›åœ¨è§†é‡Žæœ€ä½³çš„ç©ºåœ°å¤„ï¼Œæž„ç­‘æˆ¿èˆï¼Œä»¥ä¾¿å®‰å®¶ã€‚æ­¤æ—¶çš„è‹è½¼ï¼Œå·²ç»å¼€å§‹æ·¡æ³Šç”°é‡Žï¼Œå®‰è´«ä¹é“äº†ï¼Œä¸ä¿¡ï¼Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå°æ•…äº‹ã€‚</p><p>è‹è½¼çš„å¥½å‹çŽ‹å·©ï¼Œä¹Ÿå› å—â€œä¹Œå°è¯—æ¡ˆâ€ç‰µè¿žï¼Œè¢«é»œé€åˆ°äº†åè¿œçš„å²­å—ï¼ŒåŽæ¥èŽ·èµ¦åŒ—è¿”ï¼Œè·¯ç»é»„å·žæ¥æŽ¢æœ›è‹è½¼ï¼Œå¸­é—´è‹è½¼é—®åŠå²­å—çš„æƒ…å†µï¼Œæ„Ÿè§¦é¢‡å¤šï¼ŒäºŽæ˜¯æ‰æœ‰äº†åŽæ¥çš„åå¥ï¼šâ€œè¯•é—®å²­å—åº”ä¸å¥½ï¼Œå´é“ï¼Œæ­¤å¿ƒå®‰å¤„æ˜¯å¾ä¹¡â€ã€‚ç”±æ­¤å¯è§ï¼Œæ­¤æ—¶çš„è‹è½¼å·²ç»å¿ƒæ€ä¹è§‚ï¼Œé¡½å¼ºè‡ªé€‚äº†ã€‚ä¼ é—»ï¼Œè‹è½¼ä½œæ­¤ã€Šå®šé£Žæ³¢Â·å¸¸ç¾¡äººé—´ç¢çŽ‰éƒŽã€‹è¯æ—¶ï¼Œæ˜¯å—éšè¡ŒçŽ‹å·©çš„ä¸€ä½å«å¯“å¨˜çš„æ­Œå¦¾æ‰€å¯å‘ï¼ŒçœŸå‡ä¸çŸ¥ï¼Œå§‘ä¸”ä¸è®ºã€‚</p><p>è‡³æ­¤ï¼Œè‹è½¼å·²ç»å®Œå…¨ä¸ä¼¼åˆåˆ°é»„å·žçš„é‚£èˆ¬æƒŠæƒ§å’Œå­¤ç‹¬äº†ï¼Œæ›´å¤šçš„æ˜¯æ¸…é†’å’Œè¶…ç„¶ï¼Œåœ¨ä»–çš„ã€Šæ±ŸåŸŽå­ã€‹é‡Œï¼Œè‹è½¼æ˜¯è¿™æ ·è¯´çš„ï¼šâ€œæ¢¦ä¸­äº†äº†é†‰ä¸­é†’ï¼Œåªæ¸Šæ˜Žï¼Œæ˜¯å‰ç”Ÿã€‚èµ°éäººé—´ï¼Œä¾æ—§å´èº¬è€•ã€‚æ˜¨å¤œä¸œå¡æ˜¥é›¨è¶³ï¼Œä¹Œé¹Šå–œï¼ŒæŠ¥æ–°æ™´ã€‚â€ï¼Œä½ çœ‹ï¼Œåªæœ‰æ¬¢ä¹å’Œæ»¡è¶³ã€‚</p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E5%AE%9A%E9%A3%8E%E6%B3%A2.jpg" alt="å®šé£Žæ³¢"></p><p>è‡ªä»Žå‡ å¹´å‰å—â€œè¯—æ¡ˆâ€æ‰€ç¥¸ï¼Œè‹è½¼è‡³æ­¤å·²ç»æ²¡æœ‰å¤ªå¤šä»•è¿›çš„å¿µå¤´äº†ï¼Œä¸€å¿ƒåªæƒ³åœ¨é»„å·žä½œä¸€ä¸ªä¾å¼„åº„ç¨¼çš„å†œå¤«ï¼ŒäºŽæ˜¯å°±æƒ³å†ç½®ä¹°ä¸€äº›ç”°åœ°ï¼Œä»¥èµ¡å…»å®¶å£ã€‚å…ƒä¸°äº”å¹´ä¸‰æœˆä¸ƒæ—¥é‚£ä¸€å¤©ï¼Œä»–åˆ°è·é»„å·žä¸‰åé‡Œåœ°çš„æ²™æ¹–åŽ»çœ‹ç”°ï¼Œçœ‹å®Œç”°è¿”å®¶çš„è·¯ä¸Šï¼Œå¤©æ°”éª¤å˜ï¼Œå¿½ç„¶ä¸‹èµ·äº†å¤§é›¨ã€‚ä»–ä»¬ä¸€è¡Œäººï¼Œä¸ªä¸ªæ·‹å¾—ç‹¼ç‹ˆï¼Œç‹¬æœ‰è‹è½¼å®‰æ­¥å¾è¡Œã€‚ä¸ä¹…ï¼Œé›¨éœå¤©æ™´ï¼Œä»–å¾ˆä¸ºè‡ªå·±è¿™ä»½å¦è¡æ´’è„±çš„å¿ƒæ€€è€Œå¾—æ„ï¼Œé‚ä½œã€Šå®šé£Žæ³¢Â·èŽ«å¬ç©¿æž—æ‰“å¶å£°ã€‹ä¸€é¦–ï¼šâ€œèŽ«å¬ç©¿æž—æ‰“å¶å£°ï¼Œä½•å¦¨åŸå•¸ä¸”å¾è¡Œã€‚ç«¹æ–èŠ’éž‹è½»èƒœé©¬ï¼Œè°æ€•ï¼Œä¸€è“‘çƒŸé›¨ä»»å¹³ç”Ÿã€‚æ–™å³­æ˜¥é£Žå¹é…’é†’ï¼Œå¾®å†·ï¼Œå±±å¤´æ–œç…§å´ç›¸è¿Žã€‚å›žé¦–å‘æ¥è§ç‘Ÿå¤„ï¼Œå½’åŽ»ï¼Œä¹Ÿæ— é£Žé›¨ä¹Ÿæ— æ™´â€ã€‚</p><p>äººçš„ä¸€ç”Ÿï¼Œæœ‰è¿½æ±‚å°±å¿…æœ‰å¤±è½ï¼Œå¦‚æžœè¿‡äºŽæ‰§æ„ï¼Œå†…å¿ƒä¾¿éš¾ä»¥å¹³é™ï¼Œç—›è‹¦è‡ªç„¶ä¹Ÿå°±å¦‚é£Žé›¨ä¸€æ ·ï¼Œå››é¢å…«æ–¹åœ°å†²èš€ç€ä½ ã€‚åœ¨è¿™é‡Œï¼Œè¿™é¥±ç»ä¸–æ‚£çš„è¯—äººï¼Œåœ¨é›¨ä¸­ä¸¾æ­¥è½»è¡Œï¼Œä¸–äº‹æ— å¸¸çš„å˜å¹»å·²å…¨ç„¶ä¸åœ¨å¿ƒé—´ï¼Œå”¯æœ‰å¦ç„¶çš„è¶…è„±ï¼Œè®©äººç¥žå¾€ã€‚</p><p>å…ƒä¸°ä¸ƒå¹´ï¼Œä¹Ÿå°±æ˜¯å…¬å…ƒ1084å¹´ï¼Œè¿™ä¸€å¹´è‹è½¼48å²ï¼Œç¥žå®—çš‡å¸æ¬²é‡æ–°èµ·å¤è‹è½¼ï¼ŒæŽˆå…¶æ°´éƒ¨å‘˜å¤–éƒŽï¼Œç§»è¿è‡³ç›¸å¯¹ç¹åŽçš„æ±å·žï¼Œè‡³æ­¤ï¼Œä»–çš„å¢ƒåœ°æ‰å¼€å§‹å‘å¥½è½¬å˜ã€‚</p><p>è‹è½¼è‡ªå…ƒä¸°ä¸‰å¹´ï¼ˆ1080ï¼‰äºŒæœˆåˆ°è¾¾é»„å·žï¼Œè‡³å…ƒä¸°ä¸ƒå¹´å››æœˆç¦»åŽ»ï¼Œåœ¨æ­¤æ•´æ•´ä½äº†å››å¹´ä¸‰ä¸ªæœˆã€‚é»„å·žè™½å¤„ç©·åƒ»ï¼Œä½†ä½ä¹…äº†ï¼Œä¸€è‰ä¸€æœ¨ï¼Œä¹Ÿä¸å…æœ‰æƒ…ï¼Œæ›´åˆ«è¯´é‚»é‡Œã€æœ‹å‹äº†ï¼ŒäºŽæ˜¯ä½œã€Šæ»¡åº­èŠ³ã€‹ä»¥å½“å‘Šåˆ«ï¼šâ€œå½’åŽ»æ¥å…®ï¼Œå¾å½’ä½•å¤„ï¼Ÿä¸‡é‡Œå®¶åœ¨å²·å³¨ã€‚ç™¾å¹´å¼ºåŠï¼Œæ¥æ—¥è‹¦æ— å¤šã€‚åè§é»„å·žå†é—°ï¼Œå„¿ç«¥å°½æ¥šè¯­å´æ­Œã€‚å±±ä¸­å‹ï¼Œé¸¡è±šç¤¾é…’ï¼Œç›¸åŠè€ä¸œå¡â€ã€‚</p><p>è‹è½¼ç¦»å¼€é»„å·žåŽï¼Œå¢ƒé‡å˜å¥½ï¼ŒåŽåˆå¾—æœå ‚é‡ä»»ï¼Œå›žåˆ°æ±´äº¬åšä¸­ä¹¦èˆäººï¼Œæ—¬æœˆä¹‹é—´ï¼Œæ•°æ¬¡å‡è¿ï¼Œç›´åˆ°ç¿°æž—å­¦å£«ï¼Œç®—æ˜¯æ—¶æ¥è¿è½¬äº†ã€‚ä½†è‹è½¼çš„æ–½æ”¿èƒ½åŠ›å®žåœ¨ä¸€èˆ¬ï¼Œæ¯”èµ·åŒæ—¶ä»£çš„å¸é©¬å…‰å°šæœ‰ä¸å¦‚ï¼Œæ›´åˆ«è¯´çŽ‹å®‰çŸ³äº†ã€‚åœ¨ä¹‹åŽä¸Žç« æƒ‡ç­‰äººçš„æ”¿æ²»æ–—äº‰ä¸­åˆå¤šæ¬¡è¢«è´¬ï¼Œæ­£å¦‚å…¶æ™šå¹´åœ¨ã€Šè‡ªé¢˜é‡‘å±±ç”»åƒã€‹ä¸€è¯—ä¸­æ‰€å™ï¼šâ€œé—®æ±å¹³ç”ŸåŠŸä¸šï¼Œé»„å·žæƒ å·žå„‹å·žâ€ï¼Œä¸€è·¯ä¸Šéƒ½åœ¨é­è´¬ï¼Œå¹¶ä¸”æµæ”¾çš„åœ°æ–¹ä¸€æ¬¡æ¯”ä¸€æ¬¡è¿œï¼Œæ˜¯æ›´åŠ åè¿œçš„å¹¿ä¸œæƒ å·žï¼Œæµ·å—å„‹å·žã€‚</p><p>ä½†é»„å·žä¹‹åŽï¼Œå†é‡è´¬æŒ«ï¼Œä»–çš„å¿ƒæ€å·²ç»å…¨ç„¶ä¸åŒäº†ã€‚åœ¨è°ªå¾€æƒ å·žçš„è·¯ä¸Šï¼Œé€”å¾„æ±Ÿè¥¿å¤§åº¾å²­ï¼ˆä»Šå±žå¹¿ä¸œéŸ¶å…³ï¼‰æ—¶ï¼Œçœ‹åˆ°å¤§åº¾å²­å±±å³°å·å³¨ï¼Œå£®ä¸½å¼‚å¸¸ï¼Œå¹¶æœ‰è–„é›¾çŽ¯ç»•ï¼Œå®›å¦‚ä»™å¢ƒï¼Œä¸ç¦å†™é“ï¼šâ€œä¸€å¿µå¤±åž¢æ±¡ï¼Œèº«å¿ƒæ´žæ¸…å‡€ã€‚æµ©ç„¶å¤©åœ°é—´ï¼ŒæƒŸæˆ‘ç‹¬ä¹Ÿæ­£â€ã€‚è¿™å“ªåƒæ˜¯è¢«è´¬ï¼Œæ›´åƒæ˜¯é€€èŒå›žå®¶å•Šï¼Œå­—è¡Œé—´å…¨æ˜¯è¶…è„±è½»æ¾ã€æ´žæ˜Žæ¸…å‡€ã€‚</p><p>è¿™æœ¬ä¹¦ï¼Œæˆ‘å¤§å¤šæ˜¯åœ¨å¤å¤œä¸œæ¹–éª‘è¡Œæ—¶çš„é—´éš™åœ¨æ‰‹æœºä¸Šè¯»çš„ï¼Œåœ¨è¿™æ ·çš„æƒ…å¢ƒä¸‹ï¼Œæˆ‘å¯¹è‹è½¼â€œæœä¸Šä¸œå¡æ­¥ï¼Œå¤•ä¸Šä¸œå¡æ­¥ã€‚ä¸œå¡ä½•æ‰€çˆ±ï¼Œçˆ±æ­¤æ–°æˆæ ‘â€çš„å¹³æ·¡å®‰é€‚æœ‰äº†æ›´æ·±çš„æ„Ÿå—ã€‚è¯»åˆ°è¿™é‡Œï¼Œæˆ‘äº¦é˜´éœ¾å°½åŽ»ï¼Œè½»æ¾å¦‚æ²ã€‚</p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E5%A4%8F%E5%A4%9C%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C.jpg" alt="å¤å¤œä¸œæ¹–éª‘è¡Œ"></p><p>åœ¨å›žç¨‹è·¯ä¸Šï¼Œæˆ‘éª‘è½¦ä¸€è·¯è·¨å±±è¶Šå²—ï¼Œå¤§æ±—é€è¡£ï¼Œå´å¼‚å¸¸ç•…å¿«ã€‚æˆ–è®¸æ˜¯å¹³æ—¥é‡ŒåŽ‹æŠ‘è¿‡ä¹…ï¼Œè¿åŠ¨å‡ºæ±—å¸¦æ¥çš„åŠ›é‡æ„Ÿï¼Œè®©æˆ‘è§‰å¾—æ— æ¯”é‡Šæ”¾ã€‚è§¦è§‰å¬è§‰ä¹Ÿå¥½åƒæ¢å¤äº†çµæ•ï¼Œæˆ‘èƒ½çœŸåˆ‡åœ°æ„ŸçŸ¥åˆ°å¤å¤œä¸œæ¹–çš„çƒ­æƒ…å’Œå‹å¥½ï¼Œä¸€è·¯ä¸Šå¹½é¸Ÿå‘æˆ‘é¸£ï¼Œå¤œé£Žæ…°æˆ‘æ„ã€‚</p><p>ç­‰æˆ‘åˆ°å‡Œæ³¢é—¨çš„æ—¶å€™ï¼Œå·²ç»è¿‡äº†é›¶ç‚¹ï¼Œæ ˆæ¡¥ä¸Šåªæœ‰ä¸‰ä¸¤ä¸ªäººï¼Œæˆ–æ•£è½å‘†åï¼Œæˆ–ä¾åŽæˆå¯¹ã€‚åˆšåˆšçš„å…´å¥‹è¿˜æœªå°½è¤ªï¼Œæˆ‘æŽå‡ºç”µè¯ï¼Œæ‰“ç®—å«ä¸Šä¸€äºŒæœ‹å‹ï¼Œè½½é…’ä¹°ç“œï¼Œæ¥è¿™æ¹–è¾¹æ ˆæ¡¥ä¸Šå¯¹åé—²è°ˆã€‚ç¿»æ‰¾è®¸ä¹…ï¼Œç«Ÿæƒ³ä¸å‡ºè°äººå¯çº¦ï¼Œæ‰ååº”è¿‡æ¥ï¼Œæˆ‘åœ¨è¿™ä¸ªåŸŽå¸‚å·²æ— è¦å¥½æœ‹å‹ï¼Œåªå¥½æ‚»æ‚»ç„¶å›žäº†å®¿èˆã€‚</p><p>å®¿èˆç´§é‚»ä¸œæ¹–ï¼Œç«™åœ¨å¤©å°ä¸Šèƒ½çœ‹æ¸…å¤§åŠçš„æ¹–æ™¯ã€‚å…¶æ—¶ï¼Œæœˆå‡ºä¸œå—ï¼Œæž—å½±åœ¨åœ°ï¼Œåˆæœ‰çš“æœˆç…§çª—ï¼Œåœºåœ°ç©ºæ˜Žï¼Œæ­£æ˜¯å¤œæ¸¸èµæœˆçš„å¥½æƒ…æ™¯ï¼Œåªæ˜¯å¯æƒœæ²¡æœ‰å¼ æ€€æ°‘ï¼Œé‚ä¸å¾—ä½œç½¢ï¼ŒäºŽæ˜¯æ‰“å¼€wordæƒ³è¦å°½é€Ÿè®°ä¸‹è¿™ä¸€åˆ»çš„ä½“ä¼šã€‚[äºŒé›¶äºŒå››å¹´å…«æœˆåå…­æ—¥æ™šåœ¨å·¥å­¦éƒ¨æ–°2èˆ]</p><p>æˆ‘æƒ³èµ·ä¹ç™¾å¤šå¹´å‰çš„ä¸€ä¸ªæœˆæ˜Žå¤œï¼Œæœ‰ä¸€äººè§£è¡£æ¬²ç¡ï¼Œè§æœˆè‰²å…¥æˆ·ï¼Œä¾¿æ¬£ç„¶èµ·è¡Œï¼Œç›¸çº¦æ—§å‹ï¼Œé—²æ­¥åº­ä¸­ï¼Œå¯¹é…’å¼•æ­Œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Peak calling for CLIP-Seq data by omniCLIP [1]</title>
    <link href="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/"/>
    <url>/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/</url>
    
    <content type="html"><![CDATA[<h3 id="Peak-calling-for-CLIP-Seq-data-by-omniCLIP-1"><a href="#Peak-calling-for-CLIP-Seq-data-by-omniCLIP-1" class="headerlink" title="Peak calling for CLIP-Seq data by omniCLIP [1]"></a>Peak calling for CLIP-Seq data by omniCLIP [1]</h3><p>.</p><p> I have used omniCLIP to analyze CLIP data a few months ago, but the software is poorly maintained. The author is also incompetent, as they didnâ€™t even clearly explain the output files. </p><p>Although the software is quite bad, I still want to record how to use it.</p><hr><p>I have skimmed through this papers (about the omniCLIP), and now I will provide a brief explanation of its computational principles and algorithm.</p><p>This paper ( Philipp et. al. 2018,Genome biology)  employ a Non-Homogeneous Hidden Markov Model (NHMM) to segment the genome into peaks and non-peaks. The emission probability of the NHMM is given by the product of the joint probability of the coverage and the probability of the observed diagnostic event frequency in all replicate CLIP and background libraries.</p><p>And a Negative Binomial based Generalized Linear Model (that models both confounding by the gene expression, and confounding of local effects and also allows to account for excess variance) are used to model the reads coverage.</p><p>Besides, the diagnostic events are modeled using a Dirichlet-Multinomial mixture model. The transition probabilities of the model are based on a logistic function that depends on the coverage. </p><h5 id="The-diagram-below-illustrates-the-algorithmic-of-omniCLIP"><a href="#The-diagram-below-illustrates-the-algorithmic-of-omniCLIP" class="headerlink" title="The diagram below illustrates the algorithmic of omniCLIP."></a>The diagram below illustrates the algorithmic of omniCLIP.</h5><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/Illustration%20of%20omniCLIP%20peak%20calling%20.png" alt="Illustration of omniCLIP peak calling "></p><p>show on the (left) is peak calling for a lowly expressed genes with strong RNA binding protein (RBP) RNA-binding and on the (right) a highly expressed gene with weak RBP RNA-binding. During peak calling, local background coverage is taken into account to correct for confounding by local effects or biases. Furthermore, overall the RNA abundance is estimated and accounted for. This allows better ranking peaks with identical local coverage by sharing of information along the transcript, as illustrated for the leftmost peaks in both genes.  </p><hr><h3 id="1-data-preparation"><a href="#1-data-preparation" class="headerlink" title="1. data preparation"></a>1. data preparation</h3><h4 id="1-1-data"><a href="#1-1-data" class="headerlink" title="1.1). data"></a>1.1). data</h4><p><strong>GSE98188</strong> from paper : </p><p>  Drosophila Sister-of-Sex-lethal reinforces a male-specific gene expression pattern by controlling Sex-lethal alternative splicing.  </p><p>  <em>Nucleic Acids Res</em> 2019</p><p> <strong>data download</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">iCLIP <span class="hljs-keyword">in</span> SL2 cells</span><br>lftp -e &#x27;pget -n 15 -c &quot;ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR548/007/SRR5480967/SRR5480967.fastq.gz&quot;;exit&#x27; # Similar methods for other samples.<br></code></pre></td></tr></table></figure><h4 id="1-2-data-clean"><a href="#1-2-data-clean" class="headerlink" title="1.2). data clean"></a>1.2). data clean</h4><p> <strong>Since the paper did not provide the adapter sequences and the length and position of the UMI</strong>.</p><p> I  tried different methods  to mark and remove the UMI and adapter.</p><p> <strong>a). remove adapter</strong></p><p>To detect the adapter sequences used, I first processed the raw sequencing data with trim_galore.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls ../*fastq.gz |while read id;do (trim_galore --quality 20  --length 20 -o ./ $id);done<br></code></pre></td></tr></table></figure><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/remove%20adapter.png" alt="remove adapter"></p><p>Based on the â€œauto-detection adapterâ€ in the above figure, we can infer that the adapter sequence is AGATCGGAAGAGC.</p><p>The same processing method was applied to the other samples as well.   </p><p>Therefore,  removing the adapter from the raw sequence data based on the sequences identified above.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in *.fastq.gz;<br>do<br>id=$&#123;i%.fastq.gz&#125;<br>echo $i,$id<br>cutadapt -q 25 -a AGATCGGAAGAGC  --overlap=3 -n 1 -m 24 -o $&#123;id&#125;_cutadap.fastq.gz  $&#123;id&#125;.fastq.gz<br>done<br></code></pre></td></tr></table></figure><p> <strong>b). mark UMI</strong></p><p> I used the adapters-removed reads for a BLAST against the genome in flybase and found that there are always 10 unpaired  bases at the 5â€™ end of the reads. Therefore, I suspect these are the UMI, as shown in the figure below.</p><p>â€‹<a href="mailto:&#x72;&#x65;&#97;&#x64;&#45;&#64;&#x53;&#82;&#x52;&#53;&#52;&#56;&#x30;&#57;&#x36;&#55;&#46;&#x31;&#49;">&#x72;&#x65;&#97;&#x64;&#45;&#64;&#x53;&#82;&#x52;&#53;&#52;&#56;&#x30;&#57;&#x36;&#55;&#46;&#x31;&#49;</a> 11&#x2F;1   length &#x3D; 53 bp       <img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/reads%20blast%201.png" alt="reads blast 1">                         </p><p>â€‹<a href="mailto:&#x72;&#101;&#x61;&#x64;&#x2d;&#64;&#x53;&#82;&#x52;&#x35;&#52;&#x38;&#x30;&#57;&#54;&#x37;&#46;&#50;&#49;&#x38;">&#x72;&#101;&#x61;&#x64;&#x2d;&#64;&#x53;&#82;&#x52;&#x35;&#52;&#x38;&#x30;&#57;&#54;&#x37;&#46;&#50;&#49;&#x38;</a> 218&#x2F;1   length &#x3D; 51 bp</p><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/reads%20blast%202.png" alt="reads blast 2"></p><p>Next, I used the <strong>flexbar</strong> software to mark the UMIs in the reads.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat &gt;  barcodes.fa   # create a file, with 10 N (length of UMI is 10 bp)<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">umi</span><br>NNNNNNNNNN<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda activate py39<br><br>for i in *_cutadapt.fastq.gz;<br>do<br>id=$&#123;i%_cutadapt.fastq.gz&#125;<br>echo $i,$id<br>flexbar -r $&#123;id&#125;_cutadapt.fastq.gz  -b barcodes.fa --umi-tags -t $&#123;id&#125; -z GZ<br>done<br></code></pre></td></tr></table></figure><h3 id="2-omniCLIP-for-CLIP-Seq-peaks-calling"><a href="#2-omniCLIP-for-CLIP-Seq-peaks-calling" class="headerlink" title="2.omniCLIP for CLIP-Seq peaks calling"></a>2.omniCLIP for CLIP-Seq peaks calling</h3><h4 id="2-1-intsall-omniCLIP"><a href="#2-1-intsall-omniCLIP" class="headerlink" title="2.1). intsall omniCLIP"></a>2.1). intsall omniCLIP</h4><p><strong>download</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git clone https://github.com/philippdre/omniCLIP.git <br></code></pre></td></tr></table></figure><p><strong>create conda env</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd omniCLIP/<br>conda env create -f environment.yml<br>conda activate omniEnv<br></code></pre></td></tr></table></figure><p><strong>install</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python3 setup.py install<br></code></pre></td></tr></table></figure><h4 id="2-2-build-a-db-files-of-annotation-gtf"><a href="#2-2-build-a-db-files-of-annotation-gtf" class="headerlink" title="2.2). build a db files of annotation gtf"></a>2.2). build a db files of annotation gtf</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /home/xuyz_g/soft/omniCLIP # programs can only run successfully in directory of omniCLIPï¼Œdon&#x27;t know why<br><br>omniCLIP generateDB --gff-file /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gff3 --db-file /data1/amliang/annotation/fly/flyase/gff/omniCLIP/dmel-all-r6.45.gff.db # <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">At the same time, you also need to prepare a reference genome sequence and divide it into chromosomes</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">like this <span class="hljs-keyword">in</span> : /data3/tmp_g/genome_anno/fly/genome/chroms</span><br>  2L.fa.gz<br>  2R.fa.gz<br>  3L.fa.gz<br>  3R.fa.gz<br>  4.fa.gz<br>  X.fa.gz<br>  Y.fa.gz<br></code></pre></td></tr></table></figure><h4 id="error"><a href="#error" class="headerlink" title="error"></a>error</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1) If an error message appears saying that like this:</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">   FileNotFoundError: [Errno 2] No such file or directory: <span class="hljs-string">&#x27;version.py&#x27;</span>,</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash"> just copy it from another directory to this directory.</span><br>cp /data1/tmp/soft/omniCLIP/version.py  yourPath/omniCLIP-0.2.0-py3.8-linux-x86_64.egg/omniCLIP/<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2) <span class="hljs-keyword">if</span> a error shows:</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash"> File <span class="hljs-string">&quot;yourPath/omniCLIP/data_parsing/ParsingArgs.py&quot;</span>, line 44, <span class="hljs-keyword">in</span> parsing_argparse</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">   NameError: name <span class="hljs-string">&#x27;verifying_args&#x27;</span> is not defined</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Just vim into ParsingArgs.py and comment out or delete this line of verifying_args : like picture</span><br></code></pre></td></tr></table></figure><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/debug.png" alt="debug"></p><h4 id="2-3-parsing-the-background-files"><a href="#2-3-parsing-the-background-files" class="headerlink" title="2.3). parsing the background files"></a>2.3). parsing the background files</h4><h6 id="Usually-RNA-SEQ-data-but-sometimes-input-data-is-used"><a href="#Usually-RNA-SEQ-data-but-sometimes-input-data-is-used" class="headerlink" title="(Usually RNA-SEQ data, but sometimes input data is used)"></a>(Usually RNA-SEQ data, but sometimes input data is used)</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP parsingBG --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db --genome-dir /data3/tmp_g/projects/omniCLIP/chroms/ --bg-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ctrl_IP1.bam --bg-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ctrl_IP2.bam  --out-file /data3/tmp_g/projects/SSX_CLIP/4.peak/CTRL.dat<br></code></pre></td></tr></table></figure><h4 id="2-4-parsing-the-CLIP-files"><a href="#2-4-parsing-the-CLIP-files" class="headerlink" title="2.4). parsing the CLIP files"></a>2.4). parsing the CLIP files</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP parsingCLIP --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db --genome-dir /data3/tmp_g/projects/omniCLIP/chroms/ --clip-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ssx_IP1.bam  --clip-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ssx_IP2.bam  --out-file /data3/tmp_g/projects/SSX_CLIP/4.peak/SSX.dat<br></code></pre></td></tr></table></figure><h4 id="2-5-Running-the-omniCLIP-algorithm"><a href="#2-5-Running-the-omniCLIP-algorithm" class="headerlink" title="2.5). Running the omniCLIP algorithm"></a>2.5). Running the omniCLIP algorithm</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP run_omniCLIP --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db  --bg-dat /data3/tmp_g/projects/SSX_CLIP/4.peak/CTRL.dat  --clip-dat /data3/tmp_g/projects/SSX_CLIP/4.peak/SSX.dat  --out-dir /data3/tmp_g/projects/SSX_CLIP/4.peak/reslut<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Brief Introduction</title>
    <link href="/2024/09/24/Brief-Introduction/"/>
    <url>/2024/09/24/Brief-Introduction/</url>
    
    <content type="html"><![CDATA[<p>Donâ€™t think Iâ€™m boring !</p><p>This is just a test text !</p><p>There will be more interesting things to share later !</p><p>ã€Šç¤¼è®°ã€‹é‡Œå¤è¯­æœ‰è¯´ï¼šâ€œå­¦ç„¶åŽçŸ¥ä¸è¶³ï¼Œæ•™ç„¶åŽçŸ¥å›°â€ï¼Œæˆ‘æ·±ä»¥ä¸ºç„¶ã€‚æˆ‘å¸Œæœ›åœ¨æ—¥å¸¸çš„æŠ€èƒ½åˆ†äº«ä¸­ï¼Œèƒ½å¤ŸåŠ©äºŽåŠ æ·±è‡ªå·±å¯¹æŠ€æœ¯çš„ç†è§£ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å¼€å§‹å†™ä¸ªäººåšå®¢æ–‡ç« çš„åˆè¡·ã€‚å¦‚æžœèƒ½é¡ºä¾¿å¸®åˆ°å…¶ä»–äººï¼Œé‚£å°±æ›´å¥½ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
