<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2024年总结</title>
    <link href="/2025/02/04/20250204-2024%E5%B9%B4%E6%80%BB%E7%BB%93/"/>
    <url>/2025/02/04/20250204-2024%E5%B9%B4%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h3 id="2024年总结"><a href="#2024年总结" class="headerlink" title="2024年总结"></a>2024年总结</h3><p>.</p><p>2024年，才刚刚过去，对于我来说，却已经有一些模糊了。粗粗回顾一下，并没有太多事情很需要被记住，就好像一瓢子舀上来的汤汤水水一样，都是稀的，泛善可陈。</p><p>硬要说干货的话，也许SXL的课题有了一个大致的轮廓算是一个进步吧，有毕业的希望了。我记得至少在2023年底的时候，我对自己啥时候能答辩是不抱有期望的，所以，我心里是感激的，感激这一年命运的眷顾和自己的付出。至少能看到进展了，尽管微不足道，但对我来说，它是希望和信心。</p><p>另一个可以说一下小事是，相比较于以前，我的运动量增加了不少，从8月份开始骑行以来，总里程有1400公里，这是远超过我往年的锻炼强度的，我几乎每周都要去东湖绿道骑车，这是好的方面，要保持。</p><p>除此以外，我好像都在经历失去，我变得更衰老了，头发也掉了不少，熟悉的人和事也从我生活中离开消失了，我时常处于一种隐隐的忧虑和孤独中，并且难以释怀。</p><p>另外，5月底，我骑电动车摔伤，做了骨折手术，12月份，父亲又做了心脏手术，不仅耗费不小，还让人被伤痛煎熬，希望新的一年全家安康。</p><p>其他窘境，则不一一列述了。</p><p>.</p><p>2025年，我希望能做到以下几件事：</p><p>一．顺利通过答辩，拿到博士学位。</p><p>二．体重减至125斤以下。</p><p>三．找一份合适的工作或者博后位置。</p><p>四．对自己有克制，彻底改掉骂脏话和暴躁的脾气。</p><p>五．编程能力有提高（能应付工作中的绝大部分问题）。</p><hr><p>.</p><p>希望我还能变成一个自信、磊落、正派的人。</p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Adjusting extremely small p-values in a volcano plot</title>
    <link href="/2025/02/02/20250202-Adjusting-extremely-small-p-values-in-a-volcano-plot/"/>
    <url>/2025/02/02/20250202-Adjusting-extremely-small-p-values-in-a-volcano-plot/</url>
    
    <content type="html"><![CDATA[<h3 id="Adjusting-extremely-small-p-values-in-a-volcano-plot"><a href="#Adjusting-extremely-small-p-values-in-a-volcano-plot" class="headerlink" title="Adjusting extremely small p-values in a volcano plot"></a>Adjusting extremely small p-values in a volcano plot</h3><p>.</p><p>When creating a volcano plot for differential gene expression, a few points (genes) with extremely small or even zero p-values can cause the Y-axis range to become very large. To zoom in Y-axis, it’s often necessary to either remove these extremely small p-values or replace them with more reasonable values.</p><p>.</p><p>This is the plot with the raw data.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240516&quot;</span><span class="hljs-punctuation">)</span><br><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>T_up <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_up&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>T_down <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_down&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;T_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br>T_S2<span class="hljs-operator">$</span>group <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> T_up<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;up&#x27;</span><span class="hljs-punctuation">,</span><br>                     ifelse<span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">%in%</span> T_down<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;down&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;non&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>ggplot<span class="hljs-punctuation">(</span>data <span class="hljs-operator">=</span> T_S2<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span>log2FoldChange <span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_point<span class="hljs-punctuation">(</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span> size<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> group<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>xlim<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">300</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_color_manual<span class="hljs-punctuation">(</span>values<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;darkred&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gray&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;darkblue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_vline<span class="hljs-punctuation">(</span>xintercept<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  labs<span class="hljs-punctuation">(</span>title<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;log2 Fold Change&#x27;</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;-log10(pvalue)&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>   <br>  theme<span class="hljs-punctuation">(</span>plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  theme<span class="hljs-punctuation">(</span>legend.text<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>        legend.title<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br><br></code></pre></td></tr></table></figure><p><img src="/2025/02/02/20250202-Adjusting-extremely-small-p-values-in-a-volcano-plot/raw.png" alt="raw"></p><p>.</p><p>Set the Y-axis range to 150. For points with -log10(p-value) greater than 150, assign values within the range of 145 ± 5.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>p_value10 <span class="hljs-operator">&lt;-</span> subset<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span><span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>pvalue<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">150</span><span class="hljs-punctuation">)</span><br>pval_jitter <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">round</span><span class="hljs-punctuation">(</span>rnorm<span class="hljs-punctuation">(</span>nrow<span class="hljs-punctuation">(</span>p_value10<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>mean <span class="hljs-operator">=</span> <span class="hljs-number">145</span><span class="hljs-punctuation">,</span>sd<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>pval_jitter <span class="hljs-operator">&lt;-</span> 1<span class="hljs-operator">*</span><span class="hljs-number">10</span><span class="hljs-operator">^</span><span class="hljs-operator">-</span>pval_jitter<br>p_value10<span class="hljs-operator">$</span>pvalue <span class="hljs-operator">&lt;-</span> pval_jitter<br><br>p_value_raw <span class="hljs-operator">&lt;-</span> subset<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span><span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>pvalue<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;=</span> <span class="hljs-number">150</span><span class="hljs-punctuation">)</span><br><br>df <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>p_value_raw<span class="hljs-punctuation">,</span>p_value10<span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>.</p><p>This is the modified version of the plot</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>ggplot<span class="hljs-punctuation">(</span>data <span class="hljs-operator">=</span> df<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span>log2FoldChange <span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_point<span class="hljs-punctuation">(</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span> size<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> group<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>xlim<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">160</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_color_manual<span class="hljs-punctuation">(</span>values<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;darkred&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gray&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;darkblue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_vline<span class="hljs-punctuation">(</span>xintercept<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  labs<span class="hljs-punctuation">(</span>title<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;log2 Fold Change&#x27;</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;-log10(pvalue)&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme<span class="hljs-punctuation">(</span>panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>   <br>  theme<span class="hljs-punctuation">(</span>plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>        axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>        axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  theme<span class="hljs-punctuation">(</span>legend.text<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>        legend.title<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <br><br></code></pre></td></tr></table></figure><p><img src="/2025/02/02/20250202-Adjusting-extremely-small-p-values-in-a-volcano-plot/modified.png" alt="modified"></p><hr><p>en, It looks much better.</p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-02-01 寒假在家</title>
    <link href="/2025/02/01/20250201-%E5%AF%92%E5%81%87/"/>
    <url>/2025/02/01/20250201-%E5%AF%92%E5%81%87/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-02-01-寒假在家"><a href="#2025-02-01-寒假在家" class="headerlink" title="2025-02-01 寒假在家"></a>2025-02-01 寒假在家</h3><p>.</p><p>1月27日晚上回去，2月1日早上回到武汉，在姐姐家过的年。</p><p>.</p><p>1月28日中午才到家，刚好赶上团圆饭。</p><p>相比于学校食堂的饭菜，家里简直是天堂，尤其最爱湖南的油豆腐片，炒什么都很好吃，连鸡肉都比菜市场买的要香很多，还有芹菜牛肉很下饭。</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E9%99%A4%E5%A4%95%E5%9C%A8%E5%AE%B6%20%E9%83%BD%E6%98%AF%E6%B9%96%E5%8D%97%E8%8F%9C.jpg" alt="除夕在家 都是湖南菜"></p><p>.</p><p>29日，大年初一，吃过午饭后，去旁边的一个公园玩，里面有一个废弃的火车站。前面是诺诺和我爸，北方的冬天，外边很冷，但多数时候是出太阳。</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E6%9C%97%E5%9B%AD%E9%87%8C%E7%9A%84%E4%B8%AD%E5%A4%AE%E7%81%AB%E8%BD%A6%E7%AB%99.jpg" alt="朗园里的中央火车站"></p><p>.</p><p>30日全家去八达岭长城，爸妈爬了一小段就没继续爬上去，姐姐找不到停车位，就带着航航去了很远的停车场，也没爬。最后是我和诺诺四个人爬的。</p><p>这次我们爬的是南长城，人居多。</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E9%95%BF%E5%9F%8E.jpg" alt="长城"></p><p>山脚下的戚继光石像。</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E5%85%AB%E8%BE%BE%E5%B2%AD%E9%95%BF%E5%9F%8E%E8%84%9A%E4%B8%8B%E6%88%9A%E7%BB%A7%E5%85%89%E5%83%8F.jpg" alt="八达岭长城脚下戚继光像"></p><p>.</p><p>31日，我们去的圆明园，也是人很多。</p><p>这是圆明园最大的一个湖，叫福海，湖面都结冰了。</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E5%9C%86%E6%98%8E%E5%9B%AD%20%E6%B9%96%E9%9D%A2%E7%BB%93%E5%86%B0%E7%9A%84%E7%A6%8F%E6%B5%B7.jpg" alt="圆明园 湖面结冰的福海"></p><p>100多年前被浸略者捣毁的建筑废墟，我辈当自强！</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E5%9C%86%E6%98%8E%E5%9B%AD%20%E8%A2%AB%E6%8D%A3%E6%AF%81%E7%9A%84%E5%BA%9F%E5%A2%9F.jpg" alt="圆明园 被捣毁的废墟"></p><p>.</p><p>2月1日早上到达汉口站，新的一年工作开始，希望顺利。</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E6%97%A9%E6%99%A8%E7%9A%84%E6%B1%89%E5%8F%A3%E7%81%AB%E8%BD%A6%E7%AB%99.jpg" alt="早晨的汉口火车站"></p><p>.</p><p>宿舍的植物和小金鱼都好好的，只是几棵富贵竹因为低温冻的叶子快枯萎了。</p><p><img src="/2025/02/01/20250201-%E5%AF%92%E5%81%87/%E5%AE%BF%E8%88%8D.jpg" alt="宿舍"></p><hr><p>洗漱之后，收拾床铺被子，下午开始工作了。</p><p>Good Luck</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-01-27 休假</title>
    <link href="/2025/01/28/20250127-%E4%BC%91%E5%81%87/"/>
    <url>/2025/01/28/20250127-%E4%BC%91%E5%81%87/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-01-27-休假"><a href="#2025-01-27-休假" class="headerlink" title="2025-01-27 休假"></a>2025-01-27 休假</h3><p>.</p><p>27开始休假了，早上起来洗了衣服，中午去绿道骑行一圈。</p><p>这次的路线还是绕汤菱湖，到白马州，再经落雁景区到后湖，然后回学校，大概38公里。</p><p>.</p><p>从水生所门出，经过医学部到梨园，阳光很好。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E6%A2%A8%E5%9B%AD.jpg" alt="梨园"></p><p>.</p><p>靠近武汉站附近的白马州，这条直道，每次我过都拍一张，很幽静。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E9%9D%A0%E8%BF%91%E6%AD%A6%E6%B1%89%E7%81%AB%E8%BD%A6%E7%AB%99.jpg" alt="靠近武汉火车站"></p><p>.</p><p>经过落雁景区，停留1分钟拍了张照片。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E8%90%BD%E9%9B%81%E6%99%AF%E5%8C%BA.jpg" alt="落雁景区"></p><p>.</p><p>落雁岛，这次我才看清真的有大雁在岛上落栖，好多大雁。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E4%B8%9C%E6%B9%96%E8%90%BD%E9%9B%81%E5%B2%9B.jpg" alt="东湖落雁岛"></p><p>.</p><p>路过刘备祭天台，还有关帝庙，我登顶俯瞰东湖，这里大概是一个能带来好运的地方。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E4%B8%9C%E6%B9%96%E5%88%98%E5%A4%87%E7%A5%AD%E5%A4%A9%E5%8F%B0.jpg" alt="东湖刘备祭天台"></p><p>.</p><p>回程的路上，经过梅园，树上挂了好多红灯笼，春节的喜庆感。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E4%B8%9C%E6%B9%96%E6%A2%85%E5%9B%AD.jpg" alt="东湖梅园"></p><p>.</p><p>过了梅园不久的地方，可以看到湖对岸的梨园，也许是徐东，还有那个升在天空的氦气球。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E5%AF%B9%E9%9D%A2%E6%98%AF%E6%A2%A8%E5%9B%AD.jpg" alt="对面是梨园"></p><p>.</p><p>晚上在宿舍楼顶收衣服，看到楚河汉街灯火辉煌，最远处就是万达嘉华吧。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E5%B7%A5%E5%AD%A6%E9%83%A8%E5%AE%BF%E8%88%8D%E5%A4%A9%E5%8F%B0.jpg" alt="工学部宿舍天台"></p><p>.</p><p>晚上11点到达汉口站，去北京姐姐家过年。</p><p>本来坐地铁的，发现要迟到了，就在洪山地铁站下了地铁，换成了打车过去，以后要早点出发。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E6%B1%89%E5%8F%A3%E7%81%AB%E8%BD%A6%E7%AB%99.jpg" alt="汉口火车站"></p><p>.</p><p>在车上睡了一晚，早上已经到河北。</p><p>最喜欢这种一望无边的平原麦田了。尤其是冬天有阳光的时候。</p><p>再过不久，这里将是，一畦春韭绿，十里稻花香。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E8%BF%87%E4%BF%9D%E5%AE%9A%E4%B8%8D%E8%BF%9C.jpg" alt="过保定不远"></p><p>.</p><p>奇怪的是，没过多远，居然是雪地。</p><p><img src="/2025/01/28/20250127-%E4%BC%91%E5%81%87/%E4%BF%9D%E5%AE%9A%E9%9B%AA%E6%99%AF.jpg" alt="保定雪景"></p><p>.</p><p>马上到站了。</p><hr><p>.</p><p>希望2025年能好运！</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Homologous gene conversion across different species</title>
    <link href="/2025/01/24/20250124-Homologous-gene-conversion-across-different-species/"/>
    <url>/2025/01/24/20250124-Homologous-gene-conversion-across-different-species/</url>
    
    <content type="html"><![CDATA[<h3 id="Homologous-gene-conversion-across-different-species"><a href="#Homologous-gene-conversion-across-different-species" class="headerlink" title="Homologous gene conversion across different species"></a>Homologous gene conversion across different species</h3><p>.</p><p> Here, we use three mouse genes as an example. The method is the same for more genes.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>library<span class="hljs-punctuation">(</span>homologene<span class="hljs-punctuation">)</span><br>genelist<span class="hljs-operator">&lt;-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Acadm&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Eno2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Acadvl&quot;</span><span class="hljs-punctuation">)</span><br>homologene<span class="hljs-punctuation">(</span>genelist<span class="hljs-punctuation">,</span> inTax <span class="hljs-operator">=</span> <span class="hljs-number">10090</span><span class="hljs-punctuation">,</span> outTax <span class="hljs-operator">=</span> <span class="hljs-number">9606</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># Use homologene function for gene conversion</span><br><span class="hljs-comment"># genelist: the gene list to be converted</span><br><span class="hljs-comment"># inTax: the taxonomic ID of the species for the input gene list, 10090 for mouse</span><br><span class="hljs-comment"># outTax: the taxonomic ID of the species to convert to, 9606 for human</span><br></code></pre></td></tr></table></figure><p>.</p><p>result:</p><p><img src="/2025/01/24/20250124-Homologous-gene-conversion-across-different-species/convert%20mouse%20to%20human.png" alt="convert mouse to human"></p><p>.</p><p>The species IDs supported by Homologene </p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">homologene<span class="hljs-operator">::</span>taxData<br></code></pre></td></tr></table></figure><p>.</p><p>For commonly used organisms like mice and humans, there are even dedicated functions available</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R">mouse2human<span class="hljs-punctuation">(</span>genelist<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># and human to mouse</span><br>human2mouse<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ACADM&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ENO2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ACADVL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>human2mouse<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;H1.2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;TP53&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># and dme to homo</span><br>genelist<span class="hljs-operator">&lt;-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Sxl&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;msl-2&quot;</span><span class="hljs-punctuation">)</span><br>homologene<span class="hljs-operator">::</span>taxData<br>homologene<span class="hljs-punctuation">(</span>genelist<span class="hljs-punctuation">,</span> inTax <span class="hljs-operator">=</span> <span class="hljs-number">7227</span><span class="hljs-punctuation">,</span> outTax <span class="hljs-operator">=</span> <span class="hljs-number">9606</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><hr><p>ref : <a href="https://cloud.tencent.com/developer/article/2115727">https://cloud.tencent.com/developer/article/2115727</a></p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-01-20 晚东湖骑行</title>
    <link href="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/"/>
    <url>/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-01-20晚-东湖骑行"><a href="#2025-01-20晚-东湖骑行" class="headerlink" title="2025-01-20晚 东湖骑行"></a>2025-01-20晚 东湖骑行</h3><p>.</p><p>.</p><p>我经常晚上下班后，会去东湖绿道骑行一圈，大约30公里。</p><p>这是我很轻松的时候，周围的风景也很好。</p><hr><p>快过年了，路灯上挂了红色中国结。</p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/1.%E9%9D%A0%E8%BF%91%E6%AD%A6%E6%B1%89%E7%81%AB%E8%BD%A6%E7%AB%99%E9%99%84%E8%BF%91%E7%9A%84%E7%BB%BF%E9%81%93.jpg" alt="1.靠近武汉火车站附近的绿道"></p><p>.</p><p>万家灯火。</p><p>蒙着薄雾，隐约中的房间，看起来像我想象中的太空城，以前读三体的时候，经常未来的世界是什么样的？</p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/2.%E9%9D%A0%E8%BF%91%E6%AD%A6%E6%B1%89%E7%AB%99%E7%9A%84%E7%BB%BF%E9%81%93.jpg" alt="2.靠近武汉站的绿道"></p><p>.</p><p>晚上10点，这一条长廊很安静。</p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/3.%E8%8D%86%E6%A5%9A%E9%9B%84%E9%A3%8E%E9%99%84%E8%BF%91.jpg" alt="3.荆楚雄风附近"></p><p>.</p><p>每一次晚上骑行路过这里，都会拍一张这棵夜空下的小树。</p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/4.%E4%B8%9C%E6%B9%96%E4%B9%8B%E7%9C%BC%E9%99%84%E4%BB%B6.jpg" alt="4.东湖之眼附件"></p><p>.</p><p>一棵掉光了叶子的树，天空还有一架路过的飞机，也许没有叶子更好看一些。</p><p><img src="/2025/01/22/2025-01-19%E6%99%9A%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/5.%E4%B8%9C%E6%B9%96%E4%B9%8B%E7%9C%BC%E8%87%B3%E6%A2%85%E5%9B%AD%E7%A0%81%E5%A4%B4%E9%99%84%E4%BB%B6.jpg" alt="5.东湖之眼至梅园码头附件"></p><p>我以前很少会发现，我身处这样美丽的风景中。</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Plotting the transcript structure of a gene</title>
    <link href="/2025/01/12/20250112-Plotting-the-transcript-structure-of-a-gene/"/>
    <url>/2025/01/12/20250112-Plotting-the-transcript-structure-of-a-gene/</url>
    
    <content type="html"><![CDATA[<h3 id="Plotting-the-transcript-structure-of-a-gene"><a href="#Plotting-the-transcript-structure-of-a-gene" class="headerlink" title="Plotting the transcript structure of a gene"></a>Plotting the transcript structure of a gene</h3><p>.</p><p>Sometimes, we need to display the different transcript structures of a gene.  And this R script is designed for quickly accomplishing this task.</p><p>First, we need an annotation file that contains information about the gene transcripts.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>rtracklayer<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>transPlotR<span class="hljs-punctuation">)</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220910_annotation/Drosaphila/&quot;</span><span class="hljs-punctuation">)</span><br>gene.anno <span class="hljs-operator">&lt;-</span> import<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Drosophila_melanogaster.BDGP6.32.105.gtf&quot;</span> <span class="hljs-punctuation">,</span>format <span class="hljs-operator">=</span> <span class="hljs-string">&quot;gtf&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>gene.anno<span class="hljs-punctuation">)</span><br><br><br>trancriptVis<span class="hljs-punctuation">(</span>gtfFile <span class="hljs-operator">=</span> gene.anno<span class="hljs-punctuation">,</span><br>             gene <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Rala&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ssx&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># Target gene to plot</span><br>             facetByGene <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>             addNormalArrow <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span><br>             newStyleArrow <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>             base_size <span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># Theme basesize, default(14).</span><br>             textLabel<span class="hljs-operator">=</span><span class="hljs-string">&quot;transcript_name&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># The text label aesthetic mappings, default(&#x27;transcript_id&#x27;)</span><br>             textLabelSize<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># The text label size</span><br>             textLabelColor <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># The text label color</span><br>             intronSize<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># Intron line size</span><br>             exonWidth<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span>     <span class="hljs-comment"># exon width </span><br>             relTextDist<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># marked_name relative to exon</span><br>             reverse.y<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><br>             xAxis.info<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># Whether retain X axis ticks and text</span><br><br><br><br></code></pre></td></tr></table></figure><p>output：</p><p><img src="/2025/01/12/20250112-Plotting-the-transcript-structure-of-a-gene/all%20transcripts%20for%20genes.png" alt="all transcripts for genes"></p><p>.</p><p>.</p><p>If we only want to display the specific transcripts of a gene that we are interested in, we can use this script as follows:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># select and plot only the target transcript by myTranscript (&quot;transcript&quot;_id)</span><br>trancriptVis<span class="hljs-punctuation">(</span>gtfFile <span class="hljs-operator">=</span> gene.anno<span class="hljs-punctuation">,</span><br>             gene <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;ssx&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>             myTranscript <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;FBtr0070215&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;FBtr0339773&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             addNormalArrow <span class="hljs-operator">=</span> <span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span><br>             newStyleArrow <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>             base_size <span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span> <br>             textLabel<span class="hljs-operator">=</span><span class="hljs-string">&quot;transcript_name&quot;</span><span class="hljs-punctuation">,</span> <br>             textLabelSize<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <br>             textLabelColor <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span> <br>             intronSize<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <br>             exonWidth<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span>     <br>             relTextDist<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">,</span> <br>             reverse.y<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><br>             xAxis.info<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span> <br></code></pre></td></tr></table></figure><p>output：</p><p><img src="/2025/01/12/20250112-Plotting-the-transcript-structure-of-a-gene/only%20target%20transcripts.png" alt="only target transcripts"></p><hr><p>There are better ways to solve this problem.</p><p> link:</p><p><a href="https://www.jingege.wang/2022/06/04/ggtranscript/">https://www.jingege.wang/2022/06/04/ggtranscript/</a></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Calculate the GC content in a DNA/RNA sequence</title>
    <link href="/2025/01/10/20250110-to-calculate-the-GC-content-in-a-DNARNA-sequence/"/>
    <url>/2025/01/10/20250110-to-calculate-the-GC-content-in-a-DNARNA-sequence/</url>
    
    <content type="html"><![CDATA[<h3 id="Calculate-the-GC-content-in-a-DNA-RNA-sequence"><a href="#Calculate-the-GC-content-in-a-DNA-RNA-sequence" class="headerlink" title="Calculate the GC content in a DNA&#x2F;RNA sequence"></a>Calculate the GC content in a DNA&#x2F;RNA sequence</h3><p>.</p><p>This is a simple initial Python script to calculate the GC content of DNA&#x2F;RNA sequences, specifically for cases where each FASTA file contains only one sequence.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> os,sys,re<br>ms, infile, outfile = sys.argv<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(infile) <span class="hljs-keyword">as</span> f:<br>    f=f.read()  <br>    f=re.sub(<span class="hljs-string">&#x27;&gt;.*\n|\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, f)  <br>    <span class="hljs-string">&quot;&quot;&quot;Remove the header line and newline characters&quot;&quot;&quot;</span><br>    <br>    size=<span class="hljs-built_in">len</span>(f)<br>    nG=f.count(<span class="hljs-string">&quot;g&quot;</span>)+f.count(<span class="hljs-string">&quot;G&quot;</span>)<br>    nC=f.count(<span class="hljs-string">&quot;c&quot;</span>)+f.count(<span class="hljs-string">&quot;C&quot;</span>)<br>    percent_GC=(nG+nC)/size<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(outfile, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> out:<br>    out.write(<span class="hljs-string">&quot;ID\tsize\tpercent_gc\n&quot;</span>)<br>    ID=re.sub(<span class="hljs-string">&#x27;.fasta&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, infile)<br>    out.write(<span class="hljs-string">&quot;&#123;&#125;\t&#123;&#125;\t&#123;&#125;\n&quot;</span>.<span class="hljs-built_in">format</span>(ID, size, percent_GC))<br>    <span class="hljs-string">&quot;&quot;&quot;Add a newline character (\n) at the end of each line in output_file&quot;&quot;&quot;</span><br>   <br><br><span class="hljs-comment">#use : python3 GC_content.py input.fa out.file </span><br><br></code></pre></td></tr></table></figure><p>.</p><p>After encapsulating the script into an executable file named <strong>GC_content.py</strong> ,  then use it on Linux as follows:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls *fa |while read id ;do(python GC_content.py $id $&#123;id&#125;.out.txt);done &amp;&amp; cat *out.txt &gt; output.txt<br></code></pre></td></tr></table></figure><p>.</p><p>output：</p><p>The last column is the calculated GC content ratio for the corresponding sequence.</p><p><img src="/2025/01/10/20250110-to-calculate-the-GC-content-in-a-DNARNA-sequence/outfile%20of%20GC_content.png" alt="outfile of GC_content"></p><p>.</p><p>.</p><p>If a the fasta file contains multiple sequences, we can use this python script following:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> Bio <span class="hljs-keyword">import</span> SeqIO<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_gc_content</span>(<span class="hljs-params">sequence</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;define a function to calculate the GC percentage for sequence&quot;&quot;&quot;</span><br>    sequence = sequence.upper()<br>    gc_count = sequence.count(<span class="hljs-string">&#x27;G&#x27;</span>) + sequence.count(<span class="hljs-string">&#x27;C&#x27;</span>)<br>    total_count = <span class="hljs-built_in">len</span>(sequence)<br>    <span class="hljs-keyword">if</span> total_count == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> (gc_count / total_count) * <span class="hljs-number">100</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_fasta_file</span>(<span class="hljs-params">input_file, output_file</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;process a fasta file and calculate the GC content of each sequence&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> output:<br>        <span class="hljs-comment"># 读取FASTA文件</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-string">&quot;&quot;&quot;file is input_file&quot;&quot;&quot;</span><br>            <span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> SeqIO.parse(file, <span class="hljs-string">&quot;fasta&quot;</span>):<br>                seq_id = record.<span class="hljs-built_in">id</span><br>                <span class="hljs-string">&quot;&quot;&quot;Obtain the ID of the current sequence,usually the part following the &gt; in the FASTA file header&quot;&quot;&quot;</span><br>                sequence = <span class="hljs-built_in">str</span>(record.seq)<br>                <span class="hljs-string">&quot;&quot;&quot;Convert the sequence object (record.seq) into a string format&quot;&quot;&quot;</span><br>                gc_content = calculate_gc_content(sequence)<br>                output.write(<span class="hljs-string">f&quot;&gt;<span class="hljs-subst">&#123;seq_id&#125;</span> GC_content: <span class="hljs-subst">&#123;gc_content:<span class="hljs-number">.2</span>f&#125;</span>%\n&quot;</span>)<br>                <span class="hljs-string">&quot;&quot;&quot;the format for output.write is: &gt;sequence ID GC_content: GC content%, where .2f indicates that the GC_content will be rounded to two decimal places&quot;&quot;&quot;</span><br><br>                <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># 判断该脚本是否作为主程序执行。如果是，则执行以下代码(如果脚本被导入作为模块则不会执行)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Usage: python3 calculate_gc_content.py input_file output_file&quot;</span>)<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    input_file = sys.argv[<span class="hljs-number">1</span>]<br>    output_file = sys.argv[<span class="hljs-number">2</span>]<br><br>    <span class="hljs-string">&quot;&quot;&quot;Execute the file processing&quot;&quot;&quot;</span><br>    process_fasta_file(input_file, output_file)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;GC content calculation completed. Results saved to <span class="hljs-subst">&#123;output_file&#125;</span>.&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>.</p><p>After encapsulating the script into an executable file named <strong>calculate_gc_content.py</strong>, then use it on Linux as follows:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python3 calculate_gc_content.py input_file output_file<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Add full name and description for target genes</title>
    <link href="/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/"/>
    <url>/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/</url>
    
    <content type="html"><![CDATA[<h3 id="Add-full-name-and-description-for-target-genes"><a href="#Add-full-name-and-description-for-target-genes" class="headerlink" title="Add full name and description for target genes"></a>Add full name and description for target genes</h3><p>.</p><p>Some genes’ functions may not be easily inferred from their abbreviated names, therefore, to be better understand the genes, we need to include their full names and other forms of ID numbers for the target genes.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ------</span><br><span class="hljs-comment"># function and detail description of target genes by gtf</span><br><br><span class="hljs-comment"># anno.</span><br>library<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">)</span><br>eg2Symbol<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egSYMBOL<span class="hljs-punctuation">)</span><br>eg2name<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egGENENAME<span class="hljs-punctuation">)</span><br>eg2ENSEMBL<span class="hljs-operator">=</span>toTable<span class="hljs-punctuation">(</span>org.Dm.egENSEMBL<span class="hljs-punctuation">)</span><br>anno<span class="hljs-operator">=</span>merge<span class="hljs-punctuation">(</span>eg2ENSEMBL<span class="hljs-punctuation">,</span>merge<span class="hljs-punctuation">(</span>eg2Symbol<span class="hljs-punctuation">,</span>eg2name<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;gene_id&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;gene_id&#x27;</span><span class="hljs-punctuation">)</span>  <br>colnames<span class="hljs-punctuation">(</span>anno<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ENTREID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Gene_name&quot;</span><span class="hljs-punctuation">)</span><br>anno <span class="hljs-operator">&lt;-</span> anno<span class="hljs-punctuation">[</span><span class="hljs-operator">!</span>duplicated<span class="hljs-punctuation">(</span>anno<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># target genes</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/RiboSeq/featureCount_CDS_multi/&quot;</span><span class="hljs-punctuation">)</span><br>target_genes <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;riborex_translation.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;tranlation_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># add detail description to target genes</span><br>new_target_genes <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>target_genes<span class="hljs-punctuation">,</span>anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>intersect<span class="hljs-punctuation">(</span>anno<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span>target_genes<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># save</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240222_question.daily/17.detail.description_diff_translation.genes/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>openxlsx<span class="hljs-punctuation">)</span><br>wb <span class="hljs-operator">&lt;-</span> createWorkbook<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>addWorksheet<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;new_target_genes&quot;</span><span class="hljs-punctuation">)</span><br>writeData<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;new_target_genes&quot;</span><span class="hljs-punctuation">,</span> new_target_genes<span class="hljs-punctuation">,</span>startCol <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> startRow <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> rowNames <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>saveWorkbook<span class="hljs-punctuation">(</span>wb<span class="hljs-punctuation">,</span> file<span class="hljs-operator">=</span><span class="hljs-string">&#x27;target_genes_with_detial_description.xlsx&#x27;</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>output file :</p><p>the full names are indicated by the red box.</p><p><img src="/2025/01/10/Add-Full-Name-and-Description-for-Target-Gene/target%20genes%20with%20their%20full%20names%20already%20added.png" alt="target genes with their full names already added"></p>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Highlighting the target gene in scatterplot</title>
    <link href="/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/"/>
    <url>/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/</url>
    
    <content type="html"><![CDATA[<h3 id="Highlighting-the-target-gene-in-scatterplot"><a href="#Highlighting-the-target-gene-in-scatterplot" class="headerlink" title="Highlighting the target gene in scatterplot"></a>Highlighting the target gene in scatterplot</h3><p>.</p><p>the scatter points with different colors and sizes  were used to distinguish the target gene from other genes, and labeled the target gene with  gene symbol.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs R"><br><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>latex2exp<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>mdthemes<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggrepel<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240506&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>diff_gene_all <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;DEGs_240506.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;new.diff_gene_all_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br>new.res<span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>diff_gene_all<span class="hljs-punctuation">)</span> <br>new.res<span class="hljs-operator">$</span>group <span class="hljs-operator">=</span> as.factor<span class="hljs-punctuation">(</span>ifelse<span class="hljs-punctuation">(</span> <span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>new.res<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> new.res<span class="hljs-operator">$</span>padj<span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><br>                                  ifelse<span class="hljs-punctuation">(</span>new.res<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Up&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Down&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                                  <span class="hljs-string">&quot;NS&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>target_gene_1 <span class="hljs-operator">&lt;-</span> new.res<span class="hljs-punctuation">[</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Ugt37A3&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;CG43845&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span>   <br>target_gene_2 <span class="hljs-operator">&lt;-</span> new.res<span class="hljs-punctuation">[</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Sox21a&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;CG14669&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>new.res_F <span class="hljs-operator">&lt;-</span> filter<span class="hljs-punctuation">(</span>new.res<span class="hljs-punctuation">,</span><span class="hljs-operator">!</span>new.res<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> target_gene_1<span class="hljs-operator">$</span>gene_symbol <span class="hljs-punctuation">)</span><br>new.res_F <span class="hljs-operator">&lt;-</span> filter<span class="hljs-punctuation">(</span>new.res_F<span class="hljs-punctuation">,</span><span class="hljs-operator">!</span>new.res_F<span class="hljs-operator">$</span>gene_symbol <span class="hljs-operator">%in%</span> target_gene_2<span class="hljs-operator">$</span>gene_symbol <span class="hljs-punctuation">)</span><br><br>My_Theme <span class="hljs-operator">=</span> theme<span class="hljs-punctuation">(</span><br>  panel.background <span class="hljs-operator">=</span> element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  panel.grid <span class="hljs-operator">=</span>element_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">16</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  text <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>  axis.text.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>  axis.text.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>   <br>  axis.title.x <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <br>  axis.title.y <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  legend.text<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>  legend.title<span class="hljs-operator">=</span>element_text<span class="hljs-punctuation">(</span>size<span class="hljs-operator">=</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br>ggplot<span class="hljs-punctuation">(</span>data <span class="hljs-operator">=</span> new.res_F<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>  geom_point<span class="hljs-punctuation">(</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.3</span><span class="hljs-punctuation">,</span> size<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>aes<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> group<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  scale_color_manual<span class="hljs-punctuation">(</span>values<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gray&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;blue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span> <br>  geom_vline<span class="hljs-punctuation">(</span>xintercept<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_hline<span class="hljs-punctuation">(</span>yintercept <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span><span class="hljs-number">0.05</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>lty<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">0.2</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  labs<span class="hljs-punctuation">(</span>title<span class="hljs-operator">=</span><span class="hljs-string">&quot;differential expr. genes&quot;</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;log2 Fold Change&#x27;</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;-log10 p-value&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  xlim<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  <br>  ylim<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">300</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  My_Theme <span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_1<span class="hljs-punctuation">,</span> <br>             aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             size<span class="hljs-operator">=</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span> col<span class="hljs-operator">=</span><span class="hljs-string">&quot;darkred&quot;</span><span class="hljs-punctuation">,</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_2<span class="hljs-punctuation">,</span> <br>             aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             size<span class="hljs-operator">=</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span> col<span class="hljs-operator">=</span><span class="hljs-string">&quot;darkblue&quot;</span><span class="hljs-punctuation">,</span>alpha<span class="hljs-operator">=</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_text_repel<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_1<span class="hljs-punctuation">,</span><br>                  aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>label<span class="hljs-operator">=</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                  color<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>  geom_text_repel<span class="hljs-punctuation">(</span>data<span class="hljs-operator">=</span>target_gene_2<span class="hljs-punctuation">,</span><br>                  aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> log2FoldChange<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-operator">-</span>log10<span class="hljs-punctuation">(</span>pvalue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>label<span class="hljs-operator">=</span>gene_symbol<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                  color<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><br><br></code></pre></td></tr></table></figure><p>output files :</p><p><img src="/2025/01/06/250105_highlighting%20the%20target%20gene%20in%20scatterplot%20by%20R/differential%20expression%20genes.png" alt="differential expression genes"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Differential translation gene by RiboSeq</title>
    <link href="/2025/01/02/differential-translation-gene-by-RiboSeq/"/>
    <url>/2025/01/02/differential-translation-gene-by-RiboSeq/</url>
    
    <content type="html"><![CDATA[<h3 id="Ribo-Seq-analysis-for-mRNA-translation"><a href="#Ribo-Seq-analysis-for-mRNA-translation" class="headerlink" title="Ribo-Seq analysis for mRNA translation"></a>Ribo-Seq analysis for mRNA translation</h3><p>.</p><p>we use Ribo-Seq in combination with RNA-Seq data to investigate the sig. differential translation genes in transcriptome by condition.</p><h4 id="1-Data-prepare"><a href="#1-Data-prepare" class="headerlink" title="1.  Data prepare"></a>1.  Data prepare</h4><h6 id="1-1-verify-the-integrity-of-raw-sequence-data"><a href="#1-1-verify-the-integrity-of-raw-sequence-data" class="headerlink" title="1.1  verify the integrity of raw sequence data"></a>1.1  verify the integrity of raw sequence data</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls *fastq.gz | xargs  md5sum &gt; md5.lam.txt<br></code></pre></td></tr></table></figure><h6 id="1-2-quality-control"><a href="#1-2-quality-control" class="headerlink" title="1.2  quality control"></a>1.2  quality control</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir qc_raw &amp;&amp; cd qc_raw<br>source activate rnaseq<br>ls ../*.gz | xargs fastqc -o ./<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h5 id><a href="#" class="headerlink" title></a></h5><h6 id="1-3-adapter-trimming"><a href="#1-3-adapter-trimming" class="headerlink" title="1.3  adapter trimming"></a>1.3  adapter trimming</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir clean.SE &amp;&amp; cd clean.SE<br>source activate rnaseq<br>dir=&#x27;/data1/amliang/projects/sxl_DC/2308_RiboSeq/231221_Ribo_S2/rawdata/clean.SE&#x27;<br>trim_galore -q 25 --phred33 -a AAAAAAAAAA  --clip_R1 4  --length 20  -e 0.1 --stringency 3  -o $dir   ../*.R1.fastq.gz <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">&amp;&amp; and QC</span> <br>mkdir qc_clean.SE &amp;&amp; cd qc_clean.SE<br>ls ../clean.SE/*.gz | xargs fastqc -o ./<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="2-remove-rRNA"><a href="#2-remove-rRNA" class="headerlink" title="2. remove rRNA"></a>2. remove rRNA</h4><h6 id="2-1-download-rRNA-fasta"><a href="#2-1-download-rRNA-fasta" class="headerlink" title="2.1 download rRNA fasta"></a>2.1 download rRNA fasta</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget -c https://ftp.ncbi.nlm.nih.gov/genomes/refseq/invertebrate/Drosophila_melanogaster/latest_assembly_versions/GCF_000001215.4_Release_6_plus_ISO1_MT/GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">rRNA index building</span><br>less GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz | grep &quot;^&gt;&quot; | grep &quot;gbkey=rRNA&quot; | awk &#x27;&#123;print $1&#125;&#x27;|sed &#x27;s/&gt;//g&#x27; &gt; id.rRNA.list<br>source activate py2<br>seqkit grep -f id.rRNA.list  GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz  &gt; rRNA.fa<br><br>mkdir rRNA &amp;&amp; cd rRNA <br>bowtie2-build ../rRNA.fa  rRNA<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">tRNA index building</span><br>less GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz | grep &quot;^&gt;&quot; | grep &quot;gbkey=tRNA&quot; | awk &#x27;&#123;print $1&#125;&#x27;|sed &#x27;s/&gt;//g&#x27; &gt; id.tRNA.list<br>source activate py2<br>seqkit grep -f id.tRNA.list  GCF_000001215.4_Release_6_plus_ISO1_MT_rna_from_genomic.fna.gz  &gt; tRNA.fa<br><br>mkdir tRNA &amp;&amp; cd tRNA <br>bowtie2-build ../tRNA.fa  rRNA<br><br></code></pre></td></tr></table></figure><h6 id="2-2-remove-rRNA-and-tRNA"><a href="#2-2-remove-rRNA-and-tRNA" class="headerlink" title="2.2 remove rRNA and tRNA"></a>2.2 remove rRNA and tRNA</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">remove rRNA by mapping reads to rRNA</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">save reads <span class="hljs-built_in">which</span> unmapped as non_rRNA reads</span><br>mkdir rm.rRNA &amp;&amp; cd rm.rRNA<br>ln -s ../clean.SE/*gz ./<br><br>source activate rnaseq<br>ls ./*.gz | while read id; do (echo $id &amp;&amp; bowtie2  -p 18  -x /data1/amliang/reference/rRNA/Drosophila.M/rRNA/rRNA --un-gz $(basename $&#123;id&#125; &quot;.fq.gz&quot;).rm.rRNA.fq.gz  -U $id  -S $(basename $&#123;id&#125; &quot;.fq.gz&quot;).rRNA.sam);done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">remove rRNA by mapping reads to rRNA</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">save reads <span class="hljs-built_in">which</span> unmapped as non_rRNA reads</span><br>mkdir rm.tRNA &amp;&amp; cd rm.tRNA<br>ln -s ../rm.tRNA/*.rm.rRNA.fq.gz ./<br><br>ls ./*.rm.rRNA.fq.gz | while read id; do (echo $id &amp;&amp; bowtie2  -p 18  -x /data1/amliang/reference/rRNA/Drosophila.M/tRNA/tRNA --un-gz $(basename $&#123;id&#125; &quot;.rm.rRNA.fq.gz&quot;).rm.rRNA.tRNA.fq.gz  -U $id  -S $(basename $&#123;id&#125; &quot;.rm.rRNA.fq.gz&quot;).rRNA.tRNA.sam);done<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="3-mapping-to-genome-read-counting"><a href="#3-mapping-to-genome-read-counting" class="headerlink" title="3. mapping to genome &amp; read counting"></a>3. mapping to genome &amp; read counting</h4><h6 id="3-1-mapping-to-genome"><a href="#3-1-mapping-to-genome" class="headerlink" title="3.1 mapping to genome"></a>3.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">mapping</span><br>ln -s ../rm.tRNA/*rm.rRNA.tRNA.fq.gz<br>Ref_index=/data1/amliang/reference/index/star/flybase_m6/<br>Read_dir=./<br>Run_log=runlog.txt<br>GTF=/data1/amliang/annotation/fly/flyase/gtf/dmel-all-r6.31.gtf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">input/output file</span> <br>for id in &#123;P1_L2_Q0023W0073,P2_L3_Q0013W0073,P3_L3_Q0028W0073,S4_L3_Q0016W0073,S5_L3_Q0014W0073,S6_L3_Q0021W0073&#125;;<br>do<br>Read=$&#123;Read_dir&#125;/$&#123;id&#125;.R1.rm.rRNA.tRNA.fq.gz<br>BAM=$&#123;id&#125;.bam<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Cycle Running</span><br>STAR \<br>--runThreadN 10 \<br>--outFilterType BySJout \<br>--outFilterMismatchNmax 2 \<br>--outFilterMultimapNmax 1 \<br>--genomeDir $Ref_index \<br>--readFilesIn $Read \<br>--readFilesCommand zcat \<br>--outFileNamePrefix $&#123;id&#125;_ \<br>--outSAMtype BAM SortedByCoordinate \<br>--quantMode TranscriptomeSAM GeneCounts \<br>--outSAMattributes All \<br>--outSAMattrRGline ID:1 LB:ribo_seq PL:ILLUMINA SM:$&#123;id&#125; \<br>--outBAMcompression 6 \<br>--outReadsUnmapped Fastx<br>done<br>conda deactivate<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">sort</span> &amp; index</span><br>source activate chipseq<br>ls *.out.bam|while read id ;do (samtools sort -O bam  -T sorted -o $(basename $&#123;id&#125; &quot;.out.bam&quot;).sort.bam   $&#123;id&#125;);done<br><br>ls *.sort.bam | while read id ; do (samtools index $id); done<br>conda deactivate<br></code></pre></td></tr></table></figure><h6 id="3-2-CDS-reads-count"><a href="#3-2-CDS-reads-count" class="headerlink" title="3.2 CDS reads count"></a>3.2 CDS reads count</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">source activate rnaseq<br>featureCounts -T 16  -t CDS -g gene_id -a /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gtf  -o  Ribo.CDS_count.a.txt  ./*.bam<br>conda deactivate<br><br></code></pre></td></tr></table></figure><h4 id="4-corresponding-RNA-Seq-data"><a href="#4-corresponding-RNA-Seq-data" class="headerlink" title="4. corresponding RNA-Seq data"></a>4. corresponding RNA-Seq data</h4><h6 id="4-1-mapping-to-genome"><a href="#4-1-mapping-to-genome" class="headerlink" title="4.1 mapping to genome"></a>4.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">source activate rnaseq<br>Ref_index=/data1/amliang/reference/index/bowtie2/flybase_m6_bowtie2/<br>Read_dir=/data1/amliang/projects/sxl_DC/2308_RiboSeq/240108_RNASeq_S2/data<br>Run_log=runlog.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">input/output file</span> <br>for id in &#123;P1_L2_UDI296,P2_L2_UDI297,P3_L2_UDI298,S4_L2_UDI299,S5_L2_UDI300,S6_L2_UDI301&#125;;<br>do<br>R1=$&#123;Read_dir&#125;/$&#123;id&#125;.R1.fastq.gz<br>R2=$&#123;Read_dir&#125;/$&#123;id&#125;.R2.fastq.gz<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Cycle Running</span><br>bowtie2  -p 18 -N 0 -x $Ref_index/fly -1 $R1 -2 $R2 -S $&#123;id&#125;.sam 2&gt;&gt;$Run_log <br> <br>done<br>conda deactivate<br></code></pre></td></tr></table></figure><h6 id="4-1-mapping-to-genome-1"><a href="#4-1-mapping-to-genome-1" class="headerlink" title="4.1 mapping to genome"></a>4.1 mapping to genome</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">Note: reads_count <span class="hljs-keyword">for</span> CDS not exon</span><br><br>source activate rnaseq<br>featureCounts -T 16 -p -M -t CDS -g gene_id  -a /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gtf  -o  RNASeq.CDS_count.txt  ../*.bam<br>conda deactivate<br></code></pre></td></tr></table></figure><h4 id="5-differential-translation"><a href="#5-differential-translation" class="headerlink" title="5. differential translation"></a>5. differential translation</h4><h6 id="5-1-expr-count"><a href="#5-1-expr-count" class="headerlink" title="5.1 expr. count"></a>5.1 expr. count</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#Ribo</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/RiboSeq/featureCount_CDS_multi/&quot;</span><span class="hljs-punctuation">)</span><br>Ribo_count <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Ribo.CDS.multi_count.a.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>rownames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-operator">$</span>Geneid<br>colnames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>Ribo_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;Geneid&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;End&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Length&quot;</span><span class="hljs-punctuation">,</span>                          <span class="hljs-string">&quot;WT_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;WT_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;WT_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL_3&quot;</span><span class="hljs-punctuation">)</span><br>Ribo_exp <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>Ribo_exp <span class="hljs-operator">&lt;-</span> Ribo_exp<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br><span class="hljs-comment"># RNASeq</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E://220625_PC/R workplace/220320_SXL/240115_tranlation/transla_by_Cyt.RNAseq/&quot;</span><span class="hljs-punctuation">)</span><br>RNA_count <span class="hljs-operator">&lt;-</span> read.table<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;RNASeq.CDS_count.txt&quot;</span><span class="hljs-punctuation">,</span>header <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>rownames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-operator">$</span>Geneid<br>colnames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span><br>colnames<span class="hljs-punctuation">(</span>RNA_count<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-string">&quot;Geneid&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Chr&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;End&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Length&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_3&quot;</span><span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;C.wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;C.Sxl_3&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;wt_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;wt_3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;Sxl_3&quot;</span><span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> RNA_exp<span class="hljs-punctuation">[</span>rownames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span> <span class="hljs-operator">%in%</span> rownames<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br></code></pre></td></tr></table></figure><h6 id="5-2-PCA"><a href="#5-2-PCA" class="headerlink" title="5.2 PCA"></a>5.2 PCA</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#normalized - Ribo</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br>Ribo_exp_read.count <span class="hljs-operator">&lt;-</span> Ribo_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">]</span><br>Ribo_exp_read.count <span class="hljs-operator">&lt;-</span> Ribo_exp_read.count<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>condition <span class="hljs-operator">&lt;-</span>factor<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                   levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>colData <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>row.names<span class="hljs-operator">=</span>colnames<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeqDataSetFromMatrix<span class="hljs-punctuation">(</span>Ribo_exp_read.count<span class="hljs-punctuation">,</span> colData<span class="hljs-punctuation">,</span> design<span class="hljs-operator">=</span> <span class="hljs-operator">~</span> condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeq<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">)</span><br>Ribo_normalized_counts <span class="hljs-operator">&lt;-</span> counts<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">,</span> normalized<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>Ribo_normalized_counts <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>Ribo_normalized_counts<span class="hljs-punctuation">)</span><br>Ribo_normalized_counts<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>Ribo_normalized_counts<span class="hljs-punctuation">)</span><br>Ribo_rpkm<span class="hljs-operator">&lt;-</span> Ribo_normalized_counts<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">7</span><span class="hljs-punctuation">]</span><br><br>library<span class="hljs-punctuation">(</span>FactoMineR<span class="hljs-punctuation">)</span><br>gene <span class="hljs-operator">&lt;-</span> t<span class="hljs-punctuation">(</span>Ribo_rpkm<span class="hljs-punctuation">)</span><br>gene.pca <span class="hljs-operator">&lt;-</span> PCA<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">,</span> ncp <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> scale.unit <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> graph <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>gene.pca<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># chose: WT_1,WT_3,SXL_1,SXL2</span><br><br><br><span class="hljs-comment">#normalized - RNAS</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br>RNA_exp_read.count <span class="hljs-operator">&lt;-</span> RNA_count<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-operator">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>RNA_exp_read.count <span class="hljs-operator">&lt;-</span> RNA_exp_read.count<span class="hljs-punctuation">[</span>rowSums<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>condition <span class="hljs-operator">&lt;-</span>factor<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                   levels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;WT&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;SXL&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>colData <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>row.names<span class="hljs-operator">=</span>colnames<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeqDataSetFromMatrix<span class="hljs-punctuation">(</span>RNA_exp_read.count<span class="hljs-punctuation">,</span> colData<span class="hljs-punctuation">,</span> design<span class="hljs-operator">=</span> <span class="hljs-operator">~</span> condition<span class="hljs-punctuation">)</span><br>dds <span class="hljs-operator">&lt;-</span> DESeq<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">)</span><br>RNA_normalized_counts <span class="hljs-operator">&lt;-</span> counts<span class="hljs-punctuation">(</span>dds<span class="hljs-punctuation">,</span> normalized<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>RNA_normalized_counts <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>RNA_normalized_counts<span class="hljs-punctuation">)</span><br>RNA_normalized_counts<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>RNA_normalized_counts<span class="hljs-punctuation">)</span><br>RNA_rpkm<span class="hljs-operator">&lt;-</span> RNA_normalized_counts<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-operator">-</span><span class="hljs-number">7</span><span class="hljs-punctuation">]</span><br><br>library<span class="hljs-punctuation">(</span>FactoMineR<span class="hljs-punctuation">)</span><br>gene <span class="hljs-operator">&lt;-</span> t<span class="hljs-punctuation">(</span>RNA_rpkm<span class="hljs-punctuation">)</span><br>gene.pca <span class="hljs-operator">&lt;-</span> PCA<span class="hljs-punctuation">(</span>gene<span class="hljs-punctuation">,</span> ncp <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> scale.unit <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> graph <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>gene.pca<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># chose: WT_1,WT_2,SXL_2,SXL3</span><br></code></pre></td></tr></table></figure><h6 id="5-3-calculating-differential-translation-genes-by-riborex"><a href="#5-3-calculating-differential-translation-genes-by-riborex" class="headerlink" title="5.3 calculating differential translation genes by riborex"></a>5.3 calculating differential translation genes by riborex</h6><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs R">Ribo_exp <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><br>RNA_exp <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># riborex</span><br>library<span class="hljs-punctuation">(</span>fdrtool<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>riborex<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>DESeq2<span class="hljs-punctuation">)</span><br><br>RNACntTable <span class="hljs-operator">&lt;-</span> RNA_exp<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-number">6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>RiboCntTable <span class="hljs-operator">&lt;-</span> Ribo_exp<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>head<span class="hljs-punctuation">(</span>RNACntTable<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>RiboCntTable<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br><br>rnaCond <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">)</span><br>riboCond <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;control&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;treated&quot;</span><span class="hljs-punctuation">)</span><br>res.deseq2 <span class="hljs-operator">&lt;-</span> riborex<span class="hljs-punctuation">(</span>RNACntTable<span class="hljs-punctuation">,</span> RiboCntTable<span class="hljs-punctuation">,</span> rnaCond<span class="hljs-punctuation">,</span> riboCond<span class="hljs-punctuation">,</span> engine <span class="hljs-operator">=</span> <span class="hljs-string">&quot;DESeq2&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br>hist<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-operator">$</span>pvalue<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;DESeq2 unadjusted p-values&#x27;</span><span class="hljs-punctuation">,</span> xlab<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Unadjusted p-values&#x27;</span><span class="hljs-punctuation">,</span><br>     col <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;#F4C7AB&#x27;</span><span class="hljs-punctuation">)</span><br><br>result <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>res.deseq2<span class="hljs-punctuation">)</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> result<span class="hljs-punctuation">[</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>result<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span><span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> result<span class="hljs-operator">$</span>padj<span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&gt;</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_diff <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>tranla_diff<span class="hljs-punctuation">)</span><br>tranla_up <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>tranla_down <span class="hljs-operator">&lt;-</span> tranla_diff<span class="hljs-punctuation">[</span>tranla_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220910_annotation/Drosaphila/&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>rtracklayer<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>genome.anno <span class="hljs-operator">&lt;-</span> import<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;dmel-all-r6.44.gtf&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> as.data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>genome.anno<span class="hljs-operator">=</span>genome.anno<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;gene_id&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;seqnames&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;width&quot;</span><span class="hljs-punctuation">,</span><br>                           <span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>head<span class="hljs-punctuation">(</span>genome.anno<span class="hljs-punctuation">)</span><br>genome.anno <span class="hljs-operator">&lt;-</span> genome.anno<span class="hljs-punctuation">[</span>genome.anno<span class="hljs-operator">$</span>type<span class="hljs-operator">==</span><span class="hljs-string">&quot;gene&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>colnames<span class="hljs-punctuation">(</span>genome.anno<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;gene_symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;seqnames&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;start&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;end&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;length&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;strand&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;type&quot;</span><span class="hljs-punctuation">)</span><br><br>result<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>result<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>result<span class="hljs-punctuation">,</span>genome.anno<span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>Ribo_exp<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span>  rownames<span class="hljs-punctuation">(</span>Ribo_exp<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span>Ribo_exp<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>RNA_exp<span class="hljs-operator">$</span>GeneID <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>RNA_exp<span class="hljs-punctuation">)</span><br>T_S2 <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>T_S2<span class="hljs-punctuation">,</span>RNA_exp<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span> all.x<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><br>T_diff <span class="hljs-operator">&lt;-</span> T_S2<span class="hljs-punctuation">[</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>T_S2<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;</span> T_S2<span class="hljs-operator">$</span>pvalue <span class="hljs-operator">&lt;</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_diff <span class="hljs-operator">&lt;-</span> dplyr<span class="hljs-operator">::</span>filter<span class="hljs-punctuation">(</span>T_diff<span class="hljs-punctuation">,</span> <span class="hljs-operator">!</span><span class="hljs-built_in">is.na</span><span class="hljs-punctuation">(</span>GeneID<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>T_test <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&lt;=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_diff <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>baseMean <span class="hljs-operator">&gt;</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_up <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>T_down <span class="hljs-operator">&lt;-</span> T_diff<span class="hljs-punctuation">[</span>T_diff<span class="hljs-operator">$</span>log2FoldChange <span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025-01-01元旦东湖骑行</title>
    <link href="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/"/>
    <url>/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h3 id="2025-01-01元旦东湖骑行"><a href="#2025-01-01元旦东湖骑行" class="headerlink" title="2025-01-01元旦东湖骑行"></a>2025-01-01元旦东湖骑行</h3><p>.</p><hr><p>元旦休假，东湖骑行约5小时，73公里。</p><p>看了风景，晒了太阳。</p><p>.</p><p>上午9点起，10点从水生所门出发，走医学部去梨园绿道入口。</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E5%AF%B9%E9%9D%A2%E6%98%AF%E5%8C%BB%E5%AD%A6%E9%83%A8.jpg" alt="20250101 元旦 对面是医学部"></p><p>.</p><p>一条不知名小路，黄了的柳树叶有点好看，没人。</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E6%B9%96%E5%B2%B8%E8%BE%B9%E9%BB%84%E4%BA%86%E7%9A%84%E6%9F%B3%E6%A0%91.jpg" alt="20250101 元旦 湖岸边黄了的柳树"></p><p>.</p><p>中午到了九峰，骑得很慢。</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E4%B8%AD%E5%8D%88%E5%88%B0%E8%BE%BE%E4%B9%9D%E5%B3%B0%E6%A1%A5.jpg" alt="20250101 元旦 中午到达九峰桥"></p><p>.</p><p>九峰菜市场的肥肠粉，味道不错，下次还去。</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E4%B9%9D%E5%B3%B0%E8%8F%9C%E5%B8%82%E5%9C%BA%E9%99%84%E4%BB%B6%20%E8%82%A5%E8%82%A0%E7%B2%89.jpg" alt="20250101 元旦 九峰菜市场附件 肥肠粉"></p><p>.</p><p>路上的一片油菜地，明年春天它应该会很好看。</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E6%B2%B9%E8%8F%9C%E5%B9%BC%E8%8B%97.jpg" alt="20250101 元旦 油菜幼苗"></p><p>.</p><p>夕阳，一道残阳铺水中。</p><p><img src="/2025/01/01/2025-01-01%E5%85%83%E6%97%A6%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C/20250101%20%E5%85%83%E6%97%A6%20%E5%A4%95%E9%98%B3.jpg" alt="20250101 元旦 夕阳"></p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>GSEA in drosophila</title>
    <link href="/2024/12/31/GSEA%20in%20drosophila/"/>
    <url>/2024/12/31/GSEA%20in%20drosophila/</url>
    
    <content type="html"><![CDATA[<h3 id="GSEA-in-drosophila"><a href="#GSEA-in-drosophila" class="headerlink" title="GSEA in drosophila"></a>GSEA in drosophila</h3><p>.</p><p>This is a work log using R script to perform Gene Set Enrichment Analysis by differentialy expression genes in drosophila.</p><p>and this script also applies to other species, such as human and mouse.</p><p>human : org.Hs.eg.db</p><p>mouse : org.Mm.eg.db</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs R"><br>library<span class="hljs-punctuation">(</span>org.Dm.eg.db<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>clusterProfiler<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>DOSE<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>topGO<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>pathview<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>KEGG.db<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>enrichplot<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># RNA-Seq data</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/240506&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br>expr_gene <span class="hljs-operator">&lt;-</span> read_xlsx<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;DEGs_240506.xlsx&quot;</span><span class="hljs-punctuation">,</span>sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;new.diff_gene_all_S2&quot;</span><span class="hljs-punctuation">,</span>skip <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># transfer ENSEMBL into ENTREZID</span><br>geneList<span class="hljs-operator">&lt;-</span>expr_gene<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;log2FoldChange&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>eg <span class="hljs-operator">&lt;-</span> bitr<span class="hljs-punctuation">(</span>geneList<span class="hljs-operator">$</span>GeneID<span class="hljs-punctuation">,</span> <br>           fromType<span class="hljs-operator">=</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span> <br>           toType<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ENTREZID&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;SYMBOL&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>           OrgDb<span class="hljs-operator">=</span><span class="hljs-string">&quot;org.Dm.eg.db&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>eg<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># sorted by log2FC</span><br>input_data <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>eg<span class="hljs-punctuation">,</span>geneList<span class="hljs-punctuation">,</span>by.x<span class="hljs-operator">=</span><span class="hljs-string">&quot;ENSEMBL&quot;</span><span class="hljs-punctuation">,</span>by.y<span class="hljs-operator">=</span><span class="hljs-string">&quot;GeneID&quot;</span><span class="hljs-punctuation">)</span><br>input_data_sort <span class="hljs-operator">&lt;-</span> input_data<span class="hljs-punctuation">[</span>order<span class="hljs-punctuation">(</span>input_data<span class="hljs-operator">$</span>log2FoldChange<span class="hljs-punctuation">,</span> decreasing <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>gene_fc <span class="hljs-operator">=</span> input_data_sort<span class="hljs-operator">$</span>log2FoldChange<br><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>gene_fc<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> input_data_sort<span class="hljs-operator">$</span>ENTREZID<br>head<span class="hljs-punctuation">(</span>gene_fc<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># gseGO</span><br>GO <span class="hljs-operator">&lt;-</span> gseGO<span class="hljs-punctuation">(</span><br>  gene_fc<span class="hljs-punctuation">,</span> <span class="hljs-comment">#gene_fc</span><br>  ont <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ALL&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># &quot;BP&quot;,&quot;MF&quot;,&quot;CC&quot; or &quot;ALL&quot;</span><br>  OrgDb <span class="hljs-operator">=</span> org.Dm.eg.db<span class="hljs-punctuation">,</span><br>  keyType <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ENTREZID&quot;</span><span class="hljs-punctuation">,</span><br>  pvalueCutoff <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>  pAdjustMethod <span class="hljs-operator">=</span> <span class="hljs-string">&quot;BH&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>go_terms <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">)</span><br><br><br><span class="hljs-comment"># diaw plot</span><br><span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>file.exists<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  dir.create<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br>  setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>  setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;E:/220625_PC/R workplace/220320_SXL/202404_Fig/241231&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br>tiff<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;sex_differentiation.tiff&quot;</span><span class="hljs-punctuation">,</span>units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;in&quot;</span><span class="hljs-punctuation">,</span>width <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">7.2</span><span class="hljs-punctuation">,</span>res <span class="hljs-operator">=</span> <span class="hljs-number">600</span><span class="hljs-punctuation">)</span><br>gseaplot2<span class="hljs-punctuation">(</span>GO<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;GO:0007548&quot;</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;firebrick&quot;</span><span class="hljs-punctuation">,</span> <br>          title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;sex differentiation&quot;</span><span class="hljs-punctuation">,</span><br>          rel_heights<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.6</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>output files :</p><p>I chose to show a term about sex determination pathway:</p><p><img src="/2024/12/31/GSEA%20in%20drosophila/Terms.png" alt="Terms"></p>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>T检验在excel中的使用</title>
    <link href="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="T检验在excel中的使用"><a href="#T检验在excel中的使用" class="headerlink" title="T检验在excel中的使用"></a>T检验在excel中的使用</h3><p>.</p><p>在Excel中对两组数据做差异显著性检验是我们经常会用到的方法，多数使用者都理解并熟练其原理和使用方法的，但可能也有少数人，尽管会用各种软件来做差异性检验，但对其背后的数理并不完全清楚，比如说我自己。前段几天有人问到我，我支支吾吾给讲了个大概，发现自己好多细节并不清楚，后来经过搜索文章后，我才大致有一个相对清晰的认识，现在我把它写下来，以供诸君参考。</p><p>差异显著性检验是统计假设检验的一种，用于比较两组或多组数据之间的差异是否显著。它有好几种类型，包括t检验，u检验，卡方检验以及方差分析等，我们这里只讨论t检验。</p><p>但在讲述t检验之前，我们需要先了解中心极限定理，小概率事件等概念做一个简单的回顾复习，这会更好地帮助我们理解差异显著性检验背后的逻辑。</p><h5 id="中心极限定理"><a href="#中心极限定理" class="headerlink" title="中心极限定理"></a>中心极限定理</h5><p>什么是中心极限定理，中心极限定理指的是在一定条件下，独立随机变量的期望随着样本量的增大会趋向于正态分布，也就是说，它的累计分布函数会收敛于标准正态分布。</p><p>换句话说，<strong>不管总体样本是什么分布，当样我们任意从总体样本中抽取足够大的样本时，这些被抽样的样本均值都会围绕在总体样本的均值周围，并且呈正态分布。</strong></p><p>如果再具体一点说，就是对某一个总体样品数据中进行放回随机抽样，每次抽取样本数量为n，抽了k次，则每次抽样得到的均值是m1，m2，m3，……，mk。这时候我们会发现，这些抽样样本的均值（即m1，m2，m3，……，mk）是满足正态分布的，这就是中心极限定理。</p><p>中心极限定理不要求随机变量本身是正态分布的，所以很容易推测，当在一定条件下，我们可以使用对正态分布成立的方法去应对非正态分布。比如，对样本量n足够大的时候，二项分布 Bin(<em>n, p</em>) 可以用正态分布N(<em>np</em>, <em>np</em>(<em>1-p</em>))来近似等等。</p><h5 id="小概率事件"><a href="#小概率事件" class="headerlink" title="小概率事件"></a>小概率事件</h5><p>小概率事件即是指发生概率极小的事件，也就是说，在假设检验的思想中，<strong>小概率事件在某一次试验中基本上是不会发生的，如果发生了，则说明该实验的原假设出了问题，则应该拒绝原假设</strong>。</p><p>举个例子，就说抛硬币的问题吧。对于一个正常的抛硬币事件，我们知道其出现正反两面的概率各是50%，假设你跟同学玩抛硬币猜正反面的游戏，结果10次下来，你一次都没赢过。这个时候聪明的你一定开始怀疑这枚硬币是不是有问题，并且你用下面这一段证据狠狠打脸了一下这个同学：<br>    假设检验验证该硬币是否是质地均匀的正常硬币</p><p>​H0：零假设该硬币是质地均匀的正常硬币 （出现正反面的概率均为50%）<br>​H1：该硬币不是质地均匀的正常硬币</p><p>假设H0成立，则每次抛出硬币出现正反面的概率均为0.5，那么抛10次硬币，均出现正面的概率为 0.5^10 &#x3D; 0.00098，该概率非常小，属于小概率事件，基本不可能出现，如果出现了，则说明零假设H0不正确。所以，我们可以据此否定零假设H0，即“硬币是质地均匀的正常硬币”这一假设不能成立，故而H1成立，硬币不是正常硬币。</p><p>从上述小例子可以看出小概率事件的数学思想其实就是用反证法进行假设检验。</p><h5 id="差异显著性检验"><a href="#差异显著性检验" class="headerlink" title="差异显著性检验"></a>差异显著性检验</h5><p>那中心极限定理和小概率事件等又与我们今天要讨论的差异显著性检验有什么关系呢？</p><p>因为假设检验（比如t检验、z检验等）是基于正态分布的一类统计方法，其要求样本数据要符合正态分布。而中心极限定理则为我们提供了理论基础，即根据中心极限定理，无论原始数据是否为正态分布，只要样本容量足够大，抽样样本的均值分布就会接近正态分布。</p><p>这样我们就可以对不是正态分布的数据进行差异显著性检验（假设检验）了。</p><p>并且，中心极限定理还帮助我们理解如何将样本均值进行标准化，成为标准正态分布（z值），从而可以计算p值（p值的计算过程是基于正态分布的假设，这一部分如果需要，将来会另写一文详细说明）。</p><p>在假设检验中，我们通常很关心在零假设H0下会是否会出现极端结果，即小概率事件。而前面的p值，则反映了在零假设成立的前提下，观察到当前或者更极端结果的概率，p值越小，说明观察到的结果越不可能在零假设成立的条件下发生，进而就越充分地拒绝零假设。</p><p>所以，我们可以理解到，当p值足够小的时候，发生的事件就可以认为是小概率事件（如图1所示）。通常，我们可以设定一个显著性水平（比如0.05），如果我们观察到的结果的p值小于设定的显著性水平，那么我们就可以拒绝零假设（例如，在差异显著性检验中，我们的零假设一般是样本之间没有差异）。</p><p>在差异显著性检验中，判断差异是否显著的标准，就是看差异是否属于小概率事件，如果差异出现的概率非常低，我们就可以认为这个差异不是偶然的，而是有一定的统计学意义。</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83.png" alt="概率分布"></p><p>到这里，我们基本上清楚了差异显著性检验背后的概率原理了，前面我们已经说过，差异显著性检验包括了好几种检验方法，包括t检验，u检验，卡方检验和方差分析等多种方法，但这次我们只讨论最常用的t检验（t-test）。</p><h5 id="t检验"><a href="#t检验" class="headerlink" title="t检验"></a>t检验</h5><p>t检验又叫student 检验（学生检验），最早是欧洲一个酒厂的质量检测员，为了观测酿酒品质提出来的统计假说检验，当时酒厂不让随便公开发表文章，这位先生就用了 “student” 这样一个化名发表了，所以后来就又叫student test了，这个故事在《女士品茶》里有详细介绍。</p><p>t检验主要用于样本含量较小（比如当样本量n &lt; 30；如果样本量&gt;&#x3D;30，我们一般更倾向于用z检验）的差异检验。</p><p>嗯？前面不是说，当样本量足够大的时候，从任意总体中的抽样样本均值的分布会近似正态分布（中心极限定理），那要是样本量不够大呢？</p><p>如果你对概率分布有一些了解的话，你就会知道，对于小样本量的来说，其均值呈现的分布叫t分布，其自由度为<em>df</em> &#x3D; <em>n - 1</em>。t分布的形状与正态分布相似，其曲线形态随自由度df而改变，df越大，则t分布曲线就越近似正态分布，当自由度df为无穷大时，t分布曲线即为标准正态分布。</p><hr><p>好，那接下来我们具体讨论一下最常见的t检验在最常用的excel中的使用。</p><p>比如我们现在想要看一下两组数据是不是有差异，如下表所示：</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/input_data%201.png" alt="input_data 1"></p><p>我们使用excel中自带的t检验函数t.test()来检测两组数据是否有差异。Array1输入control这组数据，Array2输入treat这组数据，前面这些数据输入没啥好说的。</p><p>需要注意的是，接下来的Tail选项如何选？（如下图所示）</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/Tails.png" alt="Tails"></p><p>这需要根据你的数据类型和应用场景来设定，在t.test()中，一般分为 ‘单尾’ 和 ‘双尾’ 。</p><p>单尾检验和双尾检验都是检验统计显著性的方法，区别在于，单尾检验只检验一个方向的显著性，而双尾检验则检验两个方向的显著性。</p><p>举个例子，比如，去年你对一个全社区的10岁以下小孩身高进行了测量，一年后的今年，你又对这批小孩的身高做了测量，因为小孩的身高只有两种可能，要么就今年的比去年的显著增高了，要么就是变化不显著，不可能出现比去年的还显著降低的情况，即身高变化只能是单向的。那在这种情况下，我们就使用单位检验了。</p><p>但如果你测量的是两个不同社区 (社区A和社区B) 的小孩身高，这时候，你不确定A是不是一定就比B高，还是B比A高，即其显著变化的方向是双方向的，这种情况下，就使用双尾检验。</p><p>我这里提供的数据，是存在双向变化可能的，所以选择的是双尾检验。</p><p>设定好了Tail之后，下面还有一个type需要选择（如下图所示）</p><p>这里的type通常分为3中类型，即成对检验，双样本等方差假设和双样本异方差检验。</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/Type.png" alt="Type"></p><p>我们先来看成对检验，也就是常说的配对样本t检验。那什么情况下选用配对样本检验呢，</p><p>其实这里的配对样本t检验，是与独立样本t检验是相对应的，看名字，我们就大概能知道各自是干嘛的了。还是啰嗦一点，总结一下吧：配对样本检验一般针对的是，观察变量为连续变量，并且两组变量是配对设计的，两组变量是相关的等，而独立样本t检验，则顾名思义就是两组样本是独立的。</p><p><img src="/2024/12/24/t%E6%A3%80%E9%AA%8C%E5%9C%A8excel%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/input_data%202.png" alt="input_data 2"></p><p>还是前面那组数据，如果我们给每个数据设定为具体的某一个人，就比如这是心脏瓣膜手术后的一组病人，在对其服用华法林之前和连续服用一周后的凝血值进行t检验，这个时候则要用配对样本t检验。</p><p>而如果只是随机在医院挑选了两组，服用了华法林的术后病人和没有服用华法林的术后病人，就是这些病人，两批人，这个时候则用独立样本t检验。</p><p>接下来我们再来看，什么时候用等方差检验，什么时候用异方差检验？</p><p>本质上，其实是在比较两组独立样本均值时，对于这两组样本的方差是否相等的假设。选择哪种假设取决于你对数据的了解，或者你对数据是否满足方差齐性（等方差）假设的检验。</p><p>换句话说，当你知道或认为两个样本的方差差异不大时，就使用等方差检验；而当你通过等方差检验（比如 Levene 检验）发现两个样本的方差显著不同，或者你本来就知道样本来源可能具有不同的方差时，这个时候就得使用异方差检验。</p><p>但为了减低麻烦，我在处理这类数据前，一般不做方差齐性检验，用眼睛看一下，大概给个估计，就判断二者的方差是不是相近，从而选择做等方差检验还是异方差检验。</p><p>上面的这些内容，看起来其实很简单，但在日常工作中，用到的实在太频繁了，因而还是不避其繁地记录了下来。</p>]]></content>
    
    
    <categories>
      
      <category>统计</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>读《苏东坡新传》李一冰</title>
    <link href="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/"/>
    <url>/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/</url>
    
    <content type="html"><![CDATA[<h3 id="读《苏东坡新传》李一冰"><a href="#读《苏东坡新传》李一冰" class="headerlink" title="读《苏东坡新传》李一冰"></a>读《苏东坡新传》李一冰</h3><p>.</p><p>我读过不少苏轼的诗词，也看过一些与他相关的传闻轶事，但对苏轼的了解依然是零碎杂乱的。比如我知道他很飞扬，却不知道，他也有沉郁的一面，我知道他的诗词多数奔放豁达，却不知道他亦曾历经磨难。于是我尝试想找一本比较公正的关于苏轼的传记读一读。</p><p>很庆幸，我看到了今天要介绍的这部李一冰所著的《苏东坡新传》。真的很惊喜，在这么多《苏传》里，居然还有着一位叫李一冰的老先生，穷八年之力，在经历牢狱之祸后写就的《苏东坡新传》。其他不说，单比起林语堂的《苏东坡传》来，就要高明靠谱得多，也更有性情。林语堂版你读了，很有可能会对作者生出一些轻视之意，原来久负盛名的大作家也不过如此，但李一冰版，你却只会肃然起敬。</p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0.png" alt="苏东坡新传"></p><p>很快就翻到了苏轼在黄州的那五年，这是我最喜欢的一个章节，也是我认为苏轼一生中最精彩的一段，我所喜欢的苏轼诗词多数都是作于此段时间。</p><p>公元1079年，那年苏轼43岁，刚刚就任湖州开始主政一方，正是意气风发的时候。但旋即就遭到弹劾告发，苏轼也因涉嫌“讥讽新法”而被缉捕入狱，这就是后世著名的“乌台诗案”了。随后死里逃生，以“犯官”的身份，辗转被贬黄州。</p><p>苏轼是否含冤，姑且不论，但是这段九死一生的囚徒经历，在我看来，却是将苏轼的一生分割成了两段。在此之前，他只是北宋一个普通的官僚，最多算是有才华一点，与掩埋历史尘土中的千千万万中国古代士大夫们并无太多区别。但黄州之后，苏轼就像一颗明星一样，一直闪烁在中华文化史上，令后人敬仰。</p><p>苏轼刚到黄州时，寄居在定惠院，此时的他尚处在劫难的惊恐中，如同一只惊弓之鸟，只求能苟全性命。白天他只在住处卧榻睡觉，到了晚上才一个人悄悄跑到院外去散散步，正如他写给其弟苏辙的诗中所记“畏蛇不下榻，睡足吾无求”一样，满怀忧惧。</p><p>后来换了一个住处，搬到了临皋亭，这个地方非常靠近长江，亭下八十余步便是大江，苏轼经常策仗江边。有一次与长子苏迈一同漫游江岸，过知州官邸不过百步，就看见一片绛赤色的崖壁，矗立在深碧色的江水中，气象挺拔雄俊。听人说，这地方就是三国时代周瑜联军大破曹操的赤壁古战场。曾经满怀济世热情的苏轼这会儿正处于人生最低潮，以为自己这一生大概功名无望了，于是在这次初游赤壁时，作下一首《赤壁怀古》》：“大江东去，浪淘尽，千古风流人物。故垒西边，人道是，三国周郎赤壁”，以追思历史英雄人物来弥补内心的空虚。</p><p>也许是时间的流逝，苏轼渐渐地从最初的惶惧和空虚中走出来，开始“扁舟草履，放浪山水间，与樵渔杂处”起来，也正是这种随性的漫游，让他更真切地感受到自然所带来的旷然天真之乐，就像他在《赤壁赋》里所作：“惟江上之清风，与山间之明月，耳得之而为声，目遇之而成色，取之无禁，用之不竭。是造物者之无尽藏也，而吾与子之所共适”一样，纵情山月，怡然自得。</p><p>但是“大江风月，岂可疗饥？”，贬谪犯官的收入难以支撑起家庭的生活，到了被贬黄州的第二年，苏轼一家已经手头很拮据了，并且这种流放的惩罚不知何时才是终期。所以，苏轼就希望能够有一块土地，以当躬耕自给。幸得二十年前在京做官时认识的一位朋友帮忙，才获准得到一块废弃的坡地，该地约五十余亩，位处黄州州府之东的山麓，故而号名“东坡”，苏轼的东坡居士之名亦由此而来。</p><p>苏轼在那块荒地上亲垦田地，自种黄桑，虽然辛苦，但他心里很为满足，“腐儒粗粝支百年，力耕不受众目怜”。他还按照地势高下，规划了一个蓝图，较低的湿地种植粳稻；东面平地上种上枣树和栗树，住在对江的同乡，已经应允送他桑树和果苗；在视野最佳的空地处，构筑房舍，以便安家。此时的苏轼，已经开始淡泊田野，安贫乐道了，不信，下面还有一个小故事。</p><p>苏轼的好友王巩，也因受“乌台诗案”牵连，被黜逐到了偏远的岭南，后来获赦北返，路经黄州来探望苏轼，席间苏轼问及岭南的情况，感触颇多，于是才有了后来的名句：“试问岭南应不好，却道，此心安处是吾乡”。由此可见，此时的苏轼已经心态乐观，顽强自适了。传闻，苏轼作此《定风波·常羡人间琢玉郎》词时，是受随行王巩的一位叫寓娘的歌妾所启发，真假不知，姑且不论。</p><p>至此，苏轼已经完全不似初到黄州的那般惊惧和孤独了，更多的是清醒和超然，在他的《江城子》里，苏轼是这样说的：“梦中了了醉中醒，只渊明，是前生。走遍人间，依旧却躬耕。昨夜东坡春雨足，乌鹊喜，报新晴。”，你看，只有欢乐和满足。</p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E5%AE%9A%E9%A3%8E%E6%B3%A2.jpg" alt="定风波"></p><p>自从几年前受“诗案”所祸，苏轼至此已经没有太多仕进的念头了，一心只想在黄州作一个侍弄庄稼的农夫，于是就想再置买一些田地，以赡养家口。元丰五年三月七日那一天，他到距黄州三十里地的沙湖去看田，看完田返家的路上，天气骤变，忽然下起了大雨。他们一行人，个个淋得狼狈，独有苏轼安步徐行。不久，雨霁天晴，他很为自己这份坦荡洒脱的心怀而得意，遂作《定风波·莫听穿林打叶声》一首：“莫听穿林打叶声，何妨吟啸且徐行。竹杖芒鞋轻胜马，谁怕，一蓑烟雨任平生。料峭春风吹酒醒，微冷，山头斜照却相迎。回首向来萧瑟处，归去，也无风雨也无晴”。</p><p>人的一生，有追求就必有失落，如果过于执意，内心便难以平静，痛苦自然也就如风雨一样，四面八方地冲蚀着你。在这里，这饱经世患的诗人，在雨中举步轻行，世事无常的变幻已全然不在心间，唯有坦然的超脱，让人神往。</p><p>元丰七年，也就是公元1084年，这一年苏轼48岁，神宗皇帝欲重新起复苏轼，授其水部员外郎，移迁至相对繁华的汝州，至此，他的境地才开始向好转变。</p><p>苏轼自元丰三年（1080）二月到达黄州，至元丰七年四月离去，在此整整住了四年三个月。黄州虽处穷僻，但住久了，一草一木，也不免有情，更别说邻里、朋友了，于是作《满庭芳》以当告别：“归去来兮，吾归何处？万里家在岷峨。百年强半，来日苦无多。坐见黄州再闰，儿童尽楚语吴歌。山中友，鸡豚社酒，相劝老东坡”。</p><p>苏轼离开黄州后，境遇变好，后又得朝堂重任，回到汴京做中书舍人，旬月之间，数次升迁，直到翰林学士，算是时来运转了。但苏轼的施政能力实在一般，比起同时代的司马光尚有不如，更别说王安石了。在之后与章惇等人的政治斗争中又多次被贬，正如其晚年在《自题金山画像》一诗中所叙：“问汝平生功业，黄州惠州儋州”，一路上都在遭贬，并且流放的地方一次比一次远，是更加偏远的广东惠州，海南儋州。</p><p>但黄州之后，再遇贬挫，他的心态已经全然不同了。在谪往惠州的路上，途径江西大庾岭（今属广东韶关）时，看到大庾岭山峰巍峨，壮丽异常，并有薄雾环绕，宛如仙境，不禁写道：“一念失垢污，身心洞清净。浩然天地间，惟我独也正”。这哪像是被贬，更像是退职回家啊，字行间全是超脱轻松、洞明清净。</p><p>这本书，我大多是在夏夜东湖骑行时的间隙在手机上读的，在这样的情境下，我对苏轼“朝上东坡步，夕上东坡步。东坡何所爱，爱此新成树”的平淡安适有了更深的感受。读到这里，我亦阴霾尽去，轻松如沐。</p><p><img src="/2024/10/13/%E8%AF%BB%E3%80%8A%E8%8B%8F%E4%B8%9C%E5%9D%A1%E6%96%B0%E4%BC%A0%E3%80%8B%E6%9D%8E%E4%B8%80%E5%86%B0/%E5%A4%8F%E5%A4%9C%E4%B8%9C%E6%B9%96%E9%AA%91%E8%A1%8C.jpg" alt="夏夜东湖骑行"></p><p>在回程路上，我骑车一路跨山越岗，大汗透衣，却异常畅快。或许是平日里压抑过久，运动出汗带来的力量感，让我觉得无比释放。触觉听觉也好像恢复了灵敏，我能真切地感知到夏夜东湖的热情和友好，一路上幽鸟向我鸣，夜风慰我意。</p><p>等我到凌波门的时候，已经过了零点，栈桥上只有三两个人，或散落呆坐，或依偎成对。刚刚的兴奋还未尽褪，我掏出电话，打算叫上一二朋友，载酒买瓜，来这湖边栈桥上对坐闲谈。翻找许久，竟想不出谁人可约，才反应过来，我在这个城市已无要好朋友，只好悻悻然回了宿舍。</p><p>宿舍紧邻东湖，站在天台上能看清大半的湖景。其时，月出东南，林影在地，又有皓月照窗，场地空明，正是夜游赏月的好情景，只是可惜没有张怀民，遂不得作罢，于是打开word想要尽速记下这一刻的体会。[二零二四年八月十六日晚在工学部新2舍]</p><p>我想起九百多年前的一个月明夜，有一人解衣欲睡，见月色入户，便欣然起行，相约旧友，闲步庭中，对酒引歌。</p>]]></content>
    
    
    <categories>
      
      <category>读书</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Peak calling for CLIP-Seq data by omniCLIP [1]</title>
    <link href="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/"/>
    <url>/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/</url>
    
    <content type="html"><![CDATA[<h3 id="Peak-calling-for-CLIP-Seq-data-by-omniCLIP-1"><a href="#Peak-calling-for-CLIP-Seq-data-by-omniCLIP-1" class="headerlink" title="Peak calling for CLIP-Seq data by omniCLIP [1]"></a>Peak calling for CLIP-Seq data by omniCLIP [1]</h3><p>.</p><p> I have used omniCLIP to analyze CLIP data a few months ago, but the software is poorly maintained. The author is also incompetent, as they didn’t even clearly explain the output files. </p><p>Although the software is quite bad, I still want to record how to use it.</p><hr><p>I have skimmed through this papers (about the omniCLIP), and now I will provide a brief explanation of its computational principles and algorithm.</p><p>This paper ( Philipp et. al. 2018,Genome biology)  employ a Non-Homogeneous Hidden Markov Model (NHMM) to segment the genome into peaks and non-peaks. The emission probability of the NHMM is given by the product of the joint probability of the coverage and the probability of the observed diagnostic event frequency in all replicate CLIP and background libraries.</p><p>And a Negative Binomial based Generalized Linear Model (that models both confounding by the gene expression, and confounding of local effects and also allows to account for excess variance) are used to model the reads coverage.</p><p>Besides, the diagnostic events are modeled using a Dirichlet-Multinomial mixture model. The transition probabilities of the model are based on a logistic function that depends on the coverage. </p><h5 id="The-diagram-below-illustrates-the-algorithmic-of-omniCLIP"><a href="#The-diagram-below-illustrates-the-algorithmic-of-omniCLIP" class="headerlink" title="The diagram below illustrates the algorithmic of omniCLIP."></a>The diagram below illustrates the algorithmic of omniCLIP.</h5><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/Illustration%20of%20omniCLIP%20peak%20calling%20.png" alt="Illustration of omniCLIP peak calling "></p><p>show on the (left) is peak calling for a lowly expressed genes with strong RNA binding protein (RBP) RNA-binding and on the (right) a highly expressed gene with weak RBP RNA-binding. During peak calling, local background coverage is taken into account to correct for confounding by local effects or biases. Furthermore, overall the RNA abundance is estimated and accounted for. This allows better ranking peaks with identical local coverage by sharing of information along the transcript, as illustrated for the leftmost peaks in both genes.  </p><hr><h3 id="1-data-preparation"><a href="#1-data-preparation" class="headerlink" title="1. data preparation"></a>1. data preparation</h3><h4 id="1-1-data"><a href="#1-1-data" class="headerlink" title="1.1). data"></a>1.1). data</h4><p><strong>GSE98188</strong> from paper : </p><p>  Drosophila Sister-of-Sex-lethal reinforces a male-specific gene expression pattern by controlling Sex-lethal alternative splicing.  </p><p>  <em>Nucleic Acids Res</em> 2019</p><p> <strong>data download</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">iCLIP <span class="hljs-keyword">in</span> SL2 cells</span><br>lftp -e &#x27;pget -n 15 -c &quot;ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR548/007/SRR5480967/SRR5480967.fastq.gz&quot;;exit&#x27; # Similar methods for other samples.<br></code></pre></td></tr></table></figure><h4 id="1-2-data-clean"><a href="#1-2-data-clean" class="headerlink" title="1.2). data clean"></a>1.2). data clean</h4><p> <strong>Since the paper did not provide the adapter sequences and the length and position of the UMI</strong>.</p><p> I  tried different methods  to mark and remove the UMI and adapter.</p><p> <strong>a). remove adapter</strong></p><p>To detect the adapter sequences used, I first processed the raw sequencing data with trim_galore.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls ../*fastq.gz |while read id;do (trim_galore --quality 20  --length 20 -o ./ $id);done<br></code></pre></td></tr></table></figure><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/remove%20adapter.png" alt="remove adapter"></p><p>Based on the “auto-detection adapter” in the above figure, we can infer that the adapter sequence is AGATCGGAAGAGC.</p><p>The same processing method was applied to the other samples as well.   </p><p>Therefore,  removing the adapter from the raw sequence data based on the sequences identified above.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">for i in *.fastq.gz;<br>do<br>id=$&#123;i%.fastq.gz&#125;<br>echo $i,$id<br>cutadapt -q 25 -a AGATCGGAAGAGC  --overlap=3 -n 1 -m 24 -o $&#123;id&#125;_cutadap.fastq.gz  $&#123;id&#125;.fastq.gz<br>done<br></code></pre></td></tr></table></figure><p> <strong>b). mark UMI</strong></p><p> I used the adapters-removed reads for a BLAST against the genome in flybase and found that there are always 10 unpaired  bases at the 5’ end of the reads. Therefore, I suspect these are the UMI, as shown in the figure below.</p><p>​<a href="mailto:&#114;&#101;&#97;&#100;&#x2d;&#64;&#x53;&#82;&#82;&#53;&#x34;&#x38;&#x30;&#x39;&#54;&#55;&#x2e;&#x31;&#x31;">&#114;&#101;&#97;&#100;&#x2d;&#64;&#x53;&#82;&#82;&#53;&#x34;&#x38;&#x30;&#x39;&#54;&#55;&#x2e;&#x31;&#x31;</a> 11&#x2F;1   length &#x3D; 53 bp       <img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/reads%20blast%201.png" alt="reads blast 1">                         </p><p>​<a href="mailto:&#114;&#x65;&#97;&#100;&#x2d;&#x40;&#x53;&#x52;&#82;&#x35;&#52;&#56;&#48;&#x39;&#54;&#55;&#x2e;&#x32;&#49;&#x38;">&#114;&#x65;&#97;&#100;&#x2d;&#x40;&#x53;&#x52;&#82;&#x35;&#52;&#56;&#48;&#x39;&#54;&#55;&#x2e;&#x32;&#49;&#x38;</a> 218&#x2F;1   length &#x3D; 51 bp</p><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/reads%20blast%202.png" alt="reads blast 2"></p><p>Next, I used the <strong>flexbar</strong> software to mark the UMIs in the reads.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat &gt;  barcodes.fa   # create a file, with 10 N (length of UMI is 10 bp)<br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">umi</span><br>NNNNNNNNNN<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">conda activate py39<br><br>for i in *_cutadapt.fastq.gz;<br>do<br>id=$&#123;i%_cutadapt.fastq.gz&#125;<br>echo $i,$id<br>flexbar -r $&#123;id&#125;_cutadapt.fastq.gz  -b barcodes.fa --umi-tags -t $&#123;id&#125; -z GZ<br>done<br></code></pre></td></tr></table></figure><h3 id="2-omniCLIP-for-CLIP-Seq-peaks-calling"><a href="#2-omniCLIP-for-CLIP-Seq-peaks-calling" class="headerlink" title="2.omniCLIP for CLIP-Seq peaks calling"></a>2.omniCLIP for CLIP-Seq peaks calling</h3><h4 id="2-1-intsall-omniCLIP"><a href="#2-1-intsall-omniCLIP" class="headerlink" title="2.1). intsall omniCLIP"></a>2.1). intsall omniCLIP</h4><p><strong>download</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git clone https://github.com/philippdre/omniCLIP.git <br></code></pre></td></tr></table></figure><p><strong>create conda env</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd omniCLIP/<br>conda env create -f environment.yml<br>conda activate omniEnv<br></code></pre></td></tr></table></figure><p><strong>install</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python3 setup.py install<br></code></pre></td></tr></table></figure><h4 id="2-2-build-a-db-files-of-annotation-gtf"><a href="#2-2-build-a-db-files-of-annotation-gtf" class="headerlink" title="2.2). build a db files of annotation gtf"></a>2.2). build a db files of annotation gtf</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /home/xuyz_g/soft/omniCLIP # programs can only run successfully in directory of omniCLIP，don&#x27;t know why<br><br>omniCLIP generateDB --gff-file /data1/amliang/annotation/fly/Drosophila_melanogaster.BDGP6.22.42.gff3 --db-file /data1/amliang/annotation/fly/flyase/gff/omniCLIP/dmel-all-r6.45.gff.db # <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">At the same time, you also need to prepare a reference genome sequence and divide it into chromosomes</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">like this <span class="hljs-keyword">in</span> : /data3/tmp_g/genome_anno/fly/genome/chroms</span><br>  2L.fa.gz<br>  2R.fa.gz<br>  3L.fa.gz<br>  3R.fa.gz<br>  4.fa.gz<br>  X.fa.gz<br>  Y.fa.gz<br></code></pre></td></tr></table></figure><h4 id="error"><a href="#error" class="headerlink" title="error"></a>error</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1) If an error message appears saying that like this:</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">   FileNotFoundError: [Errno 2] No such file or directory: <span class="hljs-string">&#x27;version.py&#x27;</span>,</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash"> just copy it from another directory to this directory.</span><br>cp /data1/tmp/soft/omniCLIP/version.py  yourPath/omniCLIP-0.2.0-py3.8-linux-x86_64.egg/omniCLIP/<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2) <span class="hljs-keyword">if</span> a error shows:</span> <br><span class="hljs-meta prompt_">#</span><span class="language-bash"> File <span class="hljs-string">&quot;yourPath/omniCLIP/data_parsing/ParsingArgs.py&quot;</span>, line 44, <span class="hljs-keyword">in</span> parsing_argparse</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">   NameError: name <span class="hljs-string">&#x27;verifying_args&#x27;</span> is not defined</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Just vim into ParsingArgs.py and comment out or delete this line of verifying_args : like picture</span><br></code></pre></td></tr></table></figure><p><img src="/2024/09/25/Peak-calling-for-CLIP-Seq-data-by-omniCLIP/debug.png" alt="debug"></p><h4 id="2-3-parsing-the-background-files"><a href="#2-3-parsing-the-background-files" class="headerlink" title="2.3). parsing the background files"></a>2.3). parsing the background files</h4><h6 id="Usually-RNA-SEQ-data-but-sometimes-input-data-is-used"><a href="#Usually-RNA-SEQ-data-but-sometimes-input-data-is-used" class="headerlink" title="(Usually RNA-SEQ data, but sometimes input data is used)"></a>(Usually RNA-SEQ data, but sometimes input data is used)</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP parsingBG --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db --genome-dir /data3/tmp_g/projects/omniCLIP/chroms/ --bg-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ctrl_IP1.bam --bg-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ctrl_IP2.bam  --out-file /data3/tmp_g/projects/SSX_CLIP/4.peak/CTRL.dat<br></code></pre></td></tr></table></figure><h4 id="2-4-parsing-the-CLIP-files"><a href="#2-4-parsing-the-CLIP-files" class="headerlink" title="2.4). parsing the CLIP files"></a>2.4). parsing the CLIP files</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP parsingCLIP --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db --genome-dir /data3/tmp_g/projects/omniCLIP/chroms/ --clip-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ssx_IP1.bam  --clip-files /data3/tmp_g/projects/SSX_CLIP/4.peak/Ssx_IP2.bam  --out-file /data3/tmp_g/projects/SSX_CLIP/4.peak/SSX.dat<br></code></pre></td></tr></table></figure><h4 id="2-5-Running-the-omniCLIP-algorithm"><a href="#2-5-Running-the-omniCLIP-algorithm" class="headerlink" title="2.5). Running the omniCLIP algorithm"></a>2.5). Running the omniCLIP algorithm</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">omniCLIP run_omniCLIP --db-file /data3/tmp_g/projects/omniCLIP/dmel-all-r6.45.gff.db  --bg-dat /data3/tmp_g/projects/SSX_CLIP/4.peak/CTRL.dat  --clip-dat /data3/tmp_g/projects/SSX_CLIP/4.peak/SSX.dat  --out-dir /data3/tmp_g/projects/SSX_CLIP/4.peak/reslut<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Bioinformatic</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Brief Introduction</title>
    <link href="/2024/09/24/Brief-Introduction/"/>
    <url>/2024/09/24/Brief-Introduction/</url>
    
    <content type="html"><![CDATA[<p>Don’t think I’m boring !</p><p>This is just a test text !</p><p>There will be more interesting things to share later !</p><p>《礼记》里古语有说：“学然后知不足，教然后知困”，我深以为然。我希望在日常的技能分享中，能够助于加深自己对技术的理解，这也是我开始写个人博客文章的初衷。如果能顺便帮到其他人，那就更好。</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
